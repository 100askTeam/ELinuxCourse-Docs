"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2468],{71:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>o,frontMatter:()=>r,metadata:()=>l,toc:()=>h});var i=s(4848),c=s(8453);const r={},t="4 Linux\u8fdb\u7a0b\u95f4\u901a\u4fe1",l={id:"Knowledge-Notes/ProcessCommunication",title:"4 Linux\u8fdb\u7a0b\u95f4\u901a\u4fe1",description:"4.1 \u521d\u8bc6\u8fdb\u7a0b",source:"@site/docs/Knowledge-Notes/04_ProcessCommunication.md",sourceDirName:"Knowledge-Notes",slug:"/Knowledge-Notes/ProcessCommunication",permalink:"/en/docs/Knowledge-Notes/ProcessCommunication",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/linux-docs/tree/main/docs/Knowledge-Notes/04_ProcessCommunication.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"KnowledgeNotes",previous:{title:"3 \u8f93\u5165\u7cfb\u7edf",permalink:"/en/docs/Knowledge-Notes/InputSystem"},next:{title:"6 \u7f51\u7edc\u7f16\u7a0b",permalink:"/en/docs/Knowledge-Notes/NetworkProgram"}},d={},h=[{value:"4.1 \u521d\u8bc6\u8fdb\u7a0b",id:"41-\u521d\u8bc6\u8fdb\u7a0b",level:2},{value:"4.1.1 \u8fdb\u7a0b\u7684\u6982\u5ff5",id:"411-\u8fdb\u7a0b\u7684\u6982\u5ff5",level:3},{value:"4.1.1.1 \u7a0b\u5e8f",id:"4111-\u7a0b\u5e8f",level:4},{value:"4.1.1.2 \u8fdb\u7a0b",id:"4112-\u8fdb\u7a0b",level:4},{value:"4.1.1.3 \u8fdb\u7a0b\u548c\u7a0b\u5e8f\u7684\u8054\u7cfb",id:"4113-\u8fdb\u7a0b\u548c\u7a0b\u5e8f\u7684\u8054\u7cfb",level:4},{value:"4.1.1.4 \u8fdb\u7a0b\u548c\u7a0b\u5e8f\u7684\u533a\u522b",id:"4114-\u8fdb\u7a0b\u548c\u7a0b\u5e8f\u7684\u533a\u522b",level:4},{value:"4.1.2 \u8fdb\u7a0b\u7684\u64cd\u4f5c\uff08\u521b\u5efa\u3001\u7ed3\u675f\u3001\u56de\u6536\uff09",id:"412-\u8fdb\u7a0b\u7684\u64cd\u4f5c\u521b\u5efa\u7ed3\u675f\u56de\u6536",level:3},{value:"4.1.2.1 \u521b\u5efa\u8fdb\u7a0b",id:"4121-\u521b\u5efa\u8fdb\u7a0b",level:4},{value:"4.1.2.2 \u7ed3\u675f\u8fdb\u7a0b",id:"4122-\u7ed3\u675f\u8fdb\u7a0b",level:4},{value:"4.1.2.3 \u56de\u6536\u8fdb\u7a0b",id:"4123-\u56de\u6536\u8fdb\u7a0b",level:4},{value:"4.2 \u8fdb\u7a0b\u4e3a\u4ec0\u4e48\u9700\u8981\u901a\u4fe1",id:"42-\u8fdb\u7a0b\u4e3a\u4ec0\u4e48\u9700\u8981\u901a\u4fe1",level:2},{value:"4.3 \u8fdb\u7a0b\u901a\u4fe1\u4e4b\u7ba1\u9053\u901a\u4fe1",id:"43-\u8fdb\u7a0b\u901a\u4fe1\u4e4b\u7ba1\u9053\u901a\u4fe1",level:2},{value:"4.3.1 \u65e0\u540d\u7ba1\u9053",id:"431-\u65e0\u540d\u7ba1\u9053",level:3},{value:"4.3.1.1 \u7279\u70b9",id:"4311-\u7279\u70b9",level:4},{value:"4.3.1.2 \u521b\u5efa\u65e0\u540d\u7ba1\u9053",id:"4312-\u521b\u5efa\u65e0\u540d\u7ba1\u9053",level:4},{value:"4.3.1.3 \u8bfb\u3001\u5199\u3001\u5173\u95ed\u7ba1\u9053",id:"4313-\u8bfb\u5199\u5173\u95ed\u7ba1\u9053",level:4},{value:"4.3.1.4 \u65e0\u540d\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",id:"4314-\u65e0\u540d\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",level:4},{value:"4.3.2 \u6709\u540d\u7ba1\u9053",id:"432-\u6709\u540d\u7ba1\u9053",level:3},{value:"4.3.2.1 \u7279\u70b9",id:"4321-\u7279\u70b9",level:4},{value:"4.3.2.2 \u521b\u5efa\u6709\u540d\u7ba1\u9053",id:"4322-\u521b\u5efa\u6709\u540d\u7ba1\u9053",level:4},{value:"4.3.2.3 \u6709\u540d\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",id:"4323-\u6709\u540d\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",level:4},{value:"4.4 \u8fdb\u7a0b\u901a\u4fe1\u4e4bIPC\u901a\u4fe1",id:"44-\u8fdb\u7a0b\u901a\u4fe1\u4e4bipc\u901a\u4fe1",level:2},{value:"4.4.1 \u5171\u4eab\u5185\u5b58",id:"441-\u5171\u4eab\u5185\u5b58",level:3},{value:"4.4.1.1 \u7279\u70b9",id:"4411-\u7279\u70b9",level:4},{value:"4.4.1.2\u521b\u5efa\u5171\u4eab\u5185\u5b58",id:"4412\u521b\u5efa\u5171\u4eab\u5185\u5b58",level:4},{value:"4.4.1.3 \u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u8bbf\u95ee\u5171\u4eab\u5185\u5b58",id:"4413-\u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u8bbf\u95ee\u5171\u4eab\u5185\u5b58",level:4},{value:"4.4.1.4 \u5171\u4eab\u5185\u5b58\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",id:"4414-\u5171\u4eab\u5185\u5b58\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",level:4},{value:"4.4.2 \u6d88\u606f\u961f\u5217",id:"442-\u6d88\u606f\u961f\u5217",level:3},{value:"4.4.2.1 \u4ec0\u4e48\u662f\u6d88\u606f\u961f\u5217",id:"4421-\u4ec0\u4e48\u662f\u6d88\u606f\u961f\u5217",level:4},{value:"4.4.2.2 \u7279\u70b9",id:"4422-\u7279\u70b9",level:4},{value:"4.4.2.3 \u6d88\u606f\u961f\u5217\u51fd\u6570",id:"4423-\u6d88\u606f\u961f\u5217\u51fd\u6570",level:4},{value:"4.4.2.4 \u6d88\u606f\u961f\u5217\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",id:"4424-\u6d88\u606f\u961f\u5217\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",level:4},{value:"4.4.3 \u4fe1\u53f7\u91cf\u706f",id:"443-\u4fe1\u53f7\u91cf\u706f",level:3},{value:"4.4.3.1 \u4ec0\u4e48\u662fP\u3001V\u64cd\u4f5c",id:"4431-\u4ec0\u4e48\u662fpv\u64cd\u4f5c",level:4},{value:"4.4.3.2 \u4ec0\u4e48\u662f\u4fe1\u53f7\u91cf\u706f",id:"4432-\u4ec0\u4e48\u662f\u4fe1\u53f7\u91cf\u706f",level:4},{value:"4.4.3.3 \u4fe1\u53f7\u91cf\u706f\u51fd\u6570",id:"4433-\u4fe1\u53f7\u91cf\u706f\u51fd\u6570",level:4},{value:"4.4.3.4 \u4fe1\u53f7\u91cf\u706f\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u540c\u6b65/\u4e92\u65a5",id:"4434-\u4fe1\u53f7\u91cf\u706f\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u540c\u6b65\u4e92\u65a5",level:4},{value:"4.5 \u8fdb\u7a0b\u901a\u4fe1\u4e4b\u4fe1\u53f7\u901a\u4fe1",id:"45-\u8fdb\u7a0b\u901a\u4fe1\u4e4b\u4fe1\u53f7\u901a\u4fe1",level:2},{value:"4.5.1 \u4fe1\u53f7\u673a\u5236",id:"451-\u4fe1\u53f7\u673a\u5236",level:3},{value:"4.5.2 \u5e38\u89c1\u4fe1\u53f7\u7c7b\u578b",id:"452-\u5e38\u89c1\u4fe1\u53f7\u7c7b\u578b",level:3},{value:"4.5.3 \u4fe1\u53f7\u53d1\u9001\u51fd\u6570",id:"453-\u4fe1\u53f7\u53d1\u9001\u51fd\u6570",level:3},{value:"4.5.4 \u8fdb\u7a0b\u6355\u6349\u4fe1\u53f7",id:"454-\u8fdb\u7a0b\u6355\u6349\u4fe1\u53f7",level:3},{value:"4.6 \u8fdb\u7a0b\u901a\u4fe1\u4e4bsocket\u901a\u4fe1",id:"46-\u8fdb\u7a0b\u901a\u4fe1\u4e4bsocket\u901a\u4fe1",level:2},{value:"4.6.1 \u4ec0\u4e48\u662fsocket",id:"461-\u4ec0\u4e48\u662fsocket",level:3},{value:"4.6.2 \u76f8\u5173\u51fd\u6570",id:"462-\u76f8\u5173\u51fd\u6570",level:3},{value:"4.6.3 socket\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",id:"463-socket\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",level:3},{value:"4.6.4 \u4e00\u4e2aserver\u548c\u591a\u4e2aclient\u4e4b\u95f4\u7684\u901a\u4fe1",id:"464-\u4e00\u4e2aserver\u548c\u591a\u4e2aclient\u4e4b\u95f4\u7684\u901a\u4fe1",level:3}];function a(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"4-linux\u8fdb\u7a0b\u95f4\u901a\u4fe1",children:"4 Linux\u8fdb\u7a0b\u95f4\u901a\u4fe1"}),"\n",(0,i.jsx)(e.h2,{id:"41-\u521d\u8bc6\u8fdb\u7a0b",children:"4.1 \u521d\u8bc6\u8fdb\u7a0b"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5728\u65e5\u5e38\u5de5\u4f5c/\u5b66\u4e60\u4e2d\uff0c\u8bfb\u8005\u53ef\u80fd\u4f1a\u7ecf\u5e38\u542c\u5230\u5982\u4e0b\u4e00\u4e9b\u8bcd\uff1a\u201c\u4f5c\u4e1a\u201d\uff0c\u201c\u4efb\u52a1\u201d\uff0c\u201c\u5f00\u4e86\u51e0\u4e2a\u7ebf\u7a0b\u201d\uff0c\u201c\u521b\u5efa\u4e86\u51e0\u4e2a\u8fdb\u7a0b\u201d\uff0c\u201c\u591a\u7ebf\u7a0b\u201d\uff0c\u201c\u591a\u8fdb\u7a0b\u201d\u7b49\u7b49\u3002\u5982\u679c\u7cfb\u7edf\u5b66\u4e60\u8fc7\u300a\u64cd\u4f5c\u7cfb\u7edf\u300b\u8fd9\u95e8\u8bfe\u7a0b\uff0c\u76f8\u4fe1\u5927\u5bb6\u5bf9\u8fd9\u4e9b\u6982\u5ff5\u90fd\u5341\u5206\u4e86\u89e3\u3002\u4f46\u5bf9\u5f88\u591a\u7535\u5b50\u3001\u7535\u6c14\u5de5\u7a0b\u4e13\u4e1a\uff08\u6216\u662f\u5176\u4ed6\u975e\u8ba1\u7b97\u673a\u4e13\u4e1a\uff09\u7684\u540c\u5b66\u6765\u8bf4\uff0c\u7531\u4e8e\u8fd9\u95e8\u8bfe\u7a0b\u4e0d\u662f\u5fc5\u4fee\u8bfe\u7a0b\uff0c\u6211\u4eec\u8111\u6d77\u4e2d\u53ef\u80fd\u5c31\u4e0d\u4f1a\u6709\u8fd9\u4e9b\u6982\u5ff5\uff0c\u542c\u5230\u8fd9\u4e9b\u6982\u5ff5\u7684\u65f6\u5019\u5c31\u4f1a\u4e0d\u77e5\u6240\u4e91\uff0c\u4e0d\u8fc7\u6ca1\u6709\u5173\u7cfb\uff0c\u5148\u8ba9\u6211\u4eec\u514b\u670d\u5bf9\u8fd9\u4e9b\u6982\u5ff5\u7684\u6050\u60e7\u3002\u6bd4\u5982\u5c0f\u65f6\u5019\u521a\u5f00\u59cb\u5b66\u4e60\u6570\u5b66\u7684\u65f6\u5019\uff0c\u5148\u4ece\u6b63\u6574\u6570/\u81ea\u7136\u6570\u5f00\u59cb\u5b66\u4e60\uff0c\u7136\u540e\u9010\u6b65\u63a5\u89e6\u5230\u5206\u6570\u3001\u5c0f\u6570\u3001\u8d1f\u6570\u3001\u6709\u7406\u6570\u3001\u65e0\u7406\u6570\u3001\u5b9e\u6570\uff0c\u518d\u5230\u590d\u6570\u7b49\u7b49\u3002\u8fd9\u4e9b\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u6982\u5ff5\u4e5f\u662f\u8fd9\u6837\uff0c\u8ba9\u6211\u4eec\u4ece\u521d\u7ea7\u9636\u6bb5\u5f00\u59cb\u5b66\u8d77\uff0c\u9010\u6b65\u653b\u514b\u8fd9\u4e9b\u65b0\u6982\u5ff5\u80cc\u540e\u7684\u771f\u6b63\u542b\u4e49\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u672c\u7bc7\u4e3b\u8981\u8ba8\u8bbalinux\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\uff0c\u8fd9\u4e2a\u4e3b\u9898\u62c6\u5206\u5f00\u59cb\u6765\u770b\uff0c\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206\uff1alinux(\u64cd\u4f5c\u7cfb\u7edf)\u3001\u8fdb\u7a0b\u3001\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3002Linux\u64cd\u4f5c\u7cfb\u7edf\u672c\u7bc7\u6682\u4e14\u4e0d\u8c08\uff0c\u6211\u4eec\u4e3b\u8981\u6765\u5173\u6ce8\u540e\u4e24\u4e2a\u90e8\u5206\uff1a\u8fdb\u7a0b\uff0c\u4ee5\u53ca\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3002\u5728\u63a2\u8ba8\u8fdb\u7a0b\u95f4\u901a\u4fe1\u4e4b\u524d\uff0c\u8ba9\u6211\u4eec\u5148\u5173\u6ce8\u4e00\u4e2a\u77e5\u8bc6\u70b9\u6982\u5ff5----\u8fdb\u7a0b\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"411-\u8fdb\u7a0b\u7684\u6982\u5ff5",children:"4.1.1 \u8fdb\u7a0b\u7684\u6982\u5ff5"}),"\n",(0,i.jsx)(e.h4,{id:"4111-\u7a0b\u5e8f",children:"4.1.1.1 \u7a0b\u5e8f"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5728\u63a2\u8ba8\u8fdb\u7a0b\u4e4b\u524d\uff0c\u5148\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff1a\u4ec0\u4e48\u662f\u7a0b\u5e8f\uff1f"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5d4c\u5165\u5f0f\u8f6f\u4ef6\u5de5\u7a0b\u5e08\u6bcf\u5929\u7684\u5de5\u4f5c/\u5b66\u4e60\u5185\u5bb9\u5c31\u662f\u770bC/C++\u6e90\u4ee3\u7801\u3001\u5206\u6790C/C++\u6e90\u4ee3\u7801\u3001\u7f16\u5199C/C++\u6e90\u4ee3\u7801\uff08\u6709\u4eba\u4f1a\u8bf4\uff0c\u5e94\u8be5\u8fd8\u6709\u6700\u91cd\u8981\u7684\u8c03\u8bd5\u7a0b\u5e8f\uff0c\u6211\u6bcf\u5929\u7684\u5de5\u4f5c\u65e5\u5e38\u662f\u4e09\u5206\u5199\u7a0b\u5e8f\uff0c\u4e03\u5206\u8c03\u8bd5\u7a0b\u5e8f\uff0c\u8c03\u8bd5\u7a0b\u5e8f\u53bb\u54ea\u91cc\u4e86\uff0c\u5927\u5bb6\u522b\u7740\u6025\uff0c\u8fd9\u91cc\u5148\u5356\u4e00\u4e2a\u5173\u5b50\uff09\u3002\u8fd9\u4e9b\u72ec\u7acb\u7684\u6e90\u4ee3\u7801\u5c31\u662f\u4e00\u4e2a\u4e2a\u7a0b\u5e8f\u3002\u5b83\u4eec\u6709\u4e00\u4e2a\u5171\u540c\u7279\u70b9\uff0c\u5728\u6211\u4eec\u9605\u8bfb\u3001\u5206\u6790\u3001\u7f16\u5199\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6b64\u523b\u90fd\u662f\u9759\u6001\u7684\uff0c\u5b83\u4eec\u5b58\u50a8\u5728\u6211\u4eec\u7684\u786c\u76d8\u4e0a\u3001\u516c\u53f8\u7684\u670d\u52a1\u5668\u4e0a\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u7a0b\u5e8f\uff1a\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u6307\u4ee4\u548c\u6570\u636e\u7684\u6709\u5e8f\u96c6\u5408\u3002\u5982\u4e0b\u5c31\u662f\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u6b64\u523b\u5b83\u6b63\u5b89\u9759\u5730\u8eba\u5728\u786c\u76d8\u4e0a\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 #include <stdio.h>\n02\n03 int main(int argc, char *argv[])\n04{\n05\tprintf("hello world!\\n");\n06\treturn 0;\n07}\n'})}),"\n",(0,i.jsx)(e.h4,{id:"4112-\u8fdb\u7a0b",children:"4.1.1.2 \u8fdb\u7a0b"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u6709\u4e86\u4e0a\u9762\u7a0b\u5e8f\u7684\u6982\u5ff5\uff0c\u5148\u76f4\u63a5\u7ed9\u51fa\u8fdb\u7a0b\u7684\u5b9a\u4e49\u3002"}),"\n",(0,i.jsxs)(e.p,{children:["\u200b\t\t\u8fdb\u7a0b\uff1a",(0,i.jsx)(e.strong,{children:"\u5177\u6709\u4e00\u5b9a\u72ec\u7acb\u529f\u80fd\u7684\u7a0b\u5e8f\u5728\u4e00\u4e2a\u6570\u636e\u96c6\u5408\u4e0a\u7684\u4e00\u6b21\u52a8\u6001\u6267\u884c\u8fc7\u7a0b"}),"\u3002\u5b83\u662f\u52a8\u6001\u7684\uff0c\u5305\u62ec\u521b\u5efa\u3001\u8c03\u5ea6\u3001\u6267\u884c\u548c\u6d88\u4ea1\uff08\u7531\u64cd\u4f5c\u7cfb\u7edf\u5b8c\u6210\u7684\uff09\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5b9a\u4e49\u4e2d\u7684\u6bcf\u4e2a\u8bcd\u5206\u5f00\u6765\u6211\u4eec\u90fd\u80fd\u7406\u89e3\uff0c\u4f46\u662f\u7ec4\u5408\u5230\u4e00\u8d77\u6210\u4e3a\u4e00\u4e2a\u53e5\u5b50\u65f6\uff0c\u6211\u4eec\u53c8\u4e0d\u77e5\u9053\u4ec0\u4e48\u610f\u601d\u4e86\u3002\u56fe\u7075\u5956\u5f97\u4e3bPascal\u4e4b\u7236\u5c3c\u53e4\u62c9\u65af\xb7\u6c83\u65af\uff0c\u63d0\u51fa\u8fc7\u4e00\u4e2a\u8457\u540d\u7684\u516c\u5f0f\uff1a\u7a0b\u5e8f=\u7b97\u6cd5+\u6570\u636e\u7ed3\u6784\u3002\u6240\u8c13\u7b97\u6cd5\u5c31\u662f\u89e3\u51b3\u4e00\u4e2a\u95ee\u9898\u7684\u65b9\u6cd5\uff0c\u7a0b\u5e8f\u5c31\u662f\u4f7f\u7528\u7b97\u6cd5\u5bf9\u7279\u5b9a\u6570\u636e\u8fdb\u884c\u5904\u7406\uff0c\u8fd9\u4e9b\u6570\u636e\u662f\u4e00\u4e2a\u5e7f\u4e49\u4e0a\u7684\u6982\u5ff5\uff0c\u4e0d\u5355\u5355\u6307\u50cf1,2,3,\u2026\u7b49\u7b49\u8fd9\u6837\u7684\u6570\u636e\u3002\u56e0\u6b64\u7528\u66f4\u76f4\u767d\u7684\u8bed\u8a00\u6765\u8bf4\uff0c\u7a0b\u5e8f\u5f00\u59cb\u8fd0\u884c\uff0c\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u6790\u5904\u7406\u7684\u8fc7\u7a0b\u5c31\u662f\u4e00\u4e2a\u8fdb\u7a0b\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"4113-\u8fdb\u7a0b\u548c\u7a0b\u5e8f\u7684\u8054\u7cfb",children:"4.1.1.3 \u8fdb\u7a0b\u548c\u7a0b\u5e8f\u7684\u8054\u7cfb"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u662f\u4ea7\u751f\u8fdb\u7a0b\u7684\u57fa\u7840\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u7684\u6bcf\u6b21\u6267\u884c\u6784\u6210\u4e0d\u540c\u7684\u8fdb\u7a0b\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8fdb\u7a0b\u662f\u7a0b\u5e8f\u529f\u80fd\u7684\u4f53\u73b0\uff08\u8fd8\u8bb0\u5f97\u4e4b\u524d\u63d0\u5230\u7684\u7a0b\u5e8f\u5458\u65e5\u5e38\u5de5\u4f5c\u4e2d\u7684\u4e00\u4e2a\u91cd\u8981\u4e8b\u9879----\u8c03\u8bd5\u7a0b\u5e8f\u5417\uff1f\u8c03\u8bd5\u7684\u8fc7\u7a0b\u5b9e\u9645\u4e0a\u5c31\u662f\u7a0b\u5e8f\u7684\u6267\u884c\uff0c\u5c31\u662f\u672c\u6b21\u7a0b\u5e8f\u529f\u80fd\u7684\u4f53\u73b0\uff0c\u56e0\u6b64\u8fd9\u4e2a\u65f6\u5019\u5b83\u5c31\u662f\u4e00\u4e2a\u8fdb\u7a0b\uff09\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u901a\u8fc7\u591a\u6b21\u6267\u884c\uff0c\u4e00\u4e2a\u7a0b\u5e8f\u53ef\u5bf9\u5e94\u591a\u4e2a\u8fdb\u7a0b\uff1b\u901a\u8fc7\u8c03\u7528\u5173\u7cfb\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u5305\u542b\u591a\u4e2a\u7a0b\u5e8f\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"4114-\u8fdb\u7a0b\u548c\u7a0b\u5e8f\u7684\u533a\u522b",children:"4.1.1.4 \u8fdb\u7a0b\u548c\u7a0b\u5e8f\u7684\u533a\u522b"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u7a0b\u5e8f"}),(0,i.jsx)(e.th,{children:"\u8fdb\u7a0b"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u72b6\u6001"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"\u9759\u6001\u7684\uff0c\u662f\u6709\u5e8f\u4ee3\u7801\u7684\u96c6\u5408"}),(0,i.jsx)(e.td,{children:"\u52a8\u6001\u7684\uff0c\u662f\u7a0b\u5e8f\u529f\u80fd\u7684\u6267\u884c\u8fc7\u7a0b"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u751f\u547d\u671f"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"\u6c38\u4e45\u7684\uff0c\u957f\u4e45\u4fdd\u5b58\u5728\u5b58\u50a8\u8bbe\u5907\u4e0a"}),(0,i.jsx)(e.td,{children:"\u6682\u65f6\u7684\uff0c\u4e00\u4e2a\u7a0b\u5e8f\u6267\u884c\u7ed3\u675f\uff0c\u5219\u5b83\u5bf9\u5e94\u7684\u8fdb\u7a0b\u7ed3\u675f"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u4e0b\u56fe\u53cd\u5e94\u4e86\u4ece\u7a0b\u5e8f\u5230\u8fdb\u7a0b\u7684\u53d8\u5316\u8fc7\u7a0b\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image001.png",alt:"ProcessCommunication_Image001"})}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u4ee5\u4e00\u4e2a\u751f\u6d3b\u4e2d\u7684\u4f8b\u5b50\u6765\u52a0\u6df1\u5bf9\u8fdb\u7a0b\u548c\u7a0b\u5e8f\u7684\u7406\u89e3\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"1.\u6709\u4e00\u4f4d\u8ba1\u7b97\u673a\u79d1\u5b66\u5bb6\uff0c\u4ed6\u7684\u5973\u513f\u8981\u8fc7\u751f\u65e5\u4e86\uff0c\u4ed6\u51c6\u5907\u7ed9\u5973\u513f\u505a\u4e00\u4e2a\u751f\u65e5\u86cb\u7cd5\uff0c\u4e8e\u662f\u4ed6\u53bb\u627e\u4e86\u4e00\u672c\u83dc\u8c31\uff0c\u8ddf\u7740\u83dc\u8c31\u5b66\u4e60\u505a\u86cb\u7cd5\u3002\n\n\u83dc\u8c31=\u7a0b\u5e8f  \u79d1\u5b66\u5bb6=CPU  \u505a\u86cb\u7cd5\u7684\u539f\u6750\u6599=\u6570\u636e  \u505a\u86cb\u7cd5\u7684\u8fc7\u7a0b=\u8fdb\u7a0b\n\n2.\u79d1\u5b66\u5bb6\u6b63\u5728\u505a\u86cb\u7cd5\u7684\u65f6\u5019\uff0c\u7a81\u7136\u4ed6\u7684\u5c0f\u513f\u5b50\u8dd1\u8fc7\u6765\uff0c\u8bf4\u4ed6\u7684\u624b\u88ab\u624e\u7834\u4e86\uff0c\u4e8e\u662f\u79d1\u5b66\u5bb6\u53c8\u53bb\u627e\u4e86\u4e00\u672c\u533b\u7597\u624b\u518c\uff0c\u7ed9\u5c0f\u513f\u5b50\u5904\u7406\u4f24\u53e3\uff0c\u5904\u7406\u5b8c\u4f24\u53e3\u4e4b\u540e\uff0c\u7ee7\u7eed\u505a\u751f\u65e5\u86cb\u7cd5\n\n\u533b\u7597\u624b\u518c=\u65b0\u7a0b\u5e8f  \u7ed9\u5c0f\u513f\u5b50\u5904\u7406\u4f24\u53e3=\u65b0\u8fdb\u7a0b\n\n\u4ece\u505a\u86cb\u7cd5\u5207\u6362\u5230\u4f18\u5148\u5305\u624e\u4f24\u53e3=\u8fdb\u7a0b\u5207\u6362  \u5904\u7406\u5b8c\u4f24\u53e3\u7ee7\u7eed\u505a\u751f\u65e5\u86cb\u7cd5=\u8fdb\u7a0b\u6062\u590d\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u4ecb\u7ecd\u5230\u8fd9\u91cc\uff0c\u5e0c\u671b\u8bfb\u8005\u5bf9\u8fdb\u7a0b\u5df2\u7ecf\u5efa\u7acb\u8d77\u4e00\u4e9b\u57fa\u7840\u6982\u5ff5\u4e86\uff0c\u6709\u5173\u8fdb\u7a0b\u7684\u6df1\u5165\u90e8\u5206\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u6682\u4e14\u5148\u4e0d\u4ecb\u7ecd\uff0c\u6bd4\u5982\u8fdb\u7a0b\u7684\u7ec4\u6210\u5305\u62ec\u54ea\u4e9b\uff08\u4ee3\u7801\u6bb5\uff0c\u7528\u6237\u6570\u636e\u6bb5\uff0c\u7cfb\u7edf\u6570\u636e\u6bb5\uff09\uff1f\u8fdb\u7a0b\u7684\u7c7b\u578b\u6709\u54ea\u4e9b\uff1f\u8fdb\u7a0b\u7684\u72b6\u6001\u6709\u54ea\u4e9b\u7b49\u7b49\uff1f\u8fd9\u4e9b\u6df1\u5165\u5185\u5bb9\uff0c\u5728\u6211\u4eec\u638c\u63e1\u4e86\u8fdb\u7a0b\u7684\u57fa\u7840\u77e5\u8bc6\u4e4b\u540e\uff0c\u8bfb\u8005\u6709\u5174\u8da3\u7684\u8bdd\uff0c\u53ef\u4ee5\u67e5\u9605\u76f8\u5173\u4e66\u7c4d\u8d44\u6599\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"412-\u8fdb\u7a0b\u7684\u64cd\u4f5c\u521b\u5efa\u7ed3\u675f\u56de\u6536",children:"4.1.2 \u8fdb\u7a0b\u7684\u64cd\u4f5c\uff08\u521b\u5efa\u3001\u7ed3\u675f\u3001\u56de\u6536\uff09"}),"\n",(0,i.jsx)(e.h4,{id:"4121-\u521b\u5efa\u8fdb\u7a0b",children:"4.1.2.1 \u521b\u5efa\u8fdb\u7a0b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u4f7f\u7528fork\u51fd\u6570\u6765\u521b\u5efa\u4e00\u4e2a\u8fdb\u7a0b\n\u5934\u6587\u4ef6: #include <unistd.h>\n\u51fd\u6570\u539f\u578b: pid_t fork(void);\n\u8fd4\u56de\u503c: \u6210\u529f\u65f6\uff0c\u7236\u8fdb\u7a0b\u8fd4\u56de\u5b50\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7(>0\u7684\u975e\u96f6\u6574\u6570)\uff0c\u5b50\u8fdb\u7a0b\u4e2d\u8fd4\u56de0;\u901a\u8fc7fork\u51fd\u6570\u7684\u8fd4\u56de\u503c\u533a\u5206\u7236\u5b50\u8fdb\u7a0b\u3002\n\u7236\u8fdb\u7a0b: \u6267\u884cfork\u51fd\u6570\u7684\u8fdb\u7a0b\u3002\n\u5b50\u8fdb\u7a0b: \u7236\u8fdb\u7a0b\u8c03\u7528fork\u51fd\u6570\u4e4b\u540e\uff0c\u751f\u6210\u7684\u65b0\u8fdb\u7a0b\u3002\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u8bf7\u91cd\u70b9\u6ce8\u610f\uff1a\u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u548c\u6211\u4eec\u63a5\u89e6\u7684\u7edd\u5927\u90e8\u5206\u51fd\u6570\u7684\u8fd4\u56de\u503c\u4e0d\u4e00\u6837\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u4e00\u822c\u5730\uff0c\u4e00\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u53ea\u6709\u4e00\u4e2a\u503c\uff0c\u4f46\u662f\u8be5\u51fd\u6570\u7684\u8fd4\u56de\u503c\u5374\u6709\u4e24\u4e2a\u3002\u5b9e\u9645\u4e0a\u5173\u4e8e\u8fd9\u4e2a\u51fd\u6570\u7684\u8fd4\u56de\u503c\u7a76\u7adf\u6709\u51e0\u4e2a\uff0c\u53ef\u4ee5\u6362\u4e00\u79cd\u65b9\u5f0f\u6765\u7406\u89e3\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u51fd\u6570\u6267\u884c\u4e4b\u540e\uff0c\u7cfb\u7edf\u4e2d\u4f1a\u5b58\u5728\u4e24\u4e2a\u8fdb\u7a0b----\u7236\u8fdb\u7a0b\u548c\u5b50\u8fdb\u7a0b\uff0c\u5728\u6bcf\u4e2a\u8fdb\u7a0b\u4e2d\u90fd\u8fd4\u56de\u4e86\u4e00\u4e2a\u503c\uff0c\u6240\u4ee5\u7ed9\u7528\u6237\u7684\u611f\u89c9\u5c31\u662f\u8fd4\u56de\u4e86\u4e24\u4e2a\u503c\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u8fdb\u7a0b\u7684\u7279\u70b9\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5728linux\u4e2d\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u5fc5\u987b\u662f\u53e6\u5916\u4e00\u4e2a\u8fdb\u7a0b\u7684\u5b50\u8fdb\u7a0b\uff0c\u6216\u8005\u8bf4\u4e00\u4e2a\u8fdb\u7a0b\u5fc5\u987b\u6709\u7236\u8fdb\u7a0b\uff0c\u4f46\u662f\u53ef\u4ee5\u6ca1\u6709\u5b50\u8fdb\u7a0b\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5b50\u8fdb\u7a0b\u7ee7\u627f\u4e86\u7236\u8fdb\u7a0b\u7684\u5185\u5bb9\uff0c\u5305\u62ec\u7236\u8fdb\u7a0b\u7684\u4ee3\u7801\uff0c\u53d8\u91cf\uff0cpcb\uff0c\u751a\u81f3\u5305\u62ec\u5f53\u524dPC\u503c\u3002\u5728\u7236\u8fdb\u7a0b\u4e2d\uff0cPC\u503c\u6307\u5411\u5f53\u524dfork\u51fd\u6570\u7684\u4e0b\u4e00\u6761\u6307\u4ee4\u5730\u5740\uff0c\u56e0\u6b64\u5b50\u8fdb\u7a0b\u4e5f\u662f\u4ecefork\u51fd\u6570\u7684\u4e0b\u4e00\u6761\u6307\u4ee4\u5f00\u59cb\u6267\u884c\u3002\u7236\u5b50\u8fdb\u7a0b\u7684\u6267\u884c\u987a\u5e8f\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u53ef\u80fd\u5b50\u8fdb\u7a0b\u5148\u6267\u884c\uff0c\u4e5f\u53ef\u80fd\u7236\u8fdb\u7a0b\u5148\u6267\u884c\uff0c\u53d6\u51b3\u4e8e\u5f53\u524d\u7cfb\u7edf\u7684\u8c03\u5ea6\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7236\u5b50\u8fdb\u7a0b\u6709\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4\u3001\u72ec\u7acb\u7684\u4ee3\u7801\u7a7a\u95f4\uff0c\u4e92\u4e0d\u5f71\u54cd\uff0c\u5c31\u7b97\u7236\u5b50\u8fdb\u7a0b\u6709\u540c\u540d\u7684\u5168\u5c40\u53d8\u91cf\uff0c\u4f46\u662f\u7531\u4e8e\u5b83\u4eec\u5904\u5728\u4e0d\u540c\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u56e0\u6b64\u4e0d\u80fd\u5171\u4eab\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5b50\u8fdb\u7a0b\u7ed3\u675f\u4e4b\u540e\uff0c\u5fc5\u987b\u7531\u5b83\u7684\u7236\u8fdb\u7a0b\u56de\u6536\u5b83\u7684\u4e00\u5207\u8d44\u6e90\uff0c\u5426\u5219\u5c31\u4f1a\u6210\u4e3a\u50f5\u5c38\u8fdb\u7a0b\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5982\u679c\u7236\u8fdb\u7a0b\u5148\u7ed3\u675f\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u6210\u4e3a\u5b64\u513f\u8fdb\u7a0b\uff0c\u5b83\u4f1a\u88abINIT\u8fdb\u7a0b\u6536\u517b\uff0cINIT\u8fdb\u7a0b\u662f\u5185\u6838\u542f\u52a8\u4e4b\u540e\uff0c\u9996\u5148\u88ab\u521b\u5efa\u7684\u8fdb\u7a0b\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Tips\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5728linux\u4e0b\uff0c\u5f53\u6211\u4eec\u4e0d\u719f\u6089\u67d0\u4e2a\u7cfb\u7edf\u63a5\u53e3API\u51fd\u6570\u65f6\uff08\u6bd4\u5982\u4e0d\u77e5\u9053\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u9700\u8981\u5305\u542b\u7684\u5934\u6587\u4ef6\uff0c\u4e0d\u77e5\u9053\u8fd9\u4e2a\u51fd\u6570\u7684\u6bcf\u4e2a\u53c2\u6570\u7684\u610f\u4e49\u7b49\u7b49\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u5728ubuntu\u4e0b\u4f7f\u7528man\u547d\u4ee4\u6765\u67e5\u770b\u8fd9\u4e2a\u51fd\u6570\u7684\u8bf4\u660e\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image002.png",alt:"ProcessCommunication_Image002"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image003.png",alt:"ProcessCommunication_Image003"})}),"\n",(0,i.jsx)(e.p,{children:"\u793a\u4f8b\u7a0b\u5e8f\uff08\u53c2\u8003\uff1ajz2440\\process\\1th_create_process\\create_process.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a \u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 \n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 #include <sys/types.h>\n15 \n16 int main(int argc, char *argv[])\n17 {\n18     pid_t pid;\n19 \n20     pid = fork();  // \u521b\u5efa\u5b50\u8fdb\u7a0b\n21 \n22     if (pid == 0) {  // \u5b50\u8fdb\u7a0b\n23         int i = 0;\n24         for (i = 0; i < 5; i++) {\n25             usleep(100);\n26             printf("this is child process i=%d\\n", i);\n27         }\n28     }\n29     \n30     if (pid > 0) {  // \u7236\u8fdb\u7a0b\n31         int i = 0;\n32         for (i = 0; i < 5; i++) {\n33             usleep(100);\n34             printf("this is parent process i=%d\\n", i);\n35         }\n36     }\n37 \n38     while(1);   //\u4e0d\u8ba9\u8fdb\u7a0b\u7ed3\u675f\uff0c\u4ee5\u4fbf\u6211\u4eec\u67e5\u770b\u8fdb\u7a0b\u7684\u4e00\u4e9b\u72b6\u6001\u4fe1\u606f\n39     return 0;\n40 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5728jz2440\u5f00\u53d1\u677f\u4e0a\u5b9e\u9a8c\uff0c\u8bfb\u8005\u9996\u5148\u9700\u8981\u521b\u5efa\u597dNFS\u6587\u4ef6\u7cfb\u7edf\uff0cjz2440\u5f00\u53d1\u677f\u4ece\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf\u542f\u52a8\uff0c\u4ee5\u4fbf\u8fd0\u884c\u5728ubuntu\u4e0a\u7f16\u8bd1\u597d\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5173\u4e8e\u5982\u4f55\u642d\u5efaNFS\u6587\u4ef6\u7cfb\u7edf\u8bf7\u53c2\u8003\u89c6\u9891\u6559\u7a0b\u300au-boot_\u5185\u6838_\u6839\u6587\u4ef6\u7cfb\u7edf(ARM\u88f8\u673a1\u671f\u52a0\u5f3a\u7248\u4e0e2\u671f\u9a71\u52a8\u5927\u5168\u95f4\u7684\u8854\u63a5)\u300b\u3002\u8bfb\u8005\u4e5f\u53ef\u4ee5\u5728ubuntu\u4e0a\u6267\u884c\uff0c\u5c06\u7f16\u8bd1\u5668\u4ece\u201carm-linux-gcc\u201d\u6362\u6210\u201cgcc\u201d\u5373\u53ef\u3002"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1\u7a0b\u5e8f"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc create_process.c -o create_process\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5c06\u53ef\u6267\u884c\u6587\u4ef6test\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf\u5bf9\u5e94\u7684\u76ee\u5f55\u4e0b"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp create_process /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5728jz2440\u5f00\u53d1\u677f\u7684\u4e32\u53e3\u4e0b\u6b64\u65f6\u80fd\u770b\u5230\u8be5\u53ef\u6267\u884c\u6587\u4ef6"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image004.png",alt:"ProcessCommunication_Image004"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6267\u884c\u53ef\u6267\u884c\u6587\u4ef6"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\u201d&\u201d\u8868\u793a\u5728\u540e\u53f0\u6267\u884c\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u5728\u4e32\u53e3\u63a7\u5236\u53f0\u4e0b\u6572\u5165\u547d\u4ee4\uff0c\u63a7\u5236\u53f0\u80fd\u591f\u63a5\u6536\u5230\u8f93\u5165\u5b57\u7b26\u5e76\u4f5c\u51fa\u54cd\u5e94\uff1b\u5982\u679c\u4e0d\u52a0\u201d&\u201d\uff0c\u8868\u793a\u5728\u524d\u53f0\u6267\u884c\uff0c\u63a7\u5236\u53f0\u4e0d\u80fd\u5bf9\u8f93\u5165\u5b57\u7b26\u4f5c\u51fa\u54cd\u5e94\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./create_process &\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image005.png",alt:"ProcessCommunication_Image005"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"top\u547d\u4ee4\u67e5\u770b\u8fdb\u7a0b\u72b6\u6001"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"top\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image006.png",alt:"ProcessCommunication_Image006"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u53d1\u73b0\u6b64\u65f6\u786e\u5b9e\u5b58\u5728\u4e24\u4e2a\u8fdb\u7a0bcreate_process\uff0c\u5176\u4e2d\u4e00\u4e2a\u8fdb\u7a0bPID\u662f777(\u5b83\u7684\u7236\u8fdb\u7a0bPID\u662f776)\uff0c\u53e6\u5916\u4e00\u4e2a\u8fdb\u7a0bPID\u662f776(\u5b83\u7684\u7236\u8fdb\u7a0bPID\u662f770)\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"4122-\u7ed3\u675f\u8fdb\u7a0b",children:"4.1.2.2 \u7ed3\u675f\u8fdb\u7a0b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u4f7f\u7528exit\u51fd\u6570\u6765\u7ed3\u675f\u4e00\u4e2a\u8fdb\u7a0b\n\u5934\u6587\u4ef6: #include <stdlib.h>\n\u51fd\u6570\u539f\u578b: void exit (int status)\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u4f7f\u7528_exit\u51fd\u6570\u6765\u7ed3\u675f\u4e00\u4e2a\u8fdb\u7a0b\n\u5934\u6587\u4ef6: #include <unistd.h>\n\u51fd\u6570\u539f\u578b: void _exit(int status);\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u4e24\u4e2a\u51fd\u6570\u7684\u533a\u522b\u662f\uff1aexit\u7ed3\u675f\u8fdb\u7a0b\u65f6\u4f1a\u5237\u65b0\u7f13\u51b2\u533a\uff0c_exit\u4e0d\u4f1a\uff1b"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u8fd9\u4e24\u4e2a\u9000\u51fa\u51fd\u6570\u548creturn\u51fd\u6570\u53c8\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1fexit\u548c _ exit\u51fd\u6570\u662f\u8fd4\u56de\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u7684\uff0creturn\u51fd\u6570\u662f\u5f53\u524d\u51fd\u6570\u8fd4\u56de\uff0c\u8fd4\u56de\u5230\u8c03\u7528\u5b83\u7684\u51fd\u6570\u4e2d\uff0c\u5982\u679c\u6b63\u597d\u662f\u5728main\u51fd\u6570\u4e2d\uff0creturn\u51fd\u6570\u4e5f\u8fd4\u56de\u7ed9\u4e86\u64cd\u4f5c\u7cfb\u7edf\uff0c\u8fd9\u4e2a\u65f6\u5019return\u548cexit\u3001_exit\u8d77\u5230\u4e86\u7c7b\u4f3c\u7684\u4f5c\u7528\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u5b9e\u9a8c\uff1a\u9a8c\u8bc1exit\u548c_exit\u7684\u533a\u522b"}),"\n",(0,i.jsx)(e.p,{children:"\u793a\u4f8b1\uff1a\u4f7f\u7528exit\u9000\u51fa\uff08\u53c2\u8003\uff1ajz2440\\process\\2th_exit_process\\exit_process.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a \u4f7f\u7528exit\u9000\u51fa\u5f53\u524d\u8fdb\u7a0b\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 #include <stdio.h>\n11 #include <stdlib.h>\n12 \n13 int main(int argc, char *argv[])\n14 {\n15     printf("hello world\\n");\n16     printf("will exit");\n17     exit(0);    //\u4f7f\u7528exit\u9000\u51fa\n18 }\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u793a\u4f8b2\uff1a\u4f7f\u7528_exit\u9000\u51fa\uff08\u53c2\u8003\uff1ajz2440\\process\\3th_exit_process\\exit_process.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a \u4f7f\u7528_exit\u9000\u51fa\u5f53\u524d\u8fdb\u7a0b\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 #include <stdio.h>\n11 #include <stdlib.h>\n12 \n13 int main(int argc, char *argv[])\n14 {\n15     printf("hello world\\n");\n16     printf("will exit");\n17     _exit(0);    //\u4f7f\u7528_exit\u9000\u51fa\n18 }\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5728\u4e24\u4e2a\u793a\u4f8b\u7a0b\u5e8f\u4e2d\uff0c\u7b2c15\u884c\u6bd4\u7b2c16\u884c\u7684\u6253\u5370\u8bed\u53e5\u591a\u4e86\u4e00\u4e2a\u201c\\n\u201d\uff0c\u5b83\u4f1a\u5f3a\u5236\u5c06\u5f85\u6253\u5370\u7684\u5b57\u7b26\u5237\u65b0\u5230\u7f13\u51b2\u533a\uff0c\u4e3a\u4e86\u5bf9\u6bd4exit\u548c_exit\u7684\u533a\u522b\uff0c\u5728\u7b2c16\u884c\u4e2d\u5c31\u6ca1\u6709\u52a0\u4e0a\u201c\\n\u201d\uff0c\u6309\u7167\u4e0a\u9762\u4e24\u4e2a\u9000\u51fa\u51fd\u6570\u7684\u533a\u522b\uff0c\u793a\u4f8b1\u5e94\u8be5\u4f1a\u540c\u65f6\u6253\u5370\u201chello world\u201d\u548c\u201cwill exit\u201d\uff0c\u793a\u4f8b2\u7a0b\u5e8f\u53ea\u4f1a\u6253\u5370\u201chello world\u201d\uff0c\u4e0d\u4f1a\u6253\u5370\u201cwill exit\u201d\uff0c\u90a3\u4e48\u5230\u5e95\u662f\u4e0d\u662f\u8fd9\u6837\u5462\uff1f\u6211\u4eec\u5728jz2440\u4e0b\u9a8c\u8bc1\u4e00\u4e0b\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u793a\u4f8b1"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc exit_process.c -o exit_process\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp exit_process /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./exit_process\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd0\u884c\u7ed3\u679c\uff0c\u786e\u5b9e\u540c\u65f6\u6253\u5370\u4e86\u201chello world\u201d\u548c\u201cwill exit\u201d"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image008.png",alt:"ProcessCommunication_Image008"})}),"\n",(0,i.jsx)(e.h4,{id:"4123-\u56de\u6536\u8fdb\u7a0b",children:"4.1.2.3 \u56de\u6536\u8fdb\u7a0b"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u4f7f\u7528wait\u51fd\u6570\u6765\u56de\u6536\u4e00\u4e2a\u8fdb\u7a0b\n\u5934\u6587\u4ef6: #include <sys/types.h>\n\t   #include <sys/wait.h>\n\u51fd\u6570\u539f\u578b: pid_t wait(int *status);\n\u8fd4\u56de\u503c:  \u6210\u529f\u8fd4\u56de\u5b50\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\uff0c\u5931\u8d25\u8fd4\u56de-1\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u4f7f\u7528waitpid\u51fd\u6570\u6765\u56de\u6536\u4e00\u4e2a\u8fdb\u7a0b\n\u5934\u6587\u4ef6: #include <sys/types.h>\n\t   #include <sys/wait.h>\n\u51fd\u6570\u539f\u578b: pid_t waitpid(pid_t pid, int *status, int options);\n\u8fd4\u56de\u503c:  \u6210\u529f\u8fd4\u56de\u5b50\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\uff0c\u5931\u8d25\u8fd4\u56de-1\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u793a\u4f8b\uff1a\u5b50\u8fdb\u7a0b\u9000\u51fa\uff0c\u7236\u8fdb\u7a0b\u56de\u6536\u5b50\u8fdb\u7a0b\uff08\u53c2\u8003\uff1ajz2440\\process\\4th_exit_wait\\exit_wait.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'1 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a \u4f7f\u7528exit\u9000\u51fa\u5b50\u8fdb\u7a0b\uff0c\u7236\u8fdb\u7a0b\u4f7f\u7528waitpid\u56de\u6536\u5b50\u8fdb\u7a0b\u7684\u8d44\u6e90\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 #include <unistd.h>\n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <sys/types.h>\n14 #include <sys/wait.h>\n15 \n16 int main(int argc, char *argv[])\n17 {\n18 \tint status = -1;\n19 \tpid_t pid;\n20 \n21 \tpid = fork();\n22 \tif (pid == 0){ //\u5b50\u8fdb\u7a0b\n23 \t\tprintf("fork\\n");\n24 \t\texit(1);\n25 \t} else if (pid > 0) { //\u7236\u8fdb\u7a0b\n26 \t\tpid = waitpid(pid, &status, 0);\n27 \t\tprintf("status=0x%x\\n", status);\n28 \t} else {\n29 \t\tperror("fork\\n");\n30 \t}\n31 \n32 \treturn 0;\n33 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc exit_wait.c -o exit_wait\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp exit_wait /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./exit_wait\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd0\u884c\u7ed3\u679c"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image009.png",alt:"ProcessCommunication_Image009"})}),"\n",(0,i.jsx)(e.h2,{id:"42-\u8fdb\u7a0b\u4e3a\u4ec0\u4e48\u9700\u8981\u901a\u4fe1",children:"4.2 \u8fdb\u7a0b\u4e3a\u4ec0\u4e48\u9700\u8981\u901a\u4fe1"}),"\n",(0,i.jsxs)(e.p,{children:["\u200b\t\t\u5148\u8ba9\u6211\u4eec\u770b\u5982\u4e0b\u4e24\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f\uff0c\u8fd9\u4e24\u4e2a\u7a0b\u5e8f\u4e2d\u90fd\u6709\u4e00\u4e2a\u540c\u540d\u5168\u5c40\u53d8\u91cf\u201cglobal\u201d\uff0c\u552f\u4e00\u7684\u533a\u522b\u662f\u8fd9\u4e2a\u5168\u5c40\u53d8\u91cf\u7684\u521d\u59cb\u503c\u4e0d\u540c\u3002",(0,i.jsx)(e.strong,{children:"\u8bf4\u660e\uff1a\u4ee5\u4e0b\u4e24\u4e2a\u793a\u4f8b\u7a0b\u5e8f\u662f\u4e3a\u4e86\u8ba9\u6211\u4eec\u7406\u89e3\u8fdb\u7a0b\u7684\u4e00\u4e2a\u7279\u70b9\uff0c\u56e0\u6b64\u5b9e\u9a8c\u73af\u5883\u662fUbuntu\u865a\u62df\u673a"}),"\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f1\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 #include <stdio.h>\n02 int global = 1;\n03\n04 void delay(void)\n05 {\n06 \tunsigned int a = 1000000;\n07 \twhile(a--);\n08 }\n09\n10 int main(int argc, char *argv[])\n11 {\n12 \twhile (1) {\n13 \t\tprintf("global=%d\\n", global);\n14 \t\tdelay();\n15 \t}\n16 \treturn 0;\n17 }\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f2\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 #include <stdio.h>\n02 int global = 2;\n03\n04 void delay(void)\n05 {\n06 \tunsigned int a = 1000000;\n07 \twhile(a--);\n08 }\n09\n10 int main(int argc, char *argv[])\n11 {\n12 \twhile (1) {\n13 \t\tprintf("global=%d\\n", global);\n14 \t\tdelay();\n15 \t}\n16 \treturn 0;\n17 }\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u4e24\u4e2a\u7a0b\u5e8f\u7684\u552f\u4e00\u533a\u522b\u5982\u4e0b\u7ea2\u6846\u6240\u793a\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image010.png",alt:"ProcessCommunication_Image010"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1\u7a0b\u5e8f"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"gcc test1.c -o test1\ngcc test2.c -o test2\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c\u7a0b\u5e8f"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./test1\n./test2\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image011.png",alt:"ProcessCommunication_Image011"})}),"\n",(0,i.jsx)("center",{children:(0,i.jsx)("p",{children:"\u7a0b\u5e8f1\u8fd0\u884c\u7ed3\u679c"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image012.png",alt:"ProcessCommunication_Image012"})}),"\n",(0,i.jsx)("center",{children:(0,i.jsx)("p",{children:"\u7a0b\u5e8f2\u8fd0\u884c\u7ed3\u679c"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u6211\u4eec\u53d1\u73b0\uff0c\u4e24\u4e2a\u7a0b\u5e8f\u8fd0\u884c\u4e4b\u540e\uff0c\u5f53\u524d\u8fdb\u7a0b\u4e2d\u7684\u5168\u5c40\u53d8\u91cfglobal\u7684\u503c\u5e76\u4e0d\u4f1a\u6539\u53d8\uff0c\u5b83\u4e0d\u4f1a\u88ab\u6539\u53d8\u6210\u53e6\u5916\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u7684\u503c\uff0c\u7531\u6b64\u5f15\u51fa\u7684\u8fdb\u7a0b\u7684\u4e00\u4e2a\u7279\u70b9\uff1a**\u8fdb\u7a0b\u8d44\u6e90\u7684\u552f\u4e00\u6027\uff0c\u4e0d\u5171\u4eab\u6027\uff0c\u5b83\u4e0d\u80fd\u8bbf\u95ee\u522b\u7684\u8fdb\u7a0b\u4e2d\u7684\u6570\u636e(\u5730\u5740\u7a7a\u95f4)\uff0c\u4e5f\u4e0d\u80fd\u88ab\u522b\u7684\u8fdb\u7a0b\u8bbf\u95ee\u672c\u8eab\u7684\u6570\u636e(\u5730\u5740\u7a7a\u95f4)\u3002**\u6bcf\u4e2a\u8fdb\u7a0b\u5bf9\u5176\u4ed6\u8fdb\u7a0b\u800c\u8a00\uff0c\u5c31\u662f\u4e00\u4e2a\u9ed1\u76d2(\u540e\u9762\u8bfb\u8005\u5b66\u4e60\u5230\u7ebf\u7a0b\u7684\u65f6\u5019\uff0c\u4f1a\u53d1\u73b0\u5728\u8fd9\u4e2a\u7279\u6027\u4e0a\uff0c\u7ebf\u7a0b\u662f\u6709\u522b\u4e8e\u8fdb\u7a0b\u7684)\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u90a3\u4e48\u4e3a\u4ec0\u4e48\u4f1a\u8fd9\u6837\u5462\uff1f\u8fd9\u662f\u56e0\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u4e3a\u4e86\u4fdd\u8bc1\u7cfb\u7edf\u7684\u5b89\u5168\uff08\u8fdb\u7a0bA\u5954\u6e83\u4e0d\u4f1a\u5f71\u54cd\u8fdb\u7a0bB\uff0c\u8fdb\u7a0bB\u4ecd\u7136\u4f1a\u7ee7\u7eed\u8fd0\u884c\uff09\uff0c\u5b83\u4f1a\u4e3a\u6bcf\u4e2a\u8fdb\u7a0b\u5206\u914d\u7279\u5b9a\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u53ea\u80fd\u5728\u8fd9\u4e2a\u7279\u5b9a\u7684\u5730\u5740\u7a7a\u95f4\u6267\u884c\u6307\u4ee4\u3001\u8bbf\u95ee\u6570\u636e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\u3002\u7a0b\u5e8f\u9700\u8981\u8bbf\u95ee\u67d0\u4e2a\u53d8\u91cf\u65f6\uff0c\u90fd\u662f\u901a\u8fc7\u53d8\u91cf\u5730\u5740\u53bb\u8bbf\u95ee\u8be5\u53d8\u91cf\u7684\uff0c\u5728\u4e0d\u540c\u7684\u8fdb\u7a0b\u4e2d\uff0c\u540c\u540d\u53d8\u91cf\u5bf9\u5e94\u4e0d\u540c\u7684\u5730\u5740(\u5904\u5728\u5f53\u524d\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u8303\u56f4\u5185)\uff0c\u8fdb\u7a0b\u65e0\u6cd5\u8bbf\u95ee\u5206\u914d\u7ed9\u5b83\u7684\u5730\u5740\u8303\u56f4\u4e4b\u5916\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u81ea\u7136\u5c31\u65e0\u6cd5\u83b7\u5f97\u5176\u4ed6\u8fdb\u7a0b\u4e2d\u7684\u53d8\u91cf\u503c\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image013.png",alt:"ProcessCommunication_Image013"})}),"\n",(0,i.jsxs)(e.p,{children:["\u200b\t\t\u8fdb\u7a0b\u95f4\u4e3a\u4f55\u9700\u8981\u901a\u4fe1\u5462\uff1f\u4ece\u4e0a\u9762\u7684\u4e24\u4e2a\u793a\u4f8b\u7a0b\u5e8f\u4e2d\uff0c\u53ef\u4ee5\u5f97\u77e5\uff1a",(0,i.jsx)(e.strong,{children:"\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u65e0\u6cd5\u4e92\u76f8\u8bbf\u95ee\u5bf9\u65b9\u7684\u5730\u5740\u7a7a\u95f4"}),"\u3002\u4f46\u662f\u5728\u6211\u4eec\u5b9e\u9645\u7684\u9879\u76ee\u5f00\u53d1\u4e2d\uff0c\u4e3a\u4e86\u5b9e\u73b0\u5404\u79cd\u5404\u6837\u7684\u529f\u80fd\uff0c\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u4e00\u5b9a\u9700\u8981\u6570\u636e\u4ea4\u4e92\uff0c\u90a3\u4e48\u6211\u4eec\u5e94\u8be5\u5982\u4f55\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u6570\u636e\u4ea4\u4e92\u5462\uff1f\u8fd9\u5c31\u662f\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u76ee\u7684\uff1a",(0,i.jsx)(e.strong,{children:"\u5b9e\u73b0\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6570\u636e\u4ea4\u4e92"}),"\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5728linux\u4e0b\uff0c\u5185\u5b58\u7a7a\u95f4\u88ab\u5212\u5206\u4e3a\u7528\u6237\u7a7a\u95f4\u548c\u5185\u6838\u7a7a\u95f4\uff0c\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u5f00\u53d1\u7684\u5e94\u7528\u7a0b\u5e8f\u90fd\u5b58\u5728\u4e8e\u7528\u6237\u7a7a\u95f4\uff0c\u7edd\u5927\u90e8\u5206\u8fdb\u7a0b\u90fd\u5904\u5728\u7528\u6237\u7a7a\u95f4\uff1b\u9a71\u52a8\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u5f00\u53d1\u7684\u9a71\u52a8\u7a0b\u5e8f\u90fd\u5b58\u5728\u4e8e\u5185\u6838\u7a7a\u95f4\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5728\u7528\u6237\u7a7a\u95f4\uff0c\u4e0d\u540c\u8fdb\u7a0b\u4e0d\u80fd\u4e92\u76f8\u8bbf\u95ee\u5bf9\u65b9\u7684\u8d44\u6e90\uff0c\u56e0\u6b64\uff0c\u5728\u7528\u6237\u7a7a\u95f4\u662f\u65e0\u6cd5\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u3002\u4e3a\u4e86\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff0c\u5fc5\u987b\u5728\u5185\u6838\u7a7a\u95f4\uff0c\u7531\u5185\u6838\u63d0\u4f9b\u76f8\u5e94\u7684\u63a5\u53e3\u6765\u5b9e\u73b0\uff0clinux\u7cfb\u7edf\u63d0\u4f9b\u4e86\u5982\u4e0b\u56db\u79cd\u8fdb\u7a0b\u901a\u4fe1\u65b9\u5f0f\u3002"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f"}),(0,i.jsx)(e.th,{children:"\u5206\u7c7b"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u7ba1\u9053\u901a\u4fe1"}),(0,i.jsx)(e.td,{children:"\u65e0\u540d\u7ba1\u9053\u3001\u6709\u540d\u7ba1\u9053"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"IPC\u901a\u4fe1"}),(0,i.jsx)(e.td,{children:"\u5171\u4eab\u5185\u5b58\u3001\u6d88\u606f\u961f\u5217\u3001\u4fe1\u53f7\u706f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u4fe1\u53f7\u901a\u4fe1"}),(0,i.jsx)(e.td,{children:"\u4fe1\u53f7\u53d1\u9001\u3001\u63a5\u6536\u3001\u5904\u7406"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"socket\u901a\u4fe1"}),(0,i.jsx)(e.td,{children:"\u672c\u5730socket\u901a\u4fe1\uff0c\u8fdc\u7a0bsocket\u901a\u4fe1"})]})]})]}),"\n",(0,i.jsxs)(e.p,{children:["\u200b\t\tlinux\u6709\u4e00\u4e2a\u6700\u57fa\u672c\u7684\u601d\u60f3----\u201c",(0,i.jsx)(e.strong,{children:"\u4e00\u5207\u7686\u6587\u4ef6"}),"\u201d\uff0c\u5185\u6838\u4e2d\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1\u4e5f\u662f\u57fa\u4e8e\u6587\u4ef6\u8bfb\u5199\u601d\u60f3\u3002\u4e0d\u540c\u8fdb\u7a0b\u901a\u8fc7\u64cd\u4f5c\u5185\u6838\u91cc\u7684\u540c\u4e00\u4e2a\u5185\u6838\u5bf9\u8c61\u6765\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8fd9\u4e2a\u5185\u6838\u5bf9\u8c61\u53ef\u4ee5\u662f\u7ba1\u9053\u3001\u5171\u4eab\u5185\u5b58\u3001\u6d88\u606f\u961f\u5217\u3001\u4fe1\u53f7\u706f\u3001\u4fe1\u53f7\uff0c\u4ee5\u53casocket\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image014.png",alt:"ProcessCommunication_Image014"})}),"\n",(0,i.jsx)(e.h2,{id:"43-\u8fdb\u7a0b\u901a\u4fe1\u4e4b\u7ba1\u9053\u901a\u4fe1",children:"4.3 \u8fdb\u7a0b\u901a\u4fe1\u4e4b\u7ba1\u9053\u901a\u4fe1"}),"\n",(0,i.jsx)(e.p,{children:"\u7ba1\u9053\u5206\u4e3a\u65e0\u540d\u7ba1\u9053\u548c\u6709\u540d\u7ba1\u9053\uff0c\u5176\u7279\u70b9\u5982\u4e0b"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,i.jsx)(e.th,{children:"\u7279\u70b9"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u65e0\u540d\u7ba1\u9053"}),(0,i.jsxs)(e.td,{children:["\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6ca1\u6709\u6587\u4ef6\u8282\u70b9\uff0c",(0,i.jsx)(e.strong,{children:"\u53ea\u80fd\u7528\u4e8e\u5177\u6709\u4eb2\u7f18\u5173\u7cfb\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1(\u6bd4\u5982\u7236\u5b50\u8fdb\u7a0b)"})]})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u6709\u540d\u7ba1\u9053"}),(0,i.jsxs)(e.td,{children:["\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u6709\u6587\u4ef6\u8282\u70b9\uff0c",(0,i.jsx)(e.strong,{children:"\u9002\u7528\u4e8e\u5728\u540c\u4e00\u7cfb\u7edf\u4e2d\u7684\u4efb\u610f\u4e24\u4e2a\u8fdb\u7a0b\u95f4\u901a\u4fe1"})]})]})]})]}),"\n",(0,i.jsx)(e.h3,{id:"431-\u65e0\u540d\u7ba1\u9053",children:"4.3.1 \u65e0\u540d\u7ba1\u9053"}),"\n",(0,i.jsx)(e.h4,{id:"4311-\u7279\u70b9",children:"4.3.1.1 \u7279\u70b9"}),"\n",(0,i.jsxs)(e.p,{children:["\u200b\t\t\u65e0\u540d\u7ba1\u9053\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u4e2a\u5355\u5411\u961f\u5217\uff0c",(0,i.jsx)(e.strong,{children:"\u5728\u4e00\u7aef\u8fdb\u884c\u8bfb\u64cd\u4f5c\uff0c\u5728\u53e6\u4e00\u7aef\u8fdb\u884c\u5199\u64cd\u4f5c"}),"\uff0c\u6240\u4ee5\u9700\u8981\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u63cf\u8ff0\u7b26fd[0]\u6307\u5411\u8bfb\u7aef\uff0cfd[1]\u6307\u5411\u5199\u7aef\u3002\u5b83\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u6587\u4ef6\uff0c\u6240\u4ee5\u65e0\u6cd5\u4f7f\u7528\u7b80\u5355open\u51fd\u6570\u521b\u5efa\uff0c\u6211\u4eec\u9700\u8981pipe\u51fd\u6570\u6765\u521b\u5efa\u3002\u5b83\u53ea\u80fd\u7528\u4e8e\u5177\u6709\u4eb2\u7f18\u5173\u7cfb\u7684\u4e24\u4e2a\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3002"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image015.png",alt:"ProcessCommunication_Image015"})}),"\n",(0,i.jsx)(e.h4,{id:"4312-\u521b\u5efa\u65e0\u540d\u7ba1\u9053",children:"4.3.1.2 \u521b\u5efa\u65e0\u540d\u7ba1\u9053"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"1.\u5934\u6587\u4ef6#include <unistd.h>\n\n2.\u51fd\u6570\u539f\u578b: int pipe(int fd[2])\n\n3.\u53c2\u6570: \u7ba1\u9053\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u6709\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5206\u522b\u662ffd[0]\u548cfd[1]\uff0c\u7ba1\u9053\u6709\u4e00\u4e2a\u8bfb\u7aeffd[0]\u548c\u4e00\u4e2a\u5199\u7aeffd[1]\n\n4.\u8fd4\u56de\u503c\uff1a 0\u8868\u793a\u6210\u529f\uff1b-1\u8868\u793a\u5931\u8d25\n"})}),"\n",(0,i.jsx)(e.h4,{id:"4313-\u8bfb\u5199\u5173\u95ed\u7ba1\u9053",children:"4.3.1.3 \u8bfb\u3001\u5199\u3001\u5173\u95ed\u7ba1\u9053"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"1.\u8bfb\u7ba1\u9053 read\uff0c\u8bfb\u7ba1\u9053\u5bf9\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u662ffd[0]\n\n2.\u5199\u7ba1\u9053 write\uff0c\u5199\u7ba1\u9053\u5bf9\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u662ffd[1]\n\n3.\u5173\u95ed\u7ba1\u9053 close\uff0c\u56e0\u4e3a\u521b\u5efa\u7ba1\u9053\u65f6\uff0c\u4f1a\u540c\u65f6\u521b\u5efa\u4e24\u4e2a\u7ba1\u9053\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5206\u522b\u662f\u8bfb\u7ba1\u9053\u6587\u4ef6\u63cf\u8ff0\u7b26fd[0]\u548c\u5199\u7ba1\u9053\u6587\u4ef6\u63cf\u8ff0\u7b26fd[1]\uff0c\u56e0\u6b64\u9700\u8981\u5173\u95ed\u4e24\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\n"})}),"\n",(0,i.jsx)(e.h4,{id:"4314-\u65e0\u540d\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",children:"4.3.1.4 \u65e0\u540d\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7a0b\u5e8f\u793a\u4f8b1"})}),"\n",(0,i.jsx)(e.p,{children:"\uff08\u53c2\u8003\uff1ajz2440\\process_pipe\\1th_write_pipe\\my_pipe_write.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a \u521b\u5efa\u4e00\u4e2a\u7ba1\u9053\uff0c\u5e76\u5411\u7ba1\u9053\u4e2d\u5199\u5165\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u4ece\u7ba1\u9053\u4e2d\u8bfb\u53d6\uff0c\u9a8c\u8bc1\n03               \u80fd\u5426\u8bfb\u53d6\u4e4b\u524d\u5199\u5165\u7684\u5b57\u7b26\u4e32\n04  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n05  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n06  * \u8fd4 \u56de \u503c\uff1a \u65e0\n07  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n08  * -----------------------------------------------\n09  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n10  ***********************************************************************/\n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 \n15 int main(int argc, char *argv[])\n16 {\n17     int fd[2];\n18     int ret = 0;\n19     char write_buf[] = "Hello linux";\n20     char read_buf[128] = {0};\n21     \n22     ret = pipe(fd);\n23     if (ret < 0) {\n24         printf("create pipe fail\\n");\n25         return -1;\n26     }\n27     printf("create pipe sucess fd[0]=%d fd[1]=%d\\n", fd[0], fd[1]);\n28     \n29     //\u5411\u6587\u4ef6\u63cf\u8ff0\u7b26fd[1]\u5199\u7ba1\u9053\n30     write(fd[1], write_buf, sizeof(write_buf));\n31     \n32     //\u4ece\u6587\u4ef6\u63cf\u8ff0\u7b26fd[0]\u8bfb\u7ba1\u9053\n33     read(fd[0], read_buf, sizeof(read_buf));\n34     printf("read_buf=%s\\n", read_buf);\n35     \n36     close(fd[0]);\n37     close(fd[1]);\n38     return 0;\n39 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc my_pipe_write.c -o my_pipe_write\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp my_pipe_write /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./my_pipe_write\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd0\u884c\u7ed3\u679c\uff0c\u53d1\u73b0\u80fd\u591f\u6b63\u786e\u8bfb\u5230\u7ba1\u9053\u4e2d\u7684\u5b57\u7b26\u4e32\u201d Hello linux\u201d\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7a0b\u5e8f\u793a\u4f8b2"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5728\u5229\u7528\u65e0\u540d\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1\u4e4b\u524d\uff0c\u5148\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u5982\u4e0b\u7684\u7a0b\u5e8f\uff1a\u6211\u4eec\u77e5\u9053\u7236\u5b50\u8fdb\u7a0b\u7684\u6267\u884c\u987a\u5e8f\u662f\u4e0d\u786e\u5b9a\u7684\uff0c\u662f\u53d7\u7cfb\u7edf\u8c03\u5ea6\u7684\u3002\u6211\u4eec\u5728\u7236\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\u6211\u4eec\u60f3\u8ba9\u7236\u8fdb\u7a0b\u63a7\u5236\u5b50\u8fdb\u7a0b\u7684\u8fd0\u884c\uff0c\u7236\u8fdb\u7a0b\u8bbe\u7f6e\u201cprocess_inter=1\u201d\uff0c\u5f53\u201cprocess_inter=1\u201d\u65f6\uff0c\u5b50\u8fdb\u7a0b\u624d\u4f1a\u6267\u884c\u6253\u5370\u64cd\u4f5c\uff0c\u5426\u5219\u5b50\u8fdb\u7a0b\u4e0d\u6267\u884c\u6253\u5370\u64cd\u4f5c\u3002\u6211\u4eec\u770b\u5982\u4e0b\u7684\u7a0b\u5e8f\u80fd\u591f\u5b9e\u73b0\u6211\u4eec\u7684\u76ee\u7684\u5417\uff1f"}),"\n",(0,i.jsx)(e.p,{children:"\uff08\u53c2\u8003\uff1ajz2440\\process_pipe\\2th_comm\\test.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u5728\u7236\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c\n03             2.\u7236\u8fdb\u7a0b\u6267\u884c\u5b8c\u540e\uff0c\u5c06\u53d8\u91cfprocess_inter\u8d4b\u503c\u4e3a1\uff1b\n04             3.\u5b50\u8fdb\u7a0b\u5224\u65adprocess_inter\u4e3a1\u5219\u6267\u884c\u540e\u9762\u7684\u6253\u5370\u8bed\u53e5\uff0c\u5426\u5219\u4e0d\u6267\u884c\u3002\n05  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n06  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n07  * \u8fd4 \u56de \u503c\uff1a \u65e0\n08  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n09  * -----------------------------------------------\n10  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n11  ***********************************************************************/\n12 #include <stdio.h>\n13 #include <stdlib.h>\n14 #include <unistd.h>\n15 #include <sys/types.h>\n16 \n17 int main(int argc, char *argv[])\n18 {\n19     pid_t pid;\n20     int process_inter = 0;\n21 \n22     pid = fork();  // \u521b\u5efa\u5b50\u8fdb\u7a0b\n23 \n24     if (pid == 0) {  // \u5b50\u8fdb\u7a0b\n25         int i = 0;\n26         while (process_inter == 0); //\n27         for (i = 0; i < 5; i++) {\n28             usleep(100);\n29             printf("this is child process i=%d\\n", i);\n30         }\n31     }\n32     \n33     if (pid > 0) {  // \u7236\u8fdb\u7a0b\n34         int i = 0;\n35         for (i = 0; i < 5; i++) {\n36             usleep(100);\n37             printf("this is parent process i=%d\\n", i);\n38         }\n39         process_inter == 1;\n40     }\n41 \n42     while(1);\n43     return 0;\n44 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc test.c -o test\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp test /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./test\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd0\u884c\u7ed3\u679c\uff0c\u53d1\u73b0\u7b2c29\u884c\u6253\u5370\u8bed\u53e5\u4e00\u76f4\u6ca1\u6709\uff0c\u5b50\u8fdb\u7a0b\u4e2dprocess_inter\u4e00\u76f4\u4e3a0\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image017.png",alt:"ProcessCommunication_Image017"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7a0b\u5e8f\u793a\u4f8b3"})}),"\n",(0,i.jsx)(e.p,{children:"\uff08\u53c2\u8003\uff1ajz2440\\process_pipe\\3th_pipe_comm\\comm_fork.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u4f7f\u7528\u65e0\u540d\u7ba1\u9053\u5b9e\u73b0\u7236\u5b50\u8fdb\u7a0b\u901a\u4fe1\n03             2.\u7236\u8fdb\u7a0b\u5411\u7ba1\u9053\u4e2d\u5199\u5165\u4e00\u4e2a\u503c\n04             3.\u5b50\u8fdb\u7a0b\u4ece\u7ba1\u9053\u4e2d\u8bfb\u53d6\u8be5\u503c\uff0c\u5982\u679c\u975e\u96f6\uff0c\u5219\u6267\u884c\u540e\u9762\u7684\u6253\u5370\uff0c\u5426\u5219\u4e0d\u6267\u884c\n05  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n06  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n07  * \u8fd4 \u56de \u503c\uff1a \u65e0\n08  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n09  * -----------------------------------------------\n10  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n11  ***********************************************************************/\n12 \n13 #include <stdio.h>\n14 #include <stdlib.h>\n15 #include <unistd.h>\n16 #include <sys/types.h>\n17 \n18 int main(int argc, char *argv[])\n19 {\n20     pid_t pid;\n21     char process_inter = 0;\n22     int fd[2], ret = 0;\n23 \n24     ret = pipe(fd);   //\u521b\u5efa\u4e00\u4e2a\u65e0\u540d\u7ba1\u9053\uff0c\u5fc5\u987b\u5728\u521b\u5efa\u5b50\u8fdb\u7a0b\u4e4b\u524d\n25     if (ret < 0) {\n26         printf("create pipe fail\\n");\n27         return -1;\n28     }\n29     printf("create pipe sucess\\n");\n30     \n31     pid = fork();  //\u521b\u5efa\u5b50\u8fdb\u7a0b\n32 \n33     if (pid == 0) {  // \u5b50\u8fdb\u7a0b\n34         int i = 0;\n35         read(fd[0], &process_inter, sizeof(process_inter));  // \u5982\u679c\u7ba1\u9053\u4e3a\u7a7a\uff0c\u5219\u4f11\u7720\u7b49\u5f85\n36         while (process_inter == 0);\n37         for (i = 0; i < 5; i++) {\n38             usleep(100);\n39             printf("this is child process i=%d\\n", i);\n40         }\n41     } else if (pid > 0) {  // \u7236\u8fdb\u7a0b\n42         int i = 0;\n43         for (i = 0; i < 5; i++) {\n44             usleep(100);\n45             printf("this is parent process i=%d\\n", i);\n46         }\n47         process_inter = 1;\n48         sleep(2);\n49         write(fd[1], &process_inter, sizeof(process_inter));\n50     }\n51 \n52     while(1);\n53     return 0;\n54 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc comm_fork.c -o comm_fork\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp comm_fork /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./comm_fork\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd0\u884c\u7ed3\u679c\uff0c\u56e0\u4e3a\u7b2c38\u884c2s\u5ef6\u65f6\uff0c\u7236\u8fdb\u7a0b\u6253\u5370\u7ed3\u675f\u540e\u5927\u7ea62s\u5de6\u53f3\u7684\u65f6\u95f4\uff0c\u5b50\u8fdb\u7a0b\u4e2d\u7684\u6253\u5370\u4e5f\u6b63\u786e\u8f93\u51fa\u4e86\uff0c\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image018.png",alt:"ProcessCommunication_Image018"})}),"\n",(0,i.jsx)(e.h3,{id:"432-\u6709\u540d\u7ba1\u9053",children:"4.3.2 \u6709\u540d\u7ba1\u9053"}),"\n",(0,i.jsx)(e.h4,{id:"4321-\u7279\u70b9",children:"4.3.2.1 \u7279\u70b9"}),"\n",(0,i.jsx)(e.p,{children:"\u6240\u8c13\u6709\u540d\u7ba1\u9053\uff0c\u987e\u540d\u601d\u4e49\uff0c\u5c31\u662f\u5728\u5185\u6838\u4e2d\u5b58\u5728\u4e00\u4e2a\u6587\u4ef6\u540d\uff0c\u8868\u660e\u8fd9\u662f\u4e00\u4e2a\u7ba1\u9053\u6587\u4ef6\u3002Linux\u4e2d\u5b58\u57287\u79cd\u6587\u4ef6\u7c7b\u578b\uff0c\u5206\u522b\u5982\u4e0b\u3002"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u6587\u4ef6\u7c7b\u578b"}),(0,i.jsx)(e.th,{children:"\u6587\u4ef6\u7279\u70b9"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u666e\u901a\u6587\u4ef6"}),(0,i.jsx)(e.td,{children:"\u6807\u8bc6\u7b26 \u2018-\u2019 \uff0c\u7528open\u65b9\u5f0f\u521b\u5efa"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u76ee\u5f55\u6587\u4ef6"}),(0,i.jsx)(e.td,{children:"\u6807\u8bc6\u7b26 \u2018d\u2019 \uff0c\u7528mkdir\u65b9\u5f0f\u521b\u5efa"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u94fe\u63a5\u6587\u4ef6"}),(0,i.jsx)(e.td,{children:"\u6807\u8bc6\u7b26 \u2018l\u2019, la -s\uff0c \u53c8\u53ef\u4ee5\u5206\u4e3a\u8f6f\u94fe\u63a5\uff0c\u786c\u94fe\u63a5"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"(\u6709\u540d)\u7ba1\u9053\u6587\u4ef6"}),(0,i.jsx)(e.td,{children:"\u6807\u8bc6 \u2018p\u2019\uff0c \u7528mkfifo\u521b\u5efa"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"socket\u6587\u4ef6"}),(0,i.jsx)(e.td,{children:"\u6807\u8bc6\u7b26 \u2018s\u2019\uff0c\u7528socket\u521b\u5efa"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5b57\u7b26\u8bbe\u5907\u6587\u4ef6"}),(0,i.jsx)(e.td,{children:"\u6807\u8bc6\u7b26 \u2018c\u2019"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5757\u8bbe\u5907\u6587\u4ef6"}),(0,i.jsx)(e.td,{children:"\u6807\u8bc6\u7b26 \u2018b\u2019"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u6709\u540d\u7ba1\u9053\u65e2\u53ef\u4ee5\u7528\u4e8e\u5177\u6709\u4eb2\u7f18\u5173\u7cfb\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff0c\u53c8\u53ef\u4ee5\u7528\u4e8e\u975e\u4eb2\u7f18\u5173\u7cfb\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff0c\u5728\u6211\u4eec\u7684\u5b9e\u9645\u9879\u76ee\u4e2d\uff0c\u5f88\u591a\u8fdb\u7a0b\u4e4b\u95f4\u662f\u4e0d\u5177\u6709\u4eb2\u7f18\u5173\u7cfb\u7684\uff0c\u56e0\u6b64\u6709\u540d\u7ba1\u9053\u4f7f\u7528\u7684\u60c5\u51b5\u4f1a\u66f4\u666e\u904d\u4e00\u4e9b\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"4322-\u521b\u5efa\u6709\u540d\u7ba1\u9053",children:"4.3.2.2 \u521b\u5efa\u6709\u540d\u7ba1\u9053"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u51fd\u6570\u539f\u578b \uff1a int mkfifo(const char * filename, mode_t mode)\n\n\u53c2\u6570 \uff1a\u7ba1\u9053\u6587\u4ef6\u6587\u4ef6\u540d\uff0c\u6743\u9650\uff0c\u521b\u5efa\u7684\u6587\u4ef6\u6743\u9650\u4ecd\u7136\u548cumask\u6709\u5173\u7cfb\n\n\u8fd4\u56de\u503c \uff1a \u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56de-1\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\uff1amkfifo\u5e76\u6ca1\u6709\u5728\u5185\u6838\u4e2d\u751f\u6210\u4e00\u4e2a\u7ba1\u9053\uff0c\u53ea\u662f\u5728\u7528\u6237\u7a7a\u95f4\u751f\u6210\u4e86\u4e00\u4e2a\u6709\u540d\u7ba1\u9053\u6587\u4ef6"}),"\n",(0,i.jsx)(e.h4,{id:"4323-\u6709\u540d\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",children:"4.3.2.3 \u6709\u540d\u7ba1\u9053\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u793a\u4f8b\u7a0b\u5e8f1"})}),"\n",(0,i.jsx)(e.p,{children:"\u521b\u5efa\u4e00\u4e2a\u6709\u540d\u7ba1\u9053\u6587\u4ef6(\u53c2\u8003\uff1ajz2440\\process_pipe\\4th_create_myfifo\\create_myfifo.c)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u521b\u5efa\u4e00\u4e2a\u6709\u540d\u7ba1\u9053\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 \n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 #include <sys/types.h>\n15 \n16 int main(int argc, char *argv[])\n17 {\n18     int ret;\n19 \n20     ret = mkfifo("./myfifo", 0777);   //\u521b\u5efa\u6709\u540d\u7ba1\u9053\uff0c\u6587\u4ef6\u6743\u9650\u4e3a777\n21     if (ret < 0) {\n22         printf("create myfifo fail\\n");\n23         return -1;\n24     }\n25     printf("create myfifo sucess\\n");\n26     \n27     return 0;\n28 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc create_myfifo.c -o create_myfifo\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp create_myfifo /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./create_myfifo\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd0\u884c\u7ed3\u679c\uff0c\u53d1\u73b0\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2a\u6709\u540d\u7ba1\u9053\u6587\u4ef6myfifo\uff08\u6587\u4ef6\u7c7b\u578b\u662f\u201c-p\u201d\uff09\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image019.png",alt:"ProcessCommunication_Image019"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u793a\u4f8b\u7a0b\u5e8f2"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fdb\u7a0b1\u6e90\u7801(\u53c2\u8003\uff1ajz2440\\process_pipe\\5th_myfifo_comm\\5nd_named_pipe.c)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u8fdb\u7a0b1\u4e2d\u521b\u5efa\u4e00\u4e2a\u6709\u540d\u7ba1\u90533rd_fifo\uff0c\u6743\u9650\u662f0777\n03             2.\u4ee5\u5199\u65b9\u5f0f\u6253\u5f00\u8fd9\u4e2a\u6709\u540d\u7ba1\u9053\u6587\u4ef6\uff0c\u5e76\u5411\u5176\u4e2d\u5199\u5165\u4e00\u4e2a\u503c\n04  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n05  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n06  * \u8fd4 \u56de \u503c\uff1a \u65e0\n07  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n08  * -----------------------------------------------\n09  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n10  ***********************************************************************/\n11 \n12 #include <stdio.h>\n13 #include <stdlib.h>\n14 #include <unistd.h>\n15 #include <sys/types.h>\n16 #include <fcntl.h>\n17 \n18 int main(int argc, char *argv[])\n19 {\n20     int i, ret, fd;\n21     char p_flag = 0;\n22 \n23     /* \u521b\u5efa\u6709\u540d\u7ba1\u9053 */\n24     if (access("./3rd_fifo", 0) < 0) {   //\u5148\u5224\u65ad\u6709\u540d\u7ba1\u9053\u6587\u4ef6\u662f\u5426\u5b58\u5728,\u4e0d\u5b58\u5728\u9700\u8981\u5148\u521b\u5efa\n25         ret = mkfifo("./3rd_fifo", 0777);\n26         if (ret < 0) {\n27             printf("create named pipe fail\\n");\n28             return -1;\n29         }\n30         printf("create named pipe sucess\\n");\n31     }\n32     \n33     /* \u6253\u5f00\u6709\u540d\u7ba1\u9053\uff0c\u4ee5\u5199\u65b9\u5f0f\u6253\u5f00 */\n34     fd=open("./3rd_fifo", O_WRONLY);\n35     if (fd < 0) {\n36         printf("open 3rd_fifo fail\\n");\n37         return -1;\n38     }\n39     printf("open 3rd_fifo sucess\\n");\n40 \n41     for (i = 0; i < 5; i++) {\n42         printf("this is first process i=%d\\n", i);\n43         usleep(100);\n44     }\n45     p_flag = 1;\n46     sleep(5);\n47     write(fd, &p_flag, sizeof(p_flag));\n48 \n49     while(1);\n50     return 0;\n51 }\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u8fdb\u7a0b2\u6e90\u7801(\u53c2\u8003\uff1ajz2440\\process_pipe\\5th_myfifo_comm\\5nd_named_pipe_2.c)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00\u8fd9\u4e2a\u6709\u540d\u7ba1\u9053\u6587\u4ef6\uff0c\u5e76\u8bfb\u53d6\u8fd9\u4e2a\u503c\n03             2.\u5f53\u8fd9\u4e2a\u503c\u975e\u96f6\u65f6\uff0c\u7ee7\u7eed\u6267\u884c\u540e\u9762\u7684\u6253\u5370\u8f93\u51fa\u8bed\u53e5\n04  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n05  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n06  * \u8fd4 \u56de \u503c\uff1a \u65e0\n07  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n08  * -----------------------------------------------\n09  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n10  ***********************************************************************/\n11 \n12 #include <stdio.h>\n13 #include <stdlib.h>\n14 #include <unistd.h>\n15 #include <sys/types.h>\n16 #include <fcntl.h>\n17 \n18 int main(int argc, char *argv[])\n19 {\n20     int i;\n21     int fd=open("./3rd_fifo", O_RDONLY);\n22     char p_flag = 0;\n23     \n24     if (fd < 0) {\n25         printf("open 3rd_fifo fail\\n");\n26         return -1;\n27     }\n28     \n29     printf("open 3rd_fifo sucess\\n");\n30     read(fd, &p_flag, sizeof(p_flag));\n31     while(!p_flag);\n32     for (i = 0; i < 5; i++) {\n33         printf("this is second process i=%d\\n", i);\n34         usleep(100);\n35     }\n36 \n37     while(1);\n38     return 0;\n39 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc 5nd_named_pipe.c -o 5nd_named_pipe\n\narm-linux-gcc 5nd_named_pipe_2.c -o 5nd_named_pipe_2\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp 5nd_named_pipe /work/nfs_root/first_fs\n\ncp 5nd_named_pipe_2 /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6ce8\u610f\u6211\u4eec\u8fd9\u91cc\u90fd\u5728\u540e\u53f0\u8fd0\u884c\u53ef\u6267\u884c\u7a0b\u5e8f\uff0c\u65b9\u4fbf\u6211\u4eec\u5728\u4e32\u53e3\u4e2d\u65ad\u4e0b\u591a\u6b21\u8f93\u5165\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./5nd_named_pipe &\n\n./5nd_named_pipe_2 &\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image020.png",alt:"ProcessCommunication_Image020"})}),"\n",(0,i.jsx)(e.h2,{id:"44-\u8fdb\u7a0b\u901a\u4fe1\u4e4bipc\u901a\u4fe1",children:"4.4 \u8fdb\u7a0b\u901a\u4fe1\u4e4bIPC\u901a\u4fe1"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\tIPC\u901a\u4fe1\u5206\u4e3a\u5171\u4eab\u5185\u5b58\u3001\u6d88\u606f\u961f\u5217\u4ee5\u53ca\u4fe1\u53f7\u706f\u3002\u8fd9\u4e9bIPC\u5bf9\u8c61\uff08\u5171\u4eab\u5185\u5b58\u3001\u6d88\u606f\u961f\u5217\u3001\u4fe1\u53f7\u706f\uff09\u90fd\u5b58\u5728\u4e8e\u5185\u6838\u7a7a\u95f4\u4e2d\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528IPC\u901a\u4fe1\u7684\u4e00\u822c\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u9996\u5148\u751f\u6210\u4e00\u4e2akey\u503c\u3002\u6709\u4e24\u79cd\u751f\u6210key\u7684\u65b9\u5f0f\uff0c\u4e00\u79cd\u662f\u4f7f\u7528\u5b8fIPC_PRIVATE\u8868\u793a\u4e00\u4e2akey\uff0c\u5b83\u8868\u793a\u4e00\u4e2a\u79c1\u6709\u5bf9\u8c61\uff0c\u53ea\u80fd\u7528\u4e8e\u5f53\u524d\u8fdb\u7a0b\u6216\u8005\u5177\u6709\u4eb2\u7f18\u5173\u7cfb\u7684\u8fdb\u7a0b\u8bbf\u95ee\u3002\u53e6\u4e00\u79cd\u662f\u4f7f\u7528ftok\u51fd\u6570\u6765\u751f\u6210\u4e00\u4e2akey\u503c\uff0c\u8fd9\u79cd\u65b9\u5f0f\u521b\u5efa\u7684IPC\u5bf9\u8c61\u53ef\u4ee5\u88ab\u4e0d\u540c\u7684\u8fdb\u7a0b\u8bbf\u95ee\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u751f\u6210\u7684key\u503c\uff0c\u521b\u5efa\u4e00\u4e2aIPC\u5bf9\u8c61\uff08\u5982\u679c\u662f\u5df2\u7ecf\u521b\u5efa\u597d\u7684IPC\u5bf9\u8c61\uff0c\u5219\u6253\u5f00\u8be5IPC\u5bf9\u8c61\uff09\uff0c\u8fd9\u4e2a\u65f6\u5019\u6bcf\u4e2aIPC\u5bf9\u8c61\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684ID\u53f7\uff08IPC_id\uff0c\u53ef\u4ee5\u662fshm_id\uff0cmsg_id\uff0csem_id\uff0c\u6bcf\u4e2aid\u4ee3\u8868\u4e00\u4e2aIPC\u5bf9\u8c61\uff09\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8fdb\u7a0b\u901a\u8fc7IPC_id\uff0c\u8c03\u7528\u8bbf\u95eeIPC\u901a\u9053\u7684\u8bfb\u5199\u51fd\u6570\u6765\u64cd\u4f5cIPC\u5bf9\u8c61\u3002\u8c03\u7528shmctrl\uff0cshmat\uff0cshmdt\u6765\u8bbf\u95ee\u5171\u4eab\u5185\u5b58\uff1b\u8c03\u7528msgctrl\uff0cmsgsnd\uff0cmsgrecv\u8bbf\u95ee\u6d88\u606f\u961f\u5217\uff1b\u8c03\u7528semctrl\uff0csemop\u8bbf\u95ee\u4fe1\u53f7\u706f\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image021.png",alt:"ProcessCommunication_Image021"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5982\u4f55\u7406\u89e3key\u548cIPC_id\uff08shm_id/msg_id/sem_id\uff09"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u56de\u7b54\u8fd9\u4e2a\u95ee\u9898\uff0c\u8bf7\u5148\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u8bbf\u95ee\u4e00\u4e2aIPC\u5bf9\u8c61\uff08\u5171\u4eab\u5185\u5b58\uff0c\u6d88\u606f\u961f\u5217\u3001\u4fe1\u53f7\u91cf\u706f\uff09\uff1f"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u663e\u7136\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u552f\u4e00\u8868\u793a\u8be5IPC\u5bf9\u8c61\u7684\u8eab\u4efdID\uff08IPC_id\uff0c\u8be5IPC_id\u662f\u7531\u64cd\u4f5c\u7cfb\u7edf\u6765\u7ba1\u7406\u7684\uff09\uff0c\u4f46\u662f\u7531\u4e8e\u8fd9\u4e2aID\u53ea\u5728\u5f53\u524d\u521b\u5efa\u8be5IPC\u5bf9\u8c61\u7684\u8fdb\u7a0b\u4e2d\u53ef\u4ee5\u83b7\u53d6\u5230\uff0c\u5728\u522b\u7684IPC\u8fdb\u7a0b\u4e2d\u90fd\u6ca1\u6cd5\u83b7\u53d6\uff0c\u90a3\u4e48\u5982\u4f55\u5f97\u5230IPC\u5bf9\u8c61\u7684ID\u5462\uff1f\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981key\u503c\u4e86\uff0c\u5b83\u76f8\u5f53\u4e8eIPC_id\u7684\u4e00\u4e2a\u522b\u540d\uff0c\u6216\u8005\u53eb\u505a\u5916\u90e8\u540d\uff0c\u56e0\u6b64key\u503c\u5fc5\u987b\u4e5f\u662f\u552f\u4e00\u7684\uff0c\u8fd9\u6837\u624d\u80fd\u5f97\u5230\u552f\u4e00\u7684IPC\u5bf9\u8c61id\u3002\u4e0d\u540c\u8fdb\u7a0b\u901a\u8fc7\u540c\u4e00\u4e2akey\u503c\u5f97\u5230\u540c\u4e00\u4e2aIPC\u5bf9\u8c61id\uff0c\u6765\u8bbf\u95ee\u540c\u4e00\u4e2aIPC\u5bf9\u8c61\u3002\u5982\u4e0b\u56fe\u6240\u793a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image022.png",alt:"ProcessCommunication_Image022"})}),"\n",(0,i.jsx)(e.p,{children:"ftok\u51fd\u6570"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u51fd\u6570\u539f\u578b : char ftok(const char *path, char key)\n\n\u53c2\u6570 \uff1a path\uff0c\u5b58\u5728\u5e76\u4e14\u53ef\u4ee5\u8bbf\u95ee\u7684\u6587\u4ef6\u8def\u5f84\n\n       key\uff0c\u4e00\u4e2a\u5b57\u7b26\n\n\u8fd4\u56de\u503c \uff1a \u6b63\u786e\u8fd4\u56de\u4e00\u4e2akey\u503c\uff0c\u51fa\u9519\u8fd4\u56de-1\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u4e3a\u4f55\u9700\u8981ftok\u51fd\u6570\u5148\u751f\u6210key\uff0c\u7136\u540e\u518d\u521b\u5efaIPC\u5bf9\u8c61\uff1f"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u8fd9\u5c31\u7c7b\u4f3c\u4e8e\u65e0\u540d\u7ba1\u9053\u548c\u6709\u540d\u7ba1\u9053\u7684\u533a\u522b\uff0c\u4f7f\u7528IPC_PRIVATE\u5b8f\u521b\u5efa\u7684\u5171\u4eab\u5185\u5b58\u5c31\u7c7b\u4f3c\u4e8e\u65e0\u540d\u7ba1\u9053\uff0c\u53ea\u80fd\u5b9e\u73b0\u6709\u4eb2\u7f18\u5173\u7cfb\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u90a3\u4e48\u4e3a\u4ec0\u4e48\u53c8\u9700\u8981\u4f7f\u7528ftok\u751f\u6210\u4e00\u4e2akey\u503c\u5462\uff1f\u662f\u5426\u53ef\u4ee5\u76f4\u63a5\u6307\u5b9a\u4e00\u4e2a\u975e\u96f6\u503c\u5462\uff1f\u76f4\u63a5\u6307\u5b9a\u4e00\u4e2a\u975e\u96f6\u7684key\u503c\u505a\u6cd5\u662f\u4e0d\u5efa\u8bae\u7684\uff0c\u56e0\u4e3a\u8bfb\u8005\u81ea\u5df1\u6307\u5b9a\u7684key\u503c\u5f88\u6709\u53ef\u80fd\u4e8e\u7cfb\u7edf\u4e2d\u5df2\u7ecf\u5b58\u5728\u7684key\u503c\u4e00\u6837\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\tftok\u51fd\u6570\u521b\u5efa\u4e86\u4e00\u4e2akey\u503c\u4e4b\u540e\uff0c\u5c31\u7c7b\u4f3c\u4e8e\u6709\u540d\u7ba1\u9053\uff0c\u65e2\u53ef\u4ee5\u5b9e\u73b0\u5177\u6709\u4eb2\u7f18\u5173\u7cfb\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff0c\u53c8\u80fd\u591f\u5b9e\u73b0\u975e\u4eb2\u7f18\u5173\u7cfb\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"441-\u5171\u4eab\u5185\u5b58",children:"4.4.1 \u5171\u4eab\u5185\u5b58"}),"\n",(0,i.jsx)(e.h4,{id:"4411-\u7279\u70b9",children:"4.4.1.1 \u7279\u70b9"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u6240\u8c13\u5171\u4eab\u5185\u5b58\u662f\u6307\u591a\u4e2a\u8fdb\u7a0b\u90fd\u53ef\u4ee5\u8bbf\u95ee\u7684\u540c\u4e00\u5757\u5730\u5740\u7a7a\u95f4\uff0c\u4f46\u662f\u6211\u4eec\u77e5\u9053Linux\u64cd\u4f5c\u7cfb\u7edf\u4e3a\u4e86\u4fdd\u8bc1\u7cfb\u7edf\u6267\u884c\u7684\u5b89\u5168\uff0c\u4e3a\u6bcf\u4e2a\u8fdb\u7a0b\u5212\u5206\u4e86\u5404\u81ea\u72ec\u7acb\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u4e0d\u80fd\u8bbf\u95ee\u522b\u7684\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u5171\u4eab\u5185\u5b58\u5b9e\u73b0\u7684\u539f\u7406\u662f\u4ec0\u4e48\u5462\uff1f"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5185\u6838\u5f00\u8f9f\u4e00\u5757\u7269\u7406\u5185\u5b58\u533a\u57df\uff0c\u8fdb\u7a0b\u672c\u8eab\u5c06\u8fd9\u7247\u5185\u5b58\u7a7a\u95f4\u6620\u5c04\u5230\u81ea\u5df1\u7684\u5730\u5740\u7a7a\u95f4\u8fdb\u884c\u8bfb\u5199\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image023.png",alt:"ProcessCommunication_Image023"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u4ece\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u8fdb\u7a0b\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u8fd9\u7247\u5185\u5b58\uff0c\u6570\u636e\u4e0d\u9700\u8981\u5728\u4e24\u8fdb\u7a0b\u95f4\u590d\u5236\uff0c\u6240\u4ee5\u901f\u5ea6\u8f83\u5feb\u3002\u5171\u4eab\u5185\u5b58\u6ca1\u6709\u4efb\u4f55\u7684\u540c\u6b65\u4e0e\u4e92\u65a5\u673a\u5236\uff0c\u6240\u4ee5\u8981\u4f7f\u7528\u4fe1\u53f7\u91cf\u6765\u5b9e\u73b0\u5bf9\u5171\u4eab\u5185\u5b58\u7684\u5b58\u53d6\u7684\u540c\u6b65\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5f53\u9700\u8981\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u8fdb\u884c\u901a\u4fe1\u65f6\uff0c\u4e00\u822c\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5148\u521b\u5efa\u4e00\u7247\u5171\u4eab\u5185\u5b58\uff0c\u8be5\u5185\u5b58\u5b58\u5728\u4e8e\u5185\u6838\u7a7a\u95f4\u4e2d\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u8fdb\u7a0b\u901a\u8fc7key\u503c\u627e\u5230\u8fd9\u7247\u5171\u4eab\u5185\u5b58\u7684\u552f\u4e00ID\uff0c\u7136\u540e\u5c06\u8fd9\u7247\u5171\u4eab\u5185\u5b58\u6620\u5c04\u5230\u81ea\u5df1\u7684\u5730\u5740\u7a7a\u95f4\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6bcf\u4e2a\u8fdb\u7a0b\u901a\u8fc7\u8bfb\u5199\u6620\u5c04\u540e\u7684\u5730\u5740\uff0c\u6765\u8bbf\u95ee\u5185\u6838\u4e2d\u7684\u5171\u4eab\u5185\u5b58\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"4412\u521b\u5efa\u5171\u4eab\u5185\u5b58",children:"4.4.1.2\u521b\u5efa\u5171\u4eab\u5185\u5b58"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u51fd\u6570\u539f\u578b : int shmget(key_t key, int size, int shmflg)\n\n\u5934\u6587\u4ef6: #include <sys/shm.h>\n\n\u51fd\u6570\u53c2\u6570 : key: IPC_PRIVATE \u6216 ftok\u7684\u8fd4\u56de\u503c\n\n\t\t IPC_PRIVATE\u8fd4\u56de\u7684key\u503c\u90fd\u662f\u4e00\u6837\u7684,\u90fd\u662f0\n\n\t\t size : \u5171\u4eab\u5185\u5b58\u533a\u5927\u5c0f\n\n\t\t shmflg : \u540copen\u51fd\u6570\u7684\u6743\u9650\u4f4d\uff0c\u4e5f\u53ef\u4ee5\u7528\u516b\u8fdb\u5236\u8868\u793a\u6cd5\n\n\u8fd4\u56de\u503c  \uff1a \u6210\u529f\uff0c\u5171\u4eab\u5185\u5b58\u6bb5\u6807\u8bc6\u7b26ID\uff1b -1 \u51fa\u9519\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7a0b\u5e8f\u793a\u4f8b1\uff08\u53c2\u8003jz2440\\process_ipc\\1st_shm\\1st_shm.c\uff09"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u4f7f\u7528IPC_PRIVATE\u521b\u5efa\u5171\u4eab\u5185\u5b58\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 \n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 #include <sys/types.h>\n15 #include <sys/shm.h>\n16 #include <signal.h>\n17 \n18 int main(int argc, char *argv[])\n19 {\n20     int shmid;\n21     \n22     shmid = shmget(IPC_PRIVATE, 128, 0777);\n23     if (shmid < 0) {\n24         printf("create shared memory fail\\n");\n25         return -1;\n26     }\n27     printf("create shared memory sucess, shmid = %d\\n", shmid);\n28     system("ipcs -m");\n29     return 0;\n30 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc 1st_shm.c -o 1st_shm\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp 1st_shm /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6267\u884c\u7b2c18\u884c\u7a0b\u5e8f\u540e\uff0c\u4f1a\u5728\u4e32\u53e3\u6253\u5370\u5982\u4e0b\u4fe1\u606f\uff0c\u8fd9\u884c\u8bed\u53e5\u7684\u4f5c\u7528\u548c\u6211\u4eec\u76f4\u63a5\u5728\u4e32\u53e3console\u4e0b\u9762\u8f93\u5165\u201cipcs -m\u201d\u662f\u4e00\u6837\u7684\u3002\u6211\u4eec\u53d1\u73b0\u6b64\u65f6\u5171\u4eab\u5185\u5b58\u7684key\u503c\u4e3a0\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./1st_shm\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image024.png",alt:"ProcessCommunication_Image024"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u7a0b\u5e8f\u793a\u4f8b2"}),"\uff08\u53c2\u8003jz2440\\process_ipc\\1st_shm\\2nd_shm.c\uff09"]}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u6e90\u7801\uff0c\u4f7f\u7528fotk\u51fd\u6570\u751f\u6210\u4e00\u4e2akey\u503c"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u4f7f\u7528ftok\u51fd\u6570\u751f\u6210\u7684key\u521b\u5efa\u5171\u4eab\u5185\u5b58\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 \n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 #include <sys/types.h>\n15 #include <sys/shm.h>\n16 #include <signal.h>\n17 \n18 int main(int argc, char *argv[])\n19 {\n20     int shmid;\n21     int key;\n22 \n23     key = ftok("./a.c", \'a\');  //\u5148\u521b\u5efa\u4e00\u4e2akey\u503c\n24     if (key < 0) {\n25         printf("create key fail\\n");\n26         return -1;\n27     }\n28     printf("create key sucess key = 0x%X\\n",key);\n29     \n30     shmid = shmget(key, 128, IPC_CREAT | 0777);\n31     if (shmid < 0) {\n32         printf("create shared memory fail\\n");\n33         return -1;\n34     }\n35     printf("create shared memory sucess, shmid = %d\\n", shmid);\n36     system("ipcs -m");\n37     return 0;\n38 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc 2nd_shm.c -o 2nd_shm\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp 2nd_shm /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u9700\u8981\u57282nd_shm\u6240\u5728\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6a.c\uff08\u5728jz2440\u5f00\u53d1\u677f\u4e0a\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"touch a.c\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u53d1\u73b0\u6b64\u65f6\u5171\u4eab\u5185\u5b58\u7684key\u503c\u4e3a\u975e\u96f6\u503c0x610d0169."}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./2nd_shm\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image025.png",alt:"ProcessCommunication_Image025"})}),"\n",(0,i.jsx)(e.h4,{id:"4413-\u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u8bbf\u95ee\u5171\u4eab\u5185\u5b58",children:"4.4.1.3 \u5e94\u7528\u7a0b\u5e8f\u5982\u4f55\u8bbf\u95ee\u5171\u4eab\u5185\u5b58"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u6211\u4eec\u77e5\u9053\u521b\u5efa\u7684\u5171\u4eab\u5185\u5b58\u8fd8\u662f\u5904\u4e8e\u5185\u6838\u7a7a\u95f4\u4e2d\uff0c\u7528\u6237\u7a0b\u5e8f\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u5185\u6838\u5730\u5740\u7a7a\u95f4\uff0c\u90a3\u4e48\u7528\u6237\u7a0b\u5e8f\u5982\u4f55\u8bbf\u95ee\u8fd9\u4e2a\u5171\u4eab\u5185\u5b58\u5462\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"shmat\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u5c06\u5171\u4eab\u5185\u5b58\u6620\u5c04\u5230\u7528\u6237\u7a7a\u95f4\uff0c\u8fd9\u6837\u5e94\u7528\u7a0b\u5e8f\u5c31\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5171\u4eab\u5185\u5b58\u4e86\n\n\u51fd\u6570\u539f\u578b \uff1a void *shmat(int shmid, const void *shmaddr, int shmflg)\n\n\u53c2\u6570 \uff1a shmid ID\u53f7\n\n\t   shmaddr \u6620\u5c04\u5730\u5740\uff0c NULL\u4e3a\u7cfb\u7edf\u81ea\u52a8\u5b8c\u6210\u7684\u6620\u5c04\n\n       shmflg SHM_RDONLY\u5171\u4eab\u5185\u5b58\u53ea\u8bfb\n\n       \u9ed8\u8ba4\u662f0\uff0c\u53ef\u8bfb\u53ef\u5199\n\n\u8fd4\u56de\u503c\uff1a\u6210\u529f\uff0c\u6620\u5c04\u540e\u7684\u5730\u5740\uff1b\u5931\u8d25\uff0c\u8fd4\u56deNULL\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u793a\u4f8b\uff08\u53c2\u8003jz2440\\process_ipc\\1st_shm\\3nd_shm.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u521b\u5efa\u5171\u4eab\u5185\u5b58\uff0c\u5c06\u8be5\u5171\u4eab\u5185\u5b58\u5730\u5740\u901a\u8fc7shmat\u6620\u5c04\u5230\u7528\u6237\u5730\u5740\u7a7a\u95f4\n03             2.\u7528\u6237\u901a\u8fc7\u6807\u51c6\u8f93\u5165\u5411\u8fd9\u4e2a\u5171\u4eab\u5185\u5b58\u4e2d\u8f93\u5165\u4e00\u884c\u5b57\u7b26\u4e32\n04             3.\u7136\u540e\u4ece\u8be5\u5171\u4eab\u5185\u5b58\u4e2d\u8bfb\u53d6\u5185\u5bb9\uff0c\u9a8c\u8bc1\u662f\u5426\u80fd\u591f\u8bfb\u53d6\u5230\n05  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n06  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n07  * \u8fd4 \u56de \u503c\uff1a \u65e0\n08  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n09  * -----------------------------------------------\n10  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n11  ***********************************************************************/\n12 #include <stdio.h>\n13 #include <stdlib.h>\n14 #include <unistd.h>\n15 #include <sys/types.h>\n16 #include <sys/shm.h>\n17 #include <signal.h>\n18 \n19 int main(int argc, char *argv[])\n20 {\n21     int shmid;\n22     int key;\n23     char *p;\n24     \n25     key = ftok("./a.c", \'b\');\n26     if (key < 0) {\n27         printf("create key fail\\n");\n28         return -1;\n29     }\n30     printf("create key sucess key = 0x%X\\n",key);\n31     \n32     shmid = shmget(key, 128, IPC_CREAT | 0777);\n33     if (shmid < 0) {\n34         printf("create shared memory fail\\n");\n35         return -1;\n36     }\n37     printf("create shared memory sucess, shmid = %d\\n", shmid);\n38     system("ipcs -m");\n39     \n40     p = (char *)shmat(shmid, NULL, 0);\n41     if (p == NULL) {\n42         printf("shmat fail\\n");\n43         return -1;\n44     }\n45     printf("shmat sucess\\n");\n46     \n47     //\u7b49\u5f85console\u8f93\u5165\uff0c\u7136\u540e\u5411\u5171\u4eab\u5185\u5b58\u5199\u5165\u6570\u636e\n48     fgets(p, 128, stdin);\n49     \n50     //\u8bfb\u5171\u4eab\u5185\u5b58\n51     printf("share memory data:%s\\n", p);\n52     \n53     //\u518d\u6b21\u8bfb\u5171\u4eab\u5185\u5b58\n54     printf("share memory data:%s\\n", p);\n55     return 0;\n56 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc 3nd_shm.c -o 3nd_shm\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp 3nd_shm /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u9700\u8981\u57283nd_shm\u6240\u5728\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6a.c\uff08\u5728jz2440\u5f00\u53d1\u677f\u4e0a\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"touch a.c\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u6b64\u65f6\u4f1a\u63d0\u793a\u7528\u6237\u8f93\u5165\u4fe1\u606f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./3nd_shm\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image026.png",alt:"ProcessCommunication_Image026"})}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u5728console\u4e0b\u8f93\u5165\u4efb\u610f\u5b57\u7b26\uff0c\u6bd4\u5982\u201chello linux\u201d\uff0c\u7136\u540e\u6309\u4e0b\u56de\u8f66\uff0c\u53d1\u73b0\u6253\u5370\u5982\u4e0b"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image027.png",alt:"ProcessCommunication_Image027"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u95ee\u9898\uff1a\u4ee3\u7801\u4e2d\u7b2c51\u884c\u8bfb\u4e86\u4e00\u904d\u5171\u4eab\u5185\u5b58\uff0c\u7136\u540e\u7b2c54\u884c\u53c8\u8bfb\u4e86\u4e00\u904d\u5171\u4eab\u5185\u5b58\uff0c\u53d1\u73b0\u4e24\u6b21\u90fd\u80fd\u8bfb\u5230\u5171\u4eab\u5185\u5b58\u7684\u5185\u5bb9\uff0c\u8bf4\u660e\u5171\u4eab\u5185\u5b58\u88ab\u8bfb\u4e86\u4e4b\u540e\uff0c\u5185\u5bb9\u4ecd\u7136\u5b58\u5728\u3002\u800c\u5728\u7ba1\u9053\u4e2d\uff0c\u8bfb\u4e86\u4e00\u904d\u7ba1\u9053\u5185\u5bb9\u4e4b\u540e\uff0c\u5982\u679c\u7d27\u63a5\u7740\u8bfb\u53d6\u7b2c\u4e8c\u904d\uff08\u5728\u6ca1\u6709\u65b0\u5199\u5165\u7684\u524d\u63d0\u4e0b\uff09\uff0c\u6211\u4eec\u662f\u4e0d\u80fd\u8bfb\u5230\u7ba1\u9053\u4e2d\u7684\u5185\u5bb9\u7684\uff0c\u8bf4\u660e\u7ba1\u9053\u53ea\u8981\u8bfb\u53d6\u4e00\u6b21\u4e4b\u540e\uff0c\u5185\u5bb9\u5c31\u6d88\u5931\u4e86\uff0c\u8bfb\u8005\u53ef\u4ee5\u901a\u8fc7\u5b9e\u9a8c\u81ea\u884c\u9a8c\u8bc1\u4e00\u4e0b\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"shmdt\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u51fd\u6570\u539f\u578b\uff1aint shmdt(const void *shmaddr)\n\n\u53c2\u6570 \uff1b shmat\u7684\u8fd4\u56de\u503c\n\n\u8fd4\u56de\u503c : \u6210\u529f0\uff0c\u51fa\u9519-1\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u793a\u4f8b\uff08\u53c2\u8003jz2440\\process_ipc\\1st_shm\\4th_shm.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u521b\u5efa\u5171\u4eab\u5185\u5b58\uff0c\u5c06\u8be5\u5171\u4eab\u5185\u5b58\u5730\u5740\u901a\u8fc7shmat\u6620\u5c04\u5230\u7528\u6237\u5730\u5740\u7a7a\u95f4\n03             2.\u7528\u6237\u901a\u8fc7\u6807\u51c6\u8f93\u5165\u5411\u8fd9\u4e2a\u5171\u4eab\u5185\u5b58\u4e2d\u8f93\u5165\u4e00\u884c\u5b57\u7b26\u4e32\n04             3.\u7136\u540e\u4ece\u8be5\u5171\u4eab\u5185\u5b58\u4e2d\u8bfb\u53d6\u5185\u5bb9\n05             4.\u8c03\u7528shmdt\u89e3\u9664\u5730\u5740\u6620\u5c04\uff0c\u6b64\u65f6\u5e94\u7528\u7a0b\u5e8f\u7ee7\u7eed\u8bbf\u95ee\u4f1a\u51fa\u9519\n06  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n07  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n08  * \u8fd4 \u56de \u503c\uff1a \u65e0\n09  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n10  * -----------------------------------------------\n11  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n12  ***********************************************************************/\n13 #include <stdio.h>\n14 #include <stdlib.h>\n15 #include <unistd.h>\n16 #include <sys/types.h>\n17 #include <sys/shm.h>\n18 #include <signal.h>\n19 #include <string.h>\n20 \n21 int main(int argc, char *argv[])\n22 {\n23     int shmid;\n24     int key;\n25     char *p;\n26     \n27     key = ftok("./a.c", \'b\');\n28     if (key < 0) {\n29         printf("create key fail\\n");\n30         return -1;\n31     }\n32     printf("create key sucess key = 0x%X\\n",key);\n33     \n34     shmid = shmget(key, 128, IPC_CREAT | 0777);\n35     if (shmid < 0) {\n36         printf("create shared memory fail\\n");\n37         return -1;\n38     }\n39     printf("create shared memory sucess, shmid = %d\\n", shmid);\n40     system("ipcs -m");\n41     \n42     p = (char *)shmat(shmid, NULL, 0);\n43     if (p == NULL) {\n44         printf("shmat fail\\n");\n45         return -1;\n46     }\n47     printf("shmat sucess\\n");\n48     \n49     //write share memory\n50     fgets(p, 128, stdin);\n51     \n52     //start read share memory\n53     printf("share memory data:%s\\n", p);\n54     \n55     //start read share memory again\n56     printf("share memory data:%s\\n", p);\n57 \n58     //\u5728\u7528\u6237\u7a7a\u95f4\u5220\u9664\u5171\u4eab\u5185\u5b58\u7684\u5730\u5740\n59     shmdt(p);\n60     \n61     memcpy(p, "abcd", 4);  //\u6267\u884c\u8fd9\u4e2a\u8bed\u53e5\u4f1a\u51fa\u73b0segment fault\uff0c\u56e0\u4e3a\u89e3\u9664\u4e86\u5171\u4eab\u5185\u5b58\u5730\u5740\u6620\u5c04\n62     return 0;\n63 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc 4th_shm.c -o 4th_shm\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp 4th_shm /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u6211\u4eec\u9700\u8981\u57284th_shm.c\u6240\u5728\u7684\u540c\u7ea7\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6a.c\uff08\u5728jz2440\u5f00\u53d1\u677f\u4e0a\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"touch a.c\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fd0\u884c\uff0c\u6b64\u65f6\u4f1a\u63d0\u793a\u7528\u6237\u8f93\u5165\u4fe1\u606f,\u8f93\u5165\u5b8c\u4e4b\u540e\uff0c\u6267\u884c\u7b2c61\u884c\u8bed\u53e5\u4f1a\u51fa\u73b0Segmentation fault\uff0c\u8fd9\u662f\u7a0b\u5e8f\u671f\u5f85\u7684\u73b0\u8c61\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./4th_shm\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image028.png",alt:"ProcessCommunication_Image028"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"shmctl\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u51fd\u6570\u539f\u578b\uff1aint shmctl(int shmid, int cmd, struct shmid_ds *buf)\n\n\u53c2\u6570: shmid : \u5171\u4eab\u5185\u5b58\u6807\u8bc6\u7b26\n\n\t cmd : \n\t\tIPC_START (\u83b7\u53d6\u5bf9\u8c61\u5c5e\u6027)   --- \u5b9e\u73b0\u4e86\u547d\u4ee4 ipcs -m\n\n    \tIPC_SET(\u8bbe\u7f6e\u5bf9\u8c61\u5c5e\u6027)\n\n\t \tIPC_RMID (\u5220\u9664\u5bf9\u8c61\u5c5e\u6027)    --- \u5b9e\u73b0\u4e86\u547d\u4ee4 ipcrm -m\n\n\t buf : \u6307\u5b9aIPC_START/IPC_SET \u65f6\u7528\u4ee5\u4fdd\u5b58/\u8bbe\u7f6e\u5c5e\u6027\n\n\u8fd4\u56de\u503c : \u6210\u529f0\uff0c\u51fa\u9519-1\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u793a\u4f8b\uff08\u53c2\u8003jz2440\\process_ipc\\1st_shm\\5th_shm.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u521b\u5efa\u5171\u4eab\u5185\u5b58\uff0c\u5c06\u8be5\u5171\u4eab\u5185\u5b58\u5730\u5740\u901a\u8fc7shmat\u6620\u5c04\u5230\u7528\u6237\u5730\u5740\u7a7a\u95f4\n03               2.\u7528\u6237\u901a\u8fc7\u6807\u51c6\u8f93\u5165\u5411\u8fd9\u4e2a\u5171\u4eab\u5185\u5b58\u4e2d\u8f93\u5165\u4e00\u884c\u5b57\u7b26\u4e32\n04               3.\u7136\u540e\u4ece\u8be5\u5171\u4eab\u5185\u5b58\u4e2d\u8bfb\u53d6\u5185\u5bb9\n05               4.\u8c03\u7528shmdt\u89e3\u9664\u5730\u5740\u6620\u5c04\uff0c\u6b64\u65f6\u5e94\u7528\u7a0b\u5e8f\u7ee7\u7eed\u8bbf\u95ee\u4f1a\u51fa\u9519\n06               5.\u6700\u540e\u8c03\u7528shmctl\u51fd\u6570\u5220\u9664\u5185\u6838\u4e2d\u7684\u5171\u4eab\u5185\u5b58\n07  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n08  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n09  * \u8fd4 \u56de \u503c\uff1a \u65e0\n10  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n11  * -----------------------------------------------\n12  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n13  ***********************************************************************/\n14 \n15 #include <stdio.h>\n16 #include <stdlib.h>\n17 #include <unistd.h>\n18 #include <sys/types.h>\n19 #include <sys/shm.h>\n20 #include <signal.h>\n21 #include <string.h>\n22 \n23 int main(int argc, char *argv[])\n24 {\n25     int shmid;\n26     int key;\n27     char *p;\n28     \n29     key = ftok("./a.c", \'b\');\n30     if (key < 0) {\n31         printf("create key fail\\n");\n32         return -1;\n33     }\n34     printf("create key sucess key = 0x%X\\n",key);\n35     \n36     shmid = shmget(key, 128, IPC_CREAT | 0777);\n37     if (shmid < 0) {\n38         printf("create shared memory fail\\n");\n39         return -1;\n40     }\n41     printf("create shared memory sucess, shmid = %d\\n", shmid);\n42     system("ipcs -m");\n43     \n44     p = (char *)shmat(shmid, NULL, 0);\n45     if (p == NULL) {\n46         printf("shmat fail\\n");\n47         return -1;\n48     }\n49     printf("shmat sucess\\n");\n50     \n51     //write share memory\n52     fgets(p, 128, stdin);\n53     \n54     //start read share memory\n55     printf("share memory data:%s\\n", p);\n56     \n57     //start read share memory again\n58     printf("share memory data:%s\\n", p);\n59 \n60     //\u5728\u7528\u6237\u7a7a\u95f4\u5220\u9664\u5171\u4eab\u5185\u5b58\u7684\u5730\u5740\n61     shmdt(p);\n62     \n63     //memcpy(p, "abcd", 4);  //\u6267\u884c\u8fd9\u4e2a\u8bed\u53e5\u4f1a\u51fa\u73b0segment fault\n64     \n65     shmctl(shmid, IPC_RMID, NULL);\n66     system("ipcs -m");\n67     return 0;\n68 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc 5th_shm.c -o 5th_shm\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp 5th_shm /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"touch a.c\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u8fd0\u884c\u3002\u6b64\u65f6\u4f1a\u63d0\u793a\u7528\u6237\u8f93\u5165\u4fe1\u606f\uff0c\u7b2c\u4e00\u6b21\u6267\u884c\u7b2c42\u884c\u8bed\u53e5\u65f6\uff0c\u8bfb\u8005\u53ef\u4ee5\u770b\u5230\u5171\u4eab\u5185\u5b58\uff0c\u7b2c\u4e8c\u6b21\u6267\u884c\u7b2c66\u884c\u8bed\u53e5\u65f6\uff0c\u8bfb\u8005\u5c31\u770b\u4e0d\u5230\u5171\u4eab\u5185\u5b58\u4e86\uff0c\u56e0\u4e3a\u6b64\u65f6\u5171\u4eab\u5185\u5b58\u5df2\u7ecf\u88ab\u5220\u9664\u4e86\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./4th_shm\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image029.png",alt:"ProcessCommunication_Image029"})}),"\n",(0,i.jsx)(e.h4,{id:"4414-\u5171\u4eab\u5185\u5b58\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",children:"4.4.1.4 \u5171\u4eab\u5185\u5b58\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1"}),"\n",(0,i.jsx)(e.p,{children:"\u6b65\u9aa4\uff1a"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"1. \u521b\u5efa/\u6253\u5f00\u5171\u4eab\u5185\u5b58\n\n2. \u6620\u5c04\u5171\u4eab\u5185\u5b58\uff0c\u5373\u628a\u6307\u5b9a\u7684\u5171\u4eab\u5185\u5b58\u6620\u5c04\u5230\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u7528\u4e8e\u8bbf\u95ee\n\n3. \u8bfb\u5199\u5171\u4eab\u5185\u5b58\n\n4. \u64a4\u9500\u5171\u4eab\u5185\u5b58\u6620\u5c04\n\n5. \u5220\u9664\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u65f6\u7684\u4e00\u4e9b\u6ce8\u610f\u70b9\u6216\u662f\u9650\u5236\u6761\u4ef6"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"1. \u5171\u4eab\u5185\u5b58\u7684\u6570\u91cf\u662f\u6709\u9650\u5236\u7684\uff0c\u901a\u8fc7ipcs -l\u547d\u4ee4\u67e5\u770b\uff0c\u5f53\u7136\u5982\u679c\u6211\u4eec\u5177\u6709\u7ba1\u7406\u5458\u6743\u9650\uff0c\u53ef\u4ee5\u901a\u8fc7 cat /proc/sys/kernel/shmmax\u6765\u67e5\u770b\n\n2. \u5171\u4eab\u5185\u5b58\u5220\u9664\u7684\u65f6\u95f4\u70b9\uff0cshmctl\u6dfb\u52a0\u5220\u9664\u6807\u8bb0\uff0c\u53ea\u6709\u5f53\u6240\u6709\u8fdb\u7a0b\u90fd\u53d6\u6d88\u5171\u4eab\u5185\u5b58\u6620\u5c04\u65f6(\u5373\u6240\u6709\u8fdb\u7a0b\u8c03\u7528shmdt\u4e4b\u540e)\uff0c\u624d\u4f1a\u5220\u9664\u5171\u4eab\u5185\u5b58\u3002\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u793a\u4f8b\u6e90\u7801\uff08\u53c2\u8003jz2440\\process_ipc\\1st_shm\\6th_shm.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u5728\u7236\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4f7f\u7528key\u503c\u4e3aIPC_PRIVATE\u521b\u5efa\u4e00\u4e2a\u5171\u4eab\u5185\u5b58\n03             2.\u7136\u540e\u5728\u7236\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u5b50\u8fdb\u7a0b\n04             3.\u901a\u8fc7\u6807\u51c6\u8f93\u5165\uff0c\u7236\u8fdb\u7a0b\u5411\u5171\u4eab\u5185\u5b58\u4e2d\u5199\u5165\u5b57\u7b26\u4e32\n05             4.\u7236\u8fdb\u7a0b\u8c03\u7528\u53d1\u9001\u4fe1\u53f7\u51fd\u6570\u901a\u77e5\u5b50\u8fdb\u7a0b\u53ef\u4ee5\u8bfb\u53d6\u5171\u4eab\u5185\u5b58\u4e86\n06             5.\u5b50\u8fdb\u7a0b\u6536\u5230\u7236\u8fdb\u7a0b\u53d1\u9001\u8fc7\u6765\u7684\u4fe1\u53f7\uff0c\u5f00\u59cb\u8bfb\u53d6\u5171\u4eab\u5185\u5b58\n07             6.\u5b50\u8fdb\u7a0b\u8bfb\u5b8c\u5171\u4eab\u5185\u5b58\u540e\uff0c\u53d1\u9001\u4fe1\u53f7\u901a\u77e5\u7236\u8fdb\u7a0b\u8bfb\u53d6\u5b8c\u6210\n08  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n09  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n10  * \u8fd4 \u56de \u503c\uff1a \u65e0\n11  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n12  * -----------------------------------------------\n13  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n14  ***********************************************************************/\n15 \n16 #include <stdio.h>\n17 #include <stdlib.h>\n18 #include <unistd.h>\n19 #include <sys/types.h>\n20 #include <sys/shm.h>\n21 #include <signal.h>\n22 #include <string.h>\n23 \n24 void myfun(int signum)\n25 {\n26     return;\n27 }\n28 \n29 int main(int argc, char *argv[])\n30 {\n31     int shmid;\n32     int key;\n33     char *p;\n34     int pid;\n35 \n36 \n37     shmid = shmget(IPC_PRIVATE, 128, IPC_CREAT | 0777);\n38     if (shmid < 0) {\n39         printf("create shared memory fail\\n");\n40         return -1;\n41     }\n42     printf("create shared memory sucess, shmid = %d\\n", shmid);\n43 \n44     pid = fork();\n45     if (pid > 0) {    // \u7236\u8fdb\u7a0b\n46         signal(SIGUSR2, myfun);\n47         p = (char *)shmat(shmid, NULL, 0);\n48         if (p == NULL) {\n49             printf("shmat fail\\n");\n50             return -1;\n51         }\n52         printf("parent process shmat sucess\\n");\n53         while (1) {\n54             //\u4ece\u6807\u51c6\u8f93\u5165\u83b7\u53d6\u5b57\u7b26\u4e32\uff0c\u5c06\u5176\u5199\u5165\u5230\u5171\u4eab\u5185\u5b58\n55             printf("parent process begin to write memory data:");\n56             fgets(p, 128, stdin);\n57             kill(pid, SIGUSR1);   // \u53d1\u4fe1\u53f7\u901a\u77e5\u5b50\u8fdb\u7a0b\u8bfb\u5171\u4eab\u5185\u5b58\n58             pause();              // \u7b49\u5f85\u5b50\u8fdb\u7a0b\u8bfb\u5b8c\u5171\u4eab\u5185\u5b58\u7684\u4fe1\u53f7\n59         }\n60     }\n61     if (pid == 0) { // \u5b50\u8fdb\u7a0b\n62         signal(SIGUSR1, myfun);\n63         p = (char *)shmat(shmid, NULL, 0);\n64         if (p == NULL) {\n65             printf("shmat fail\\n");\n66             return -1;\n67         }\n68         printf("child process shmat sucess\\n");\n69         while (1) {\n70             pause(); // \u7b49\u5f85\u7236\u8fdb\u7a0b\u53d1\u4fe1\u53f7\uff0c\u51c6\u5907\u8bfb\u53d6\u5171\u4eab\u5185\u5b58\n71             //\u5b50\u8fdb\u7a0b\u5f00\u59cb\u8bfb\u5171\u4eab\u5185\u5b58\uff0c\u5e76\u53d1\u4fe1\u53f7\u7ed9\u7236\u8fdb\u7a0b\u544a\u77e5\u8bfb\u5b8c\u6210\n72             printf("child process read share memory data:%s\\n", p);\n73             kill(getppid(), SIGUSR2);\n74         }\n75     }\n76 \n77     //\u5728\u7528\u6237\u7a7a\u95f4\u5220\u9664\u5171\u4eab\u5185\u5b58\u7684\u5730\u5740\n78     shmdt(p);\n79     \n80     //memcpy(p, "abcd", 4);  //\u6267\u884c\u8fd9\u4e2a\u8bed\u53e5\u4f1a\u51fa\u73b0segment fault\n81     \n82     shmctl(shmid, IPC_RMID, NULL);\n83     system("ipcs -m");\n84     return 0;\n85 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc 6th_shm.c -o 6th_shm\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp 6th_shm /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u7236\u8fdb\u7a0b\u4ece\u6807\u51c6\u8f93\u5165\u83b7\u53d6\u7528\u6237\u8f93\u5165\u7684\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u5b50\u8fdb\u7a0b\u4f1a\u6253\u5370\u51fa\u8be5\u5b57\u7b26\u4e32\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./6th_shm\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image030.png",alt:"ProcessCommunication_Image030"})}),"\n",(0,i.jsx)(e.p,{children:"server\u8fdb\u7a0b\u6e90\u7801\uff08\u53c2\u8003jz2440\\process_ipc\\1st_shm\\7th_shm_1.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.server\u8fdb\u7a0b\u4f7f\u7528ftok\u751f\u6210\u4e00\u4e2akey\u503c\uff0c\u5229\u7528\u8fd9\u4e2akey\u503c\u521b\u5efa\u4e00\u4e2a\u5171\u4eab\u5185\u5b58\n03             2.\u901a\u8fc7\u6807\u51c6\u8f93\u5165\uff0c\u5411\u5171\u4eab\u5185\u5b58\u4e2d\u5199\u5165\u5b57\u7b26\u4e32\n04             3.server\u8fdb\u7a0b\u8c03\u7528\u53d1\u9001\u4fe1\u53f7\u51fd\u6570\u901a\u77e5client\u8fdb\u7a0b\n05  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n06  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n07  * \u8fd4 \u56de \u503c\uff1a \u65e0\n08  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n09  * -----------------------------------------------\n10  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n11  ***********************************************************************/\n12 \n13 #include <stdio.h>\n14 #include <stdlib.h>\n15 #include <unistd.h>\n16 #include <sys/types.h>\n17 #include <sys/shm.h>\n18 #include <signal.h>\n19 #include <string.h>\n20 \n21 struct mybuf\n22 {\n23     int pid;\n24     char buf[124];\n25 };\n26 \n27 void myfun(int signum)\n28 {\n29     return;\n30 }\n31 \n32 int main(int argc, char *argv[])\n33 {\n34     int shmid;\n35     int key;\n36     struct mybuf *p;\n37     int pid;\n38 \n39     key = ftok("./a.c", \'a\');\n40     if (key < 0) {\n41         printf("create key fail\\n");\n42         return -1;\n43     }\n44     printf("create key sucess\\n");\n45 \n46     shmid = shmget(key, 128, IPC_CREAT | 0777);\n47     if (shmid < 0) {\n48         printf("create shared memory fail\\n");\n49         return -1;\n50     }\n51     printf("create shared memory sucess, shmid = %d\\n", shmid);\n52 \n53     signal(SIGUSR2, myfun);\n54     p = (struct mybuf *)shmat(shmid, NULL, 0);\n55     if (p == NULL) {\n56         printf("shmat fail\\n");\n57         return -1;\n58     }\n59     printf("parent process shmat sucess\\n");\n60 \n61     p->pid = getpid(); // \u5c06server\u8fdb\u7a0b\u7684pid\u53f7\u5199\u5165\u5230\u5171\u4eab\u5185\u5b58\n62     pause();           // \u7b49\u5f85client\u8bfb\u53d6\u5230server pid\u53f7\n63     pid=p->pid;        // \u83b7\u53d6client\u7684\u8fdb\u7a0b\u53f7\n64 \n65     while (1) {\n66         //write share memory\n67         printf("parent process begin to write memory data\\n");\n68         fgets(p->buf, 124, stdin);\n69         kill(pid, SIGUSR1);   // \u5411client\u53d1\u9001\u4fe1\u53f7\u901a\u77e5client\u8bfb\u53d6\u5171\u4eab\u5185\u5b58\u6570\u636e\n70         pause();              // \u7b49\u5f85client\u8bfb\u53d6\u5b8c\u5171\u4eab\u5185\u5b58\u6570\u636e\n71     }\n72 \n73     //\u5728\u7528\u6237\u7a7a\u95f4\u5220\u9664\u5171\u4eab\u5185\u5b58\u7684\u5730\u5740\n74     shmdt(p);\n75 \n76     shmctl(shmid, IPC_RMID, NULL);\n77     system("ipcs -m");\n78     return 0;\n79 }\n'})}),"\n",(0,i.jsx)(e.p,{children:"client\u8fdb\u7a0b\u6e90\u7801\uff08\u53c2\u8003jz2440\\process_ipc\\1st_shm\\7th_shm_2.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.client\u8fdb\u7a0b\u4f7f\u7528ftok\u751f\u6210\u4e00\u4e2akey\u503c\uff0c\u5229\u7528\u8fd9\u4e2akey\u503c\u6253\u5f00\u4e00\u4e2a\u5171\u4eab\u5185\u5b58\n03             2.client\u8fdb\u7a0b\u6536\u5230server\u8fdb\u7a0b\u53d1\u9001\u8fc7\u6765\u7684\u4fe1\u53f7\u4e4b\u540e\uff0c\u5f00\u59cb\u8bfb\u53d6\u5171\u4eab\u5185\u5b58\n04             3.\u5b50\u8fdb\u7a0b\u8bfb\u5b8c\u5171\u4eab\u5185\u5b58\u540e\uff0c\u53d1\u9001\u4fe1\u53f7\u901a\u77e5\u7236\u8fdb\u7a0b\u8bfb\u53d6\u5b8c\u6210\n05  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n06  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n07  * \u8fd4 \u56de \u503c\uff1a \u65e0\n08  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n09  * -----------------------------------------------\n10  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n11  ***********************************************************************/\n12 \n13 #include <stdio.h>\n14 #include <stdlib.h>\n15 #include <unistd.h>\n16 #include <sys/types.h>\n17 #include <sys/shm.h>\n18 #include <signal.h>\n19 #include <string.h>\n20 \n21 struct mybuf\n22 {\n23     int pid;\n24     char buf[124];\n25 };\n26 \n27 void myfun(int signum)\n28 {\n29     return;\n30 }\n31 \n32 int main(int argc, char *argv[])\n33 {\n34     int shmid;\n35     int key;\n36     struct mybuf *p;\n37     int pid;\n38     \n39     key = ftok("./a.c", \'a\');\n40     if (key < 0) {\n41         printf("create key fail\\n");\n42         return -1;\n43     }\n44     printf("create key sucess\\n");\n45 \n46     shmid = shmget(key, 128, IPC_CREAT | 0777);\n47     if (shmid < 0) {\n48         printf("create shared memory fail\\n");\n49         return -1;\n50     }\n51     printf("create shared memory sucess, shmid = %d\\n", shmid);\n52 \n53     signal(SIGUSR1, myfun);\n54     p = (struct mybuf *)shmat(shmid, NULL, 0);\n55     if (p == NULL) {\n56         printf("shmat fail\\n");\n57         return -1;\n58     }\n59     printf("client process shmat sucess\\n");\n60     \n61     // get server pid\n62     //read share memory\n63     pid = p->pid;\n64     // write client pid to share memory\n65     p->pid = getpid();\n66     kill(pid, SIGUSR2);   // tell server process to read data\n67     \n68     //client start to read share memory\n69 \n70     while (1) {\n71         pause();              // wait server process write share memory\n72         printf("client process read data:%s\\n", p->buf); // read data\n73         kill(pid, SIGUSR2);   // server can  write share memory\n74     }\n75 \n76     //\u5728\u7528\u6237\u7a7a\u95f4\u5220\u9664\u5171\u4eab\u5185\u5b58\u7684\u5730\u5740\n77     shmdt(p);\n78     \n79     shmctl(shmid, IPC_RMID, NULL);\n80     system("ipcs -m");\n81     return 0;\n82 }\n'})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u8be5\u6e90\u7801\u7559\u7ed9\u8bfb\u8005\u81ea\u884c\u5b9e\u9a8c\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019\u9700\u8981\u8fd0\u884c\u4e24\u4e2aconsole\uff0c\u5206\u522b\u8fd0\u884cserver\u8fdb\u7a0b\u548cclient\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u91c7\u7528\u4e00\u4e2a\u4e32\u53e3console\uff0c\u4e00\u4e2atelnet console\u3002\u6211\u4eec\u4e5f\u53ef\u4ee5\u5728ubuntu\u4e0b\u5f00\u542f\u4e24\u4e2aterminal\u9a8c\u8bc1\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"442-\u6d88\u606f\u961f\u5217",children:"4.4.2 \u6d88\u606f\u961f\u5217"}),"\n",(0,i.jsx)(e.h4,{id:"4421-\u4ec0\u4e48\u662f\u6d88\u606f\u961f\u5217",children:"4.4.2.1 \u4ec0\u4e48\u662f\u6d88\u606f\u961f\u5217"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u6d88\u606f\u961f\u5217\u662f\u6d88\u606f\u7684\u94fe\u8868\uff0c\u5b83\u662f\u4e00\u4e2a\u94fe\u5f0f\u961f\u5217\uff0c\u548c\u7ba1\u9053\u7c7b\u4f3c\uff0c\u6bcf\u4e2a\u6d88\u606f\u591a\u6709\u6700\u5927\u957f\u5ea6\u9650\u5236\uff0c\u53ef\u7528cat/proc/sys/kernel/msgmax\u67e5\u770b\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5185\u6838\u4e3a\u6bcf\u4e2a\u6d88\u606f\u961f\u5217\u5bf9\u8c61\u7ef4\u62a4\u4e86\u4e00\u4e2a\u6570\u636e\u7ed3\u6784msgqid_ds\uff0c\u7528\u4e8e\u6807\u8bc6\u6d88\u606f\u961f\u5217\uff0c\u4ee5\u4fbf\u8ba9\u8fdb\u7a0b\u77e5\u9053\u5f53\u524d\u64cd\u4f5c\u7684\u662f\u54ea\u4e00\u4e2a\u6d88\u606f\u961f\u5217\uff0c\u6bcf\u4e00\u4e2amsqid_ds\u8868\u793a\u4e00\u4e2a\u6d88\u606f\u961f\u5217\uff0c\u5e76\u901a\u8fc7msqid_ds.msg_first\u3001msg_last\u7ef4\u62a4\u4e00\u4e2a\u5148\u8fdb\u5148\u51fa\u7684msg\u94fe\u8868\u961f\u5217\uff0c\u5f53\u53d1\u9001\u4e00\u4e2a\u6d88\u606f\u5230\u8be5\u6d88\u606f\u961f\u5217\u65f6\uff0c\u628a\u53d1\u9001\u7684\u6d88\u606f\u6784\u9020\u6210\u4e00\u4e2amsg\u7684\u7ed3\u6784\u5bf9\u8c61\uff0c\u5e76\u6dfb\u52a0\u5230msqid_ds.msg_first\u3001msg_last\u7ef4\u62a4\u7684\u94fe\u8868\u961f\u5217\u3002\u5728\u5185\u6838\u4e2d\u7684\u8868\u793a\u5982\u4e0b\uff1a"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image031.png",alt:"ProcessCommunication_Image031"})}),"\n",(0,i.jsx)(e.h4,{id:"4422-\u7279\u70b9",children:"4.4.2.2 \u7279\u70b9"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u751f\u547d\u5468\u671f\u8ddf\u968f\u5185\u6838\uff0c\u6d88\u606f\u961f\u5217\u4e00\u76f4\u5b58\u5728\uff0c\u9700\u8981\u7528\u6237\u663e\u793a\u8c03\u7528\u63a5\u53e3\u5220\u9664\u6216\u8005\u4f7f\u7528\u547d\u4ee4\u5220\u9664\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u6d88\u606f\u961f\u5217\u53ef\u4ee5\u5b9e\u73b0\u53cc\u5411\u901a\u4fe1"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u514b\u670d\u4e86\u7ba1\u9053\u53ea\u80fd\u627f\u8f7d\u65e0\u683c\u5f0f\u5b57\u8282\u6d41\u7684\u7f3a\u70b9"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"4423-\u6d88\u606f\u961f\u5217\u51fd\u6570",children:"4.4.2.3 \u6d88\u606f\u961f\u5217\u51fd\u6570"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"msgget\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u521b\u5efa\u6216\u8005\u6253\u5f00\u6d88\u606f\u961f\u5217\u7684\u51fd\u6570\n\u5934\u6587\u4ef6\uff1a#include <sys/types.h>\n        #include <sys/ipc.h>\n       #include <sys/msg.h>\n\u539f\u578b\uff1a int msgget(key_t key, int flag)\n\u53c2\u6570\uff1a key \u548c\u6d88\u606f\u961f\u5217\u5173\u8054\u7684key\u503c\n       flag \u6d88\u606f\u961f\u5217\u7684\u8bbf\u95ee\u6743\u9650\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"msgctl\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u6d88\u606f\u961f\u5217\u63a7\u5236\u51fd\u6570\n\u539f\u578b\uff1a int msgctl(int msgqid, int cmd, struct msqid_ds *buf)\n\u53c2\u6570\uff1a msgqid \u6d88\u606f\u961f\u5217ID\n           cmd IPC_STAT \u8bfb\u53d6\u6d88\u606f\u961f\u5217\u7684\u5c5e\u6027\uff0c\u5e76\u5c06\u5176\u4fdd\u5b58\u5728buf\u6307\u5411\u7684\u7f13\u51b2\u533a\u4e2d\n               IPC_SET  \u8bbe\u7f6e\u6d88\u606f\u961f\u5217\u7684\u5c5e\u6027\uff0c\u8fd9\u4e2a\u503c\u53d6\u81eabuf\u53c2\u6570\n               IPC_RMID \u4ece\u7cfb\u7edf\u4e2d\u5220\u9664\u6d88\u606f\u961f\u5217\n           buf \u6d88\u606f\u7f13\u51b2\u533a\n\u8fd4\u56de\u503c\uff1a \u6210\u529f 0\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"msgsnd\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u628a\u4e00\u6761\u6d88\u606f\u6dfb\u52a0\u5230\u6d88\u606f\u961f\u5217\u4e2d\n\u5934\u6587\u4ef6#include <sys/types.h>\n      #include <sys/ipc.h>\n      #include <sys/msg.h>\n\u539f\u578b\uff1a int msgsnd(int msgqid, const void *msgp, size_t size, int flag)\n\u53c2\u6570\uff1a msgqid \u6d88\u606f\u961f\u5217ID\n           msgp \u6307\u5411\u6d88\u606f\u7684\u6307\u9488\uff0c\u5e38\u7528\u6d88\u606f\u7ed3\u6784msgbuf\u5982\u4e0b\n           struct msgbuf {\n               long mtype;        //\u6d88\u606f\u7c7b\u578b\n               char mtext[N];     //\u6d88\u606f\u6b63\u6587\n           };\n           size \u6d88\u606f\u6b63\u6587\u7684\u5b57\u8282\u6570\n           flag IPC_NOWAIT \u6d88\u606f\u6ca1\u6709\u53d1\u9001\u5b8c\u6210\u4e5f\u4f1a\u7acb\u5373\u8fd4\u56de\n                0\uff1a \u76f4\u5230\u53d1\u9001\u5b8c\u6210\u51fd\u6570\u624d\u4f1a\u8fd4\u56de\n    \u8fd4\u56de\u503c\uff1a \u6210\u529f 0\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"msgrcv\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u4ece\u4e00\u4e2a\u6d88\u606f\u961f\u5217\u63a5\u53d7\u6d88\u606f\n\u539f\u578b\uff1a int msgrcv(int msgqid, void *msgp, size_t size, long msgtype, int flag)\n\u53c2\u6570\uff1a msgqid \u6d88\u606f\u961f\u5217ID\n       msgp \u63a5\u6536\u6d88\u606f\u7684\u7f13\u51b2\u533a\n       size \u8981\u63a5\u6536\u6d88\u606f\u7684\u5b57\u8282\u6570\n       msgtype  0 \u63a5\u6536\u6d88\u606f\u961f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u6d88\u606f\n                \u5927\u4e8e0 \u63a5\u6536\u6d88\u606f\u961f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u7c7b\u578b\u4e3amsgtype\u7684\u6d88\u606f\n                \u5c0f\u4e8e0 \u63a5\u6536\u6d88\u606f\u961f\u5217\u4e2d\u7c7b\u578b\u503c\u4e0d\u5927\u4e8emsgtype\u7684\u7edd\u5bf9\u503c\u4e14\u7c7b\u578b\u503c\u53c8\u6700\u5c0f\u7684\u6d88\u606f\n           flag IPC_NOWAIT \u6ca1\u6709\u6d88\u606f\uff0c\u4f1a\u7acb\u5373\u8fd4\u56de\n                0\uff1a \u82e5\u65e0\u6d88\u606f\u5219\u4f1a\u4e00\u76f4\u963b\u585e\n                \n\u8fd4\u56de\u503c\uff1a \u6210\u529f \u63a5\u6536\u6d88\u606f\u7684\u957f\u5ea6\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.h4,{id:"4424-\u6d88\u606f\u961f\u5217\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",children:"4.4.2.4 \u6d88\u606f\u961f\u5217\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1"}),"\n",(0,i.jsx)(e.p,{children:"server\u6e90\u7801\uff08\u53c2\u8003jz2440\\process_ipc\\2nd_shm\\write_msg.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.server\u8fdb\u7a0b\u5411\u6d88\u606f\u961f\u5217\u4e2d\u5199\u6570\u636e\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 \n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 #include <sys/types.h>\n15 #include <sys/msg.h>\n16 #include <signal.h>\n17 #include <string.h>\n18 \n19 struct msgbuf {\n20     long type;        //\u6d88\u606f\u7c7b\u578b\n21     char voltage[124];     //\u6d88\u606f\u6b63\u6587\n22     char ID[4];\n23 };\n24 \n25 int main(int argc, char *argv[])\n26 {\n27     int msgid, readret, key;\n28     struct msgbuf sendbuf;\n29 \n30     key = ftok("./a.c", \'a\');\n31     if (key < 0){\n32         printf("create key fail\\n");\n33         return -1;\n34     }\n35     msgid = msgget(key, IPC_CREAT|0777);\n36     if (msgid < 0) {\n37         printf("create msg queue fail\\n");\n38         return -1;\n39     }\n40     printf("create msg queue sucess, msgid = %d\\n", msgid);\n41     system("ipcs -q");\n42 \n43     // write message queue\n44     sendbuf.type = 100;\n45     while(1) {\n46         memset(sendbuf.voltage, 0, 124);  //clear send buffer\n47         printf("please input message:");\n48         fgets(sendbuf.voltage, 124, stdin);\n49         //start write msg to msg queue\n50         msgsnd(msgid, (void *)&sendbuf, strlen(sendbuf.voltage), 0);\n51     }\n52 \n53     return 0;\n54 }\n'})}),"\n",(0,i.jsx)(e.p,{children:"client\u6e90\u7801\uff08\u53c2\u8003jz2440\\process_ipc\\2nd_shm\\read_msg.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.client\u8fdb\u7a0b\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u8bfb\u6570\u636e\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 \n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 #include <sys/types.h>\n15 #include <sys/msg.h>\n16 #include <signal.h>\n17 #include <string.h>\n18 \n19 struct msgbuf {\n20     long type;        //\u6d88\u606f\u7c7b\u578b\n21     char voltage[124];     //\u6d88\u606f\u6b63\u6587\n22     char ID[4];\n23 };\n24 \n25 int main(int argc, char *argv[])\n26 {\n27     int msgid, key;\n28     struct msgbuf readbuf;\n29 \n30     key = ftok("./a.c", \'a\');\n31     if (key < 0){\n32         printf("create key fail\\n");\n33         return -1;\n34     }\n35     msgid = msgget(key, IPC_CREAT|0777);\n36     if (msgid < 0) {\n37         printf("create msg queue fail\\n");\n38         return -1;\n39     }\n40     printf("create msg queue sucess, msgid = %d\\n", msgid);\n41     system("ipcs -q");\n42 \n43     // read message queue\n44     while(1) {\n45         memset(readbuf.voltage, 0, 124);  //clear recv buffer\n46         //start read msg to msg queue\n47         msgrcv(msgid, (void *)&readbuf, 124, 100, 0);\n48         printf("recv data from message queue:%s", readbuf.voltage);\n49     }\n50 \n51     return 0;\n52 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc write_msg.c -o write_msg\narm-linux-gcc read_msg.c -o read_msg\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp write_msg /work/nfs_root/first_fs\ncp read_msg /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5148\u5728\u540e\u53f0\u6267\u884cread_msg\uff0c\u7136\u540e\u5728\u524d\u53f0\u8fd0\u884cwrite_msg\uff0c\u6b64\u65f6\u5728console\u4e0b\u8f93\u5165\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u770b\u5230client\u8fdb\u7a0b\u80fd\u8bfb\u5230\u6d88\u606f\u961f\u5217\u4e2d\u7684\u5b57\u7b26\u4e32 \u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./read_msg &\n./ write_msg\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image032.png",alt:"ProcessCommunication_Image032"})}),"\n",(0,i.jsx)(e.h3,{id:"443-\u4fe1\u53f7\u91cf\u706f",children:"4.4.3 \u4fe1\u53f7\u91cf\u706f"}),"\n",(0,i.jsx)(e.h4,{id:"4431-\u4ec0\u4e48\u662fpv\u64cd\u4f5c",children:"4.4.3.1 \u4ec0\u4e48\u662fP\u3001V\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5f53\u4e0d\u540c\u8fdb\u7a0b\u9700\u8981\u8bbf\u95ee\u540c\u4e00\u4e2a\u8d44\u6e90\u65f6\uff0c\u7531\u4e8e\u4e0d\u540c\u8fdb\u7a0b\u7684\u6267\u884c\u6b21\u5e8f\u662f\u672a\u77e5\u7684\uff0c\u6709\u53ef\u80fd\u67d0\u4e2a\u8fdb\u7a0b\u6b63\u5728\u5199\u8be5\u8d44\u6e90\uff0c\u800c\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u6b63\u5728\u8bfb\u8be5\u8d44\u6e90\uff0c\u8fd9\u6837\u4f1a\u9020\u6210\u8fdb\u7a0b\u6267\u884c\u7684\u4e0d\u786e\u5b9a\u6027\u3002\u8fd9\u6837\u7684\u540c\u4e00\u4e2a\u8d44\u6e90\uff0c\u6211\u4eec\u79f0\u4e3a\u5171\u4eab\u8d44\u6e90\uff0c\u5171\u4eab\u8d44\u6e90\u4e00\u6b21\u53ea\u5141\u8bb8\u4e00\u4e2a\u8fdb\u7a0b\u8bbf\u95ee\u3002\u56e0\u6b64\u8fdb\u7a0b\u5728\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u65f6\uff0c\u9700\u8981\u52a0\u4e0a\u540c\u6b65\u3001\u4e92\u65a5\u64cd\u4f5c\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u4e00\u822c\u5730\uff0cP\u64cd\u4f5c\u8868\u793a\u7533\u8bf7\u8be5\u5171\u4eab\u8d44\u6e90\uff0cV\u64cd\u4f5c\u8868\u793a\u91ca\u653e\u8be5\u5171\u4eab\u8d44\u6e90\u3002"}),"\n",(0,i.jsx)(e.h4,{id:"4432-\u4ec0\u4e48\u662f\u4fe1\u53f7\u91cf\u706f",children:"4.4.3.2 \u4ec0\u4e48\u662f\u4fe1\u53f7\u91cf\u706f"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5b83\u662f\u4fe1\u53f7\u91cf\u7684\u96c6\u5408\uff0c\u5305\u542b\u591a\u4e2a\u4fe1\u53f7\u91cf\uff0c\u53ef\u5bf9\u591a\u4e2a\u4fe1\u53f7\u706f\u540c\u65f6\u8fdb\u884cP/V\u64cd\u4f5c\uff0c\u4e3b\u8981\u7528\u6765\u5b9e\u73b0\u8fdb\u7a0b\u3001\u7ebf\u7a0b\u95f4\u540c\u6b65/\u4e92\u65a5\u3002\u5185\u6838\u4e3a\u6bcf\u4e2a\u4fe1\u53f7\u91cf\u706f\u7ef4\u62a4\u4e86\u4e00\u4e2a\u6570\u636e\u7ed3\u6784semid_ds\uff0c\u7528\u4e8e\u6807\u8bc6\u4fe1\u53f7\u91cf\u706f\uff0c\u4ee5\u4fbf\u8fdb\u7a0b\u77e5\u9053\u5f53\u524d\u64cd\u4f5c\u7684\u662f\u54ea\u4e2a\u4fe1\u53f7\u91cf\u706f\uff0c\u5728\u5185\u6838\u4e2d\u7684\u8868\u793a\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image033.png",alt:"ProcessCommunication_Image033"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5b83\u548cPOSIX\u89c4\u8303\u4e2d\u7684\u4fe1\u53f7\u91cf\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1fPOSIX\u89c4\u8303\u4e2d\u7684\u4fe1\u53f7\u91cf\u53ea\u4f5c\u7528\u4e8e\u4e00\u4e2a\u4fe1\u53f7\u91cf\uff0c\u800cIPC\u5bf9\u8c61\u4e2d\u7684\u4fe1\u53f7\u91cf\u706f\u4f1a\u4f5c\u7528\u4e8e\u4e00\u7ec4\u4fe1\u53f7\u91cf\u3002"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u529f\u80fd"}),(0,i.jsx)(e.th,{children:"\u4fe1\u53f7\u91cf(POSIX)"}),(0,i.jsx)(e.th,{children:"\u4fe1\u53f7\u91cf\u706f(IPC\u5bf9\u8c61)"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5b9a\u4e49\u4fe1\u53f7\u53d8\u91cf"}),(0,i.jsx)(e.td,{children:"sem_t sem1"}),(0,i.jsx)(e.td,{children:"semget"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u521d\u59cb\u5316\u4fe1\u53f7\u91cf"}),(0,i.jsx)(e.td,{children:"sem_init"}),(0,i.jsx)(e.td,{children:"semctl"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"P\u64cd\u4f5c"}),(0,i.jsx)(e.td,{children:"sem_wait"}),(0,i.jsx)(e.td,{children:"semop"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"V\u64cd\u4f5c"}),(0,i.jsx)(e.td,{children:"sem_post"}),(0,i.jsx)(e.td,{children:"semop"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u4e3a\u4ec0\u4e48\u9700\u8981IPC\u5bf9\u8c61\u4e2d\u7684\u4fe1\u53f7\u91cf\u706f\u5462\uff1f\u6709POSIX\u89c4\u8303\u4e2d\u7684\u4fe1\u53f7\u91cf\u4e0d\u591f\u5417\uff1f"}),"\n",(0,i.jsx)(e.p,{children:"\u8003\u8651\u5982\u4e0b\u573a\u666f\uff1a"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7ebf\u7a0bA\u548c\u7ebf\u7a0bB\u90fd\u9700\u8981\u8bbf\u95ee\u5171\u4eab\u8d44\u6e901\u548c\u5171\u4eab\u8d44\u6e902\uff0c\u5728\u7ebf\u7a0bA\u4e2d\u4f1a\u9700\u8981\u5148\u7533\u8bf7\u5171\u4eab\u8d44\u6e901\uff0c\u7136\u540e\u518d\u7533\u8bf7\u5171\u4eab\u8d44\u6e902\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4f46\u662f\u5728\u7ebf\u7a0bB\u4e2d\uff0c\u4f1a\u5148\u7533\u8bf7\u8d21\u732e\u8d44\u6e902\uff0c\u7136\u540e\u518d\u7533\u8bf7\u5171\u4eab\u8d44\u6e901\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u5f53\u7ebf\u7a0bA\u4e2d\u5f00\u59cb\u7533\u8bf7\u5171\u4eab\u8d44\u6e901\u65f6\uff0c\u7d27\u63a5\u7740\u4f1a\u7533\u8bf7\u5171\u4eab\u8d44\u6e902\uff1b\u800c\u6b64\u65f6\u7ebf\u7a0bB\u4e2d\u5f00\u59cb\u7533\u8bf7\u5171\u4eab\u8d44\u6e902\u65f6\uff0c\u7d27\u63a5\u7740\u4f1a\u7533\u8bf7\u5171\u4eab\u8d44\u6e901\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u7ebf\u7a0bB\u6b63\u5728\u5360\u7528\u7740\u5171\u4eab\u8d44\u6e902\uff0c\u7ebf\u7a0bA\u6b63\u5728\u5360\u7740\u5171\u4eab\u8d44\u6e901\uff0c\u5bfc\u81f4\u7ebf\u7a0bB\u7533\u8bf7\u4e0d\u5230\u5171\u4eab\u8d44\u6e901\uff0c\u5b83\u5c31\u4e0d\u4f1a\u91ca\u653e\u5171\u4eab\u8d44\u6e902\uff1b\u7ebf\u7a0bA\u7533\u8bf7\u4e0d\u5230\u5171\u4eab\u8d44\u6e902\uff0c\u5b83\u5c31\u4e0d\u4f1a\u91ca\u653e\u5171\u4eab\u8d44\u6e901\uff1b\u8fd9\u6837\u5c31\u9020\u6210\u4e86\u6b7b\u9501\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"4433-\u4fe1\u53f7\u91cf\u706f\u51fd\u6570",children:"4.4.3.3 \u4fe1\u53f7\u91cf\u706f\u51fd\u6570"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"semget\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u521b\u5efa\u6216\u8005\u6253\u5f00\u51fd\u6570\n\u5934\u6587\u4ef6#includde <sys/types.h>\n#includde <sys/ipc.h>\n#includde <sys/sem.h>\n\u539f\u578b: int semget(key_t key, int nsems, int semflag)\n\u53c2\u6570\uff1a key \u548c\u4fe1\u53f7\u706f\u96c6\u5173\u8054\u7684key\u503c\n      nsems \u4fe1\u53f7\u706f\u96c6\u5305\u542b\u7684\u4fe1\u53f7\u706f\u6570\u76ee\n      semflag \u4fe1\u53f7\u706f\u96c6\u7684\u8bbf\u95ee\u6743\u9650\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u4fe1\u53f7\u706fID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"semctl\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u4fe1\u53f7\u91cf\u706f\u63a7\u5236\u51fd\u6570\n\u5934\u6587\u4ef6#includde <sys/types.h>\n#includde <sys/ipc.h>\n#includde <sys/sem.h>\n\u539f\u578b: int semctl(int semid, int semnum, int cmd, ...union semun arg)\n          \u6ce8\u610f\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u4e0d\u662f\u5730\u5740\uff0c\u53ef\u4ee5\u6709\uff0c\u53ef\u4ee5\u6ca1\u6709\n\u53c2\u6570\uff1a semid \u4fe1\u53f7\u706f\u96c6id\n      semnum \u8981\u4fee\u6539\u7684\u4fe1\u53f7\u706f\u96c6\u7f16\u53f7,\u5220\u9664\u64cd\u4f5c\u65f6\uff0c\u8fd9\u4e2a\u503c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a\u4efb\u610f\u503c\n      cmd GETVAL \u83b7\u53d6\u4fe1\u53f7\u706f\u7684\u503c\n           SETVAL \u8bbe\u7f6e\u4fe1\u53f7\u706f\u7684\u503c\n           IPC_RMID \u5220\u9664\u4fe1\u53f7\u706f\n      union semun arg: union semun {\n                     int              val;    /* Value for SETVAL */\n                     struct semid_ds *buf;    /* Buffer for IPC_STAT, IPC_SET */\n                     unsigned short  *array;  /* Array for GETALL, SETALL */\n                     struct seminfo  *__buf;  /* Buffer for IPC_INFO (Linux-specific) */\n                 };\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"semop\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"p/v\u64cd\u4f5c\u51fd\u6570\n\u5934\u6587\u4ef6#includde <sys/types.h>\n#includde <sys/ipc.h>\n#includde <sys/sem.h>\n\u539f\u578b: int semop(int semid, struct sembuf *opsptr, size_t nops)\n\u53c2\u6570\uff1a semid \u4fe1\u53f7\u706f\u96c6id\n      opsptr struct sembuf{\n                  short sem_num;   //\u8981\u64cd\u4f5c\u4fe1\u53f7\u706f\u7684\u7f16\u53f7\n                  short sem_op;    //0: \u7b49\u5f85\uff0c\u76f4\u5230\u4fe1\u53f7\u706f\u7684\u503c\u53d8\u4e3a0\uff0c1:\u8d44\u6e90\u91ca\u653e\uff0cV\u64cd\u4f5c\uff0c-1:\u5206\u914d\u8d44\u6e90\uff0cP\u64cd\u4f5c\n                  short sem_flg;   //0: IPC_NOWAIT, SEM_UNDO\n              }\n       nops \u8981\u64cd\u4f5c\u4fe1\u53f7\u706f\u4e2a\u6570\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.h4,{id:"4434-\u4fe1\u53f7\u91cf\u706f\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u540c\u6b65\u4e92\u65a5",children:"4.4.3.4 \u4fe1\u53f7\u91cf\u706f\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u540c\u6b65/\u4e92\u65a5"}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u6e90\u7801\uff08\u53c2\u8003jz2440\\process_ipc\\3rd_shm\\share_sysv.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u7236\u8fdb\u7a0b\u4ece\u952e\u76d8\u8f93\u5165\u5b57\u7b26\u4e32\u5230\u5171\u4eab\u5185\u5b58.\n03             2.\u5b50\u8fdb\u7a0b\u5220\u9664\u5b57\u7b26\u4e32\u4e2d\u7684\u7a7a\u683c\u5e76\u6253\u5370.\n04             3.\u7236\u8fdb\u7a0b\u8f93\u5165quit\u540e\u5220\u9664\u5171\u4eab\u5185\u5b58\u548c\u4fe1\u53f7\u706f\u96c6\uff0c\u7a0b\u5e8f\u7ed3\u675f.\n05  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n06  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n07  * \u8fd4 \u56de \u503c\uff1a \u65e0\n08  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n09  * -----------------------------------------------\n10  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n11  ***********************************************************************/\n12 \n13 #include <stdio.h>\n14 #include <stdlib.h>\n15 #include <string.h>\n16 #include <sys/ipc.h>\n17 #include <sys/sem.h>\n18 #include <sys/types.h>\n19 #include <sys/shm.h>\n20 #include <signal.h>\n21 #include <unistd.h>\n22 \n23 #define N 64\n24 #define READ 0\n25 #define WRITE 1\n26 \n27 union semun {\n28 \tint val;\n29         struct semid_ds *buf;\n30         unsigned short *array;\n31         struct seminfo *__buf;\n32 };\n33 \n34 void init_sem(int semid, int s[], int n)\n35 {\n36 \tint i;\n37 \tunion semun myun;\n38 \n39 \tfor (i = 0; i < n; i++){\n40 \t\tmyun.val = s[i];\n41 \t\tsemctl(semid, i, SETVAL, myun);\n42 \t}\n43 }\n44 \n45 void pv(int semid, int num, int op)\n46 {\n47 \tstruct sembuf buf;\n48 \n49 \tbuf.sem_num = num;\n50 \tbuf.sem_op = op;\n51 \tbuf.sem_flg = 0;\n52 \tsemop(semid, &buf, 1);\n53 }\n54 \n55 int main(int argc, char *argv[])\n56 {\n57 \tint shmid, semid, s[] = {0, 1};\n58 \tpid_t pid;\n59 \tkey_t key;\n60 \tchar *shmaddr;\n61 \n62 \tkey = ftok(".", \'s\');\n63 \tif (key == -1){\n64 \t\tperror("ftok");\n65 \t\texit(-1);\n66 \t}\n67 \n68 \tshmid = shmget(key, N, IPC_CREAT|0666);\n69 \tif (shmid < 0) {\n70 \t\tperror("shmid");\n71 \t\texit(-1);\n72 \t}\n73 \n74 \tsemid = semget(key, 2, IPC_CREAT|0666);\n75 \tif (semid < 0) {\n76 \t\tperror("semget");\n77 \t\tgoto __ERROR1;\n78 \t}\n79 \tinit_sem(semid, s, 2);\n80 \n81 \tshmaddr = shmat(shmid, NULL, 0);\n82 \tif (shmaddr == NULL) {\n83 \t\tperror("shmaddr");\n84 \t\tgoto __ERROR2;\n85 \t}\n86 \n87 \tpid = fork();\n88 \tif(pid < 0) {\n89 \t\tperror("fork");\n90 \t\tgoto __ERROR2;\n91 \t} else if (pid == 0) {\n92 \t\tchar *p, *q;\n93 \t\twhile(1) {\n94 \t\t\tpv(semid, READ, -1);\n95 \t\t\tp = q = shmaddr;\n96 \t\t\twhile (*q) {\n97 \t\t\t\tif (*q != \' \') {\n98 \t\t\t\t\t*p++ = *q;\n99 \t\t\t\t}\n100 \t\t\t\tq++;\n101 \t\t\t}\n102 \t\t\t*p = \'\\0\';\n103 \t\t\tprintf("%s", shmaddr);\n104 \t\t\tpv(semid, WRITE, 1);\n105 \t\t}\n106 \t} else {\n107 \t\twhile (1) {\n108 \t\t\tpv(semid, WRITE, -1);\n109 \t\t\tprintf("input > ");\n110 \t\t\tfgets(shmaddr, N, stdin);\n111 \t\t\tif (strcmp(shmaddr, "quit\\n") == 0) break;\n112 \t\t\t\tpv(semid, READ, 1);\n113 \t\t\t}\n114 \t\t\tkill(pid, SIGUSR1);\n115 \t\t}\n116 \n117 \t__ERROR2:\n118 \t\tsemctl(semid, 0, IPC_RMID);\n119 \t__ERROR1:\n120 \t\tshmctl(shmid, IPC_RMID, NULL);\n121 \t\treturn 0;\n122 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc share_sysv.c -o share_sysv\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp share_sysv /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u5728\u7236\u8fdb\u7a0b\u7684console\u4e0b\u8f93\u5165\u5b57\u7b26\u4e32\uff0c\u6b64\u65f6\u5b50\u8fdb\u7a0b\u4f1a\u8bfb\u53d6\u5230\u8fd9\u4e2a\u5b57\u7b26\u4e32\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./share_sysv\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image034.png",alt:"ProcessCommunication_Image034"})}),"\n",(0,i.jsx)(e.h2,{id:"45-\u8fdb\u7a0b\u901a\u4fe1\u4e4b\u4fe1\u53f7\u901a\u4fe1",children:"4.5 \u8fdb\u7a0b\u901a\u4fe1\u4e4b\u4fe1\u53f7\u901a\u4fe1"}),"\n",(0,i.jsx)(e.h3,{id:"451-\u4fe1\u53f7\u673a\u5236",children:"4.5.1 \u4fe1\u53f7\u673a\u5236"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e00\u822c\u5730\uff0c\u4e2d\u65ad\u4e3b\u8981\u662f\u6307\u786c\u4ef6\u4e2d\u65ad\uff0c\u6bd4\u5982GPIO\u4e2d\u65ad\u3001\u5b9a\u65f6\u5668\u4e2d\u65ad\uff0c\u8fd9\u4e9b\u786c\u4ef6\u4e2d\u65ad\u65f6\u5916\u8bbe\u6a21\u5757\u5de5\u4f5c\u65f6\uff0c\u53d1\u9001\u7ed9CPU\u7684\uff0c\u4e5f\u662f\u4e00\u79cd\u5f02\u6b65\u65b9\u5f0f\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4fe1\u53f7\u662f\u8f6f\u4ef6\u5c42\u6b21\u4e0a\u5bf9\u4e2d\u65ad\u673a\u5236\u7684\u4e00\u79cd\u6a21\u62df\uff0c\u662f\u4e00\u79cd\u5f02\u6b65\u901a\u4fe1\u65b9\u5f0f\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Linux\u5185\u6838\u901a\u8fc7\u4fe1\u53f7\u901a\u77e5\u7528\u6237\u8fdb\u7a0b\uff0c\u4e0d\u540c\u7684\u4fe1\u53f7\u7c7b\u578b\u4ee3\u8868\u4e0d\u540c\u7684\u4e8b\u4ef6\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"Linux\u5bf9\u65e9\u671f\u7684unix\u4fe1\u53f7\u673a\u5236\u8fdb\u884c\u4e86\u6269\u5c55\u3002"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"452-\u5e38\u89c1\u4fe1\u53f7\u7c7b\u578b",children:"4.5.2 \u5e38\u89c1\u4fe1\u53f7\u7c7b\u578b"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image035.png",alt:"ProcessCommunication_Image035"})}),"\n",(0,i.jsx)(e.h3,{id:"453-\u4fe1\u53f7\u53d1\u9001\u51fd\u6570",children:"4.5.3 \u4fe1\u53f7\u53d1\u9001\u51fd\u6570"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"kill\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u5934\u6587\u4ef6  #include <unistd.h>\n\n       #include <signal.h>\n\n\u51fd\u6570\u539f\u578bint kill(pid_t pid, int sig);\n\n\u53c2\u6570  pid \uff1a \u6307\u5b9a\u63a5\u6536\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u53f7\n\n            0\u4ee3\u8868\u540c\u7ec4\u8fdb\u7a0b\uff1b-1\u4ee3\u8868\u6240\u6709\u9664\u4e86INIT\u8fdb\u7a0b\u548c\u5f53\u524d\u8fdb\u7a0b\u4e4b\u5916\u7684\u8fdb\u7a0b\n\n     sig \uff1a \u4fe1\u53f7\u7c7b\u578b\n\n\u8fd4\u56de\u503c \u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56deEOF\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"raise\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u5934\u6587\u4ef6  #include <unistd.h>\n\n       #include <signal.h>\n\n\u51fd\u6570\u539f\u578bint raise(int sig);\n\n\u53c2\u6570  sig \uff1a \u4fe1\u53f7\u7c7b\u578b\n\n\u8fd4\u56de\u503c \u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56deEOF\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"alarm\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u5934\u6587\u4ef6  #include <unistd.h>\n\n       #include <signal.h>\n\n\u51fd\u6570\u539f\u578b int alarm(unsigned int seconds);\n\n\u53c2\u6570  seconds \u5b9a\u65f6\u5668\u7684\u65f6\u95f4\n\n\u8fd4\u56de\u503c \u6210\u529f\u8fd4\u56de\u4e0a\u4e2a\u5b9a\u65f6\u5668\u7684\u5269\u4f59\u65f6\u95f4\uff0c\u5931\u8d25\u8fd4\u56deEOF\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"pause\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u8fdb\u7a0b\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u540e\u4f1a\u4e00\u76f4\u963b\u585e\uff0c\u76f4\u5230\u800c\u88ab\u4fe1\u53f7\u4e2d\u65ad\uff0c\u529f\u80fd\u548csleep\u7c7b\u4f3c\u3002\n\n\u5934\u6587\u4ef6  #include <unistd.h>\n\n       #include <signal.h>\n\n\u51fd\u6570\u539f\u578b int pause(void);\n\n\u8fd4\u56de\u503c  \u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56deEOF\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"signal\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u8bbe\u7f6e\u4fe1\u53f7\u54cd\u5e94\u65b9\u5f0f\uff0c\u8bf7\u6ce8\u610f\u8fd9\u4e2a\u51fd\u6570\u548ckill\u3001killall\u7684\u533a\u522b\uff0c\u6211\u4eec\u4e2d\u6587\u4f7f\u7528\u8005\u4f1a\u7406\u89e3\u4e3a\u53d1\u4fe1\u53f7\uff0c\u5b9e\u9645\u4e0a\u5b83\u5e76\u4e0d\u662f\u53d1\u4fe1\u53f7\u3002\n\n\u5934\u6587\u4ef6  #include <unistd.h>\n\n       #include <signal.h>\n\n\u51fd\u6570\u539f\u578b void (*signal(int signo, void(*handler)(int)))(int)\n\n\u53c2\u6570  signo \u8981\u8bbe\u7f6e\u7684\u4fe1\u53f7\u7c7b\u578b\n\n     handler \u6307\u5b9a\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\uff1b\n\n\u8fd4\u56de\u503c \u6210\u529f\u8fd4\u56de0\uff0c\u5931\u8d25\u8fd4\u56deEOF\n"})}),"\n",(0,i.jsx)(e.h3,{id:"454-\u8fdb\u7a0b\u6355\u6349\u4fe1\u53f7",children:"4.5.4 \u8fdb\u7a0b\u6355\u6349\u4fe1\u53f7"}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u6e90\u7801\uff08\u53c2\u8003jz2440\\process_single\\send_single.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.\u6355\u6349\u7ec8\u7aef\u53d1\u9001\u8fc7\u6765\u7684\u4fe1\u53f7\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 \n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 #include <sys/types.h>\n15 #include <signal.h>\n16 \n17 void handler(int signo)\n18 {\n19  \tswitch (signo) {\n20 \t\tcase SIGINT:\n21 \t\t\tprintf("I have got SIGINT\\n");\n22 \t\t\tbreak;\n23 \t\t\t\n24 \t\tcase SIGQUIT:\n25 \t\t\tprintf("I have got SIGQUIT\\n");\n26 \t\t\tbreak;\n27 \t\t\t\n28 \t\tdefault:\n29 \t\t\tprintf("don\'t respond to this signal[%d]\\n", signo);\n30 \t\t\texit(0);\n31 \t}\n32 }\n33 \n34 int main(int argc, char *argv[])\n35 {\n36 \tsignal(SIGINT, handler);\n37 \tsignal(SIGQUIT, handler);\n38 \twhile (1)\n39 \t\tpause();\n40 \treturn 0;\n41 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc send_single.c -o send_single\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp send_single /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./send_single\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5b9e\u9645\u4e0a\u5728\u5229\u7528\u5171\u4eab\u5185\u5b58\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65f6\uff0c\u6211\u4eec\u5df2\u7ecf\u4f7f\u7528\u5230\u4e86\u4fe1\u53f7\u901a\u4fe1\uff0c\u7236\u8fdb\u7a0b\u5199\u5b8c\u5171\u4eab\u5185\u5b58\u540e\u53d1\u9001\u4fe1\u53f7\u901a\u77e5\u5b50\u8fdb\u7a0b\uff0c\u5b50\u8fdb\u7a0b\u6536\u5230\u4fe1\u53f7\u540e\u5f00\u59cb\u8bfb\u5171\u4eab\u5185\u5b58\uff0c\u8fd9\u91cc\u5c31\u4e0d\u5728\u7ed9\u51fa\u4e24\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u4f7f\u7528\u4fe1\u53f7\u901a\u4fe1\u7684\u4f8b\u5b50\u4e86\uff0c\u8bf7\u8bfb\u8005\u53c2\u8003\u5171\u4eab\u5185\u5b58\u4e2d\u5b9e\u73b0\u4e24\u4e2a\u8fdb\u7a0b\u901a\u4fe1\u7684\u4ee3\u7801\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"46-\u8fdb\u7a0b\u901a\u4fe1\u4e4bsocket\u901a\u4fe1",children:"4.6 \u8fdb\u7a0b\u901a\u4fe1\u4e4bsocket\u901a\u4fe1"}),"\n",(0,i.jsx)(e.h3,{id:"461-\u4ec0\u4e48\u662fsocket",children:"4.6.1 \u4ec0\u4e48\u662fsocket"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5148\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff1a\u7f51\u7edc\u73af\u5883\u4e2d\u7684\u8fdb\u7a0b\u5982\u4f55\u5b9e\u73b0\u901a\u4fe1\uff1f\u6bd4\u5982\u5f53\u6211\u4eec\u4f7f\u7528QQ\u548c\u597d\u53cb\u804a\u5929\u7684\u65f6\u5019\uff0cQQ\u8fdb\u7a0b\u662f\u5982\u4f55\u4e0e\u670d\u52a1\u5668\u4ee5\u53ca\u4f60\u597d\u53cb\u6240\u5728\u7684QQ\u8fdb\u7a0b\u4e4b\u95f4\u901a\u4fe1\u7684\uff1f\u8fd9\u4e9b\u9760\u7684\u5c31\u662fsocket\u6765\u5b9e\u73b0\u7684\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\tSocket\u8d77\u6e90\u4e8eUNIX\uff0cUnix/Linux\u57fa\u672c\u54f2\u5b66\u4e4b\u4e00\u5c31\u662f\u201c\u4e00\u5207\u7686\u6587\u4ef6\u201d\uff0c\u90fd\u53ef\u4ee5\u7528\u201c\u6253\u5f00open \u2013> \u8bfb\u5199write/read \u2013> \u5173\u95edclose\u201d\u6a21\u5f0f\u6765\u64cd\u4f5c\u3002\u5728\u300a\u6709\u540d\u7ba1\u9053\u300b\u90a3\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u77e5\u9053socket\u4e5f\u662f\u4e00\u79cd\u6587\u4ef6\u7c7b\u578b\uff0c\u53ea\u4e0d\u8fc7socket\u662f\u4e00\u79cd\u4f2a\u6587\u4ef6\uff0c\u5b58\u5728\u4e8e\u5185\u6838\u7f13\u51b2\u533a\u4e2d\uff0c\u5927\u5c0f\u4e0d\u53d8\uff0c\u4e00\u76f4\u662f0\u3002"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\tsocket\u6587\u4ef6\u4e00\u5b9a\u662f\u6210\u5bf9\u51fa\u73b0\u7684\uff0cserver\u7aef\u6709\u4e00\u4e2a\u5957\u63a5\u5b57\u6587\u4ef6\uff0cclient\u7aef\u4e5f\u6709\u4e00\u4e2a\u5957\u63a5\u5b57\u6587\u4ef6\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u9700\u8981\u548c\u5bf9\u5e94\u7684\u5957\u63a5\u5b57\u6587\u4ef6\u7ed1\u5b9a\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u901a\u8fc7\u8bfb\u5199\u5b83\u7684\u5957\u63a5\u5b57\u6587\u4ef6\uff0c\u4ea4\u7531\u5185\u6838\u5b9e\u73b0\uff0c\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image036.png",alt:"ProcessCommunication_Image036"})}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u4e00\u822c\u5730\uff0csocket\u7528\u6765\u5b9e\u73b0\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u4e0d\u540c\u4e3b\u673a\u4e0a\u7684\u8fdb\u7a0b\u901a\u4fe1\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u7528\u6765\u5728\u540c\u4e00\u4e2a\u4e3b\u673a\u4e0a\u7684\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u901a\u4fe1\uff0c\u672c\u5c0f\u8282\u4e3b\u8981\u63a2\u8ba8socket\u7528\u5728\u540c\u4e00\u4e2a\u4e3b\u673a\u4e0a\u7684\u4e0d\u540c\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"462-\u76f8\u5173\u51fd\u6570",children:"4.6.2 \u76f8\u5173\u51fd\u6570"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"socket\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u521b\u5efasocket\u6587\u4ef6\u63cf\u8ff0\u7b26\u51fd\u6570\n\n\u5934\u6587\u4ef6#include <sys/types.h>\n\n     #include <sys/socket.h>\n\n  \u539f\u578b: int socket(int domain, int type, int protocol)\n\n  \u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"bind\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u5c06socket\u6587\u4ef6\u63cf\u8ff0\u7b26\u548c\u67d0\u4e2asocket\u6587\u4ef6\u7ed1\u5b9a\n\n\u5934\u6587\u4ef6#include <sys/types.h>\n\n     #include <sys/socket.h>\n\n\u539f\u578b: int bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen);\n\n\u53c2\u6570\uff1a sockfd\uff1a\u5229\u7528\u7cfb\u7edf\u8c03\u7528socket()\u5efa\u7acb\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26\n\n      addr\uff1a\u4ee3\u8868\u9700\u8981\u7ed1\u5b9a\u7684\u672c\u5730\u5730\u5740\u4fe1\u606f\n     \n      addrlen: \u672c\u5730\u5730\u5740\u4fe1\u606f\u957f\u5ea6\n\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"listen\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u8bbe\u7f6e\u76d1\u542c\u67d0\u4e2asocket\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u8bbe\u7f6e\u80fd\u591f\u540c\u65f6\u548c\u670d\u52a1\u7aef\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u6570\u91cf\uff0c\u4e00\u822c\u53ea\u6709server\u4f1a\u8c03\u7528\n\n\u5934\u6587\u4ef6#include <sys/types.h>\n\n     #include <sys/socket.h>\n\n\u539f\u578b: int listen(int sockfd, int backlog);\n\n\u53c2\u6570\uff1a sockfd\uff1a\u5229\u7528\u7cfb\u7edf\u8c03\u7528socket()\u5efa\u7acb\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26\n\n      backlog\uff1aserver\u53ef\u4ee5\u63a5\u53d7\u8fde\u63a5\u7684\u6700\u5927client\u6570\u91cf\n\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"accept\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u7b49\u5f85client\u5efa\u7acb\u8fde\u63a5\u7684\u51fd\u6570\uff0c\u4e00\u822c\u53ea\u6709server\u4f1a\u8c03\u7528\n\n\u5934\u6587\u4ef6#include <sys/types.h>\n\n     #include <sys/socket.h>\n\n\u539f\u578b: int accept(int sockfd,struct sockaddr *addr,socklen_t *addrlen);\n\n\u53c2\u6570\uff1a sockfd\uff1a\u5229\u7528\u7cfb\u7edf\u8c03\u7528socket()\u5efa\u7acb\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26\n\n      addr\uff1a\u6307\u5411\u5df2\u7ecf\u5efa\u7acb\u8fde\u63a5\u7684\u5bf9\u7aefclient\u5730\u5740\u4fe1\u606f\u7684\u6307\u9488\n\n      addrlen: \u5bf9\u7aefclient\u5730\u5740\u4fe1\u606f\u957f\u5ea6\n\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"connet\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"client\u4e3b\u52a8\u8fde\u63a5server\u51fd\u6570\uff0c\u4e00\u822c\u53ea\u6709client\u624d\u4f1a\u8c03\u7528\n\n\u5934\u6587\u4ef6#include <sys/types.h>\n\n     #include <sys/socket.h>\n\n\u539f\u578b: int connect(int sockfd, const struct sockaddr *addr, socklen_t addrlen);\n\n\u53c2\u6570\uff1a sockfd\uff1a\u5229\u7528\u7cfb\u7edf\u8c03\u7528socket()\u5efa\u7acb\u7684\u5957\u63a5\u5b57\u63cf\u8ff0\u7b26\n\n      addr\uff1a\u6307\u5411\u5df2\u7ecf\u5efa\u7acb\u8fde\u63a5\u7684\u5bf9\u7aefserver\u5730\u5740\u4fe1\u606f\u7684\u6307\u9488\n\n      addrlen: \u5bf9\u7aefserver\u5730\u5740\u4fe1\u606f\u957f\u5ea6\n\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"send\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u53d1\u9001\u6570\u636e\u51fd\u6570\n\n\u5934\u6587\u4ef6#include <sys/types.h>\n\n     #include <sys/socket.h>\n\n\u539f\u578b: ssize_t send(int sockfd, const void *buf, size_t len, int flags);\n\n\u53c2\u6570\uff1a sockfd\uff1a\u6307\u5411\u8981\u53d1\u9001\u6570\u636e\u7684socket\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5df2\u7ecf\u5efa\u7acb\u8fde\u63a5\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\n\n      buf: \u5b58\u653e\u8981\u53d1\u9001\u6570\u636e\u7684\u7f13\u51b2\u533a\n\n      len: \u5b9e\u9645\u8981\u53d1\u9001\u6570\u636e\u7684\u5b57\u8282\u6570\n\n      flags: \u4e00\u822c\u4e3a0\u6216\u8005\u5982\u4e0b\u7684\u5b8f\n\n\t\t\tMSG_DONTROUTE  \u7ed5\u8fc7\u8def\u7531\u8868\u67e5\u627e\n\n\t\t\tMSG_DONTWAIT   \u4ec5\u672c\u64cd\u4f5c\u975e\u963b\u585e\n\n\t\t\tMSG_OOB\u3000\u3000\u3000\u3000  \u53d1\u9001\u6216\u63a5\u6536\u5e26\u5916\u6570\u636e\n\n\t\t\tMSG_PEEK\u3000\u3000    \u7aa5\u770b\u5916\u6765\u6d88\u606f\n\n\t\t\tMSG_WAITALL\u3000\u3000  \u7b49\u5f85\u6240\u6709\u6570\u636e\n\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"recv\u51fd\u6570"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"\u63a5\u6536\u6570\u636e\u51fd\u6570\n\n\u5934\u6587\u4ef6#include <sys/types.h>\n\n     #include <sys/socket.h>\n\n\u539f\u578b: ssize_t recv(int sockfd, void *buf, size_t len, int flags);\n\n\u53c2\u6570\uff1a sockfd\uff1a\u5df2\u7ecf\u5efa\u7acb\u8fde\u63a5\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\n\n\t  buf: \u5b58\u653e\u8981\u63a5\u6536\u6570\u636e\u7684\u7f13\u51b2\u533a\n\n\t  len: \u5b9e\u9645\u8981\u63a5\u6536\u6570\u636e\u7684\u5b57\u8282\u6570\n\n\t  flags:\u4e00\u822c\u4e3a0\u6216\u8005\u5982\u4e0b\u7684\u5b8f\n\n          MSG_DONTROUTE  \u7ed5\u8fc7\u8def\u7531\u8868\u67e5\u627e\n\n          MSG_DONTWAIT   \u4ec5\u672c\u64cd\u4f5c\u975e\u963b\u585e\n\n          MSG_OOB\u3000\u3000\u3000\u3000  \u53d1\u9001\u6216\u63a5\u6536\u5e26\u5916\u6570\u636e\n\n          MSG_PEEK\u3000\u3000    \u7aa5\u770b\u5916\u6765\u6d88\u606f\n\n          MSG_WAITALL\u3000\u3000  \u7b49\u5f85\u6240\u6709\u6570\u636e\n\n\u8fd4\u56de\u503c\uff1a \u6210\u529f\uff0c\u6d88\u606f\u961f\u5217ID\uff0c\u51fa\u9519 -1\n"})}),"\n",(0,i.jsx)(e.h3,{id:"463-socket\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1",children:"4.6.3 socket\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u901a\u4fe1"}),"\n",(0,i.jsx)(e.p,{children:"\u7a0b\u5e8f\u5b9e\u73b0\u4e00\u822c\u6b65\u9aa4"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"Server\u7aef\n\n1.\u521b\u5efasocket\n\n2.\u7ed1\u5b9asocket\n\n3.\u8bbe\u7f6e\u76d1\u542c\n\n4.\u7b49\u5f85\u5ba2\u6237\u7aef\u8fde\u63a5\n\n5.\u53d1\u9001/\u63a5\u6536\u6570\u636e\n"})}),"\n",(0,i.jsx)(e.p,{children:"Client\u7aef"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"1.\u521b\u5efasocket\n\n2.\u7ed1\u5b9asocket\n\n3.\u8fde\u63a5\n\n4.\u53d1\u9001/\u63a5\u6536\u6570\u636e\n"})}),"\n",(0,i.jsx)(e.p,{children:"server\u6e90\u7801\uff08\u53c2\u8003jz2440\\process_socket\\server.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.server\u6253\u5370client\u53d1\u9001\u8fc7\u6765\u7684\u5b57\u7b26\u4e32\uff0c\u5e76\u5c06\u8be5\u5b57\u7b26\u4e32\u56de\u53d1\u7ed9client\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 \n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 #include <sys/types.h>\n15 #include <sys/stat.h>\n16 #include <string.h>\n17 #include <arpa/inet.h>\n18 #include <sys/un.h>\n19 \n20 int main(int argc, char *argv[])\n21 {\n22     int lfd ,ret, cfd;\n23     struct sockaddr_un serv, client;\n24     socklen_t len = sizeof(client);\n25     char buf[1024] = {0};\n26     int recvlen;\n27 \n28     //\u521b\u5efasocket\n29     lfd = socket(AF_LOCAL, SOCK_STREAM, 0);\n30     if (lfd == -1) {\n31         perror("socket error");\n32         return -1;\n33     }\n34 \n35     //\u5982\u679c\u5957\u63a5\u5b57\u6587\u4ef6\u5b58\u5728\uff0c\u5220\u9664\u5957\u63a5\u5b57\u6587\u4ef6\n36     unlink("server.sock");\n37 \n38     //\u521d\u59cb\u5316server\u4fe1\u606f\n39     serv.sun_family = AF_LOCAL;\n40     strcpy(serv.sun_path, "server.sock");\n41 \n42     //\u7ed1\u5b9a\n43     ret = bind(lfd, (struct sockaddr *)&serv, sizeof(serv));\n44     if (ret == -1) {\n45         perror("bind error");\n46         return -1;\n47     }\n48 \n49     //\u8bbe\u7f6e\u76d1\u542c\uff0c\u8bbe\u7f6e\u80fd\u591f\u540c\u65f6\u548c\u670d\u52a1\u7aef\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u6570\u91cf\n50     ret = listen(lfd, 36);\n51     if (ret == -1) {\n52         perror("listen error");\n53         return -1;\n54     }\n55 \n56     //\u7b49\u5f85\u5ba2\u6237\u7aef\u8fde\u63a5\n57     cfd = accept(lfd, (struct sockaddr *)&client, &len);\n58     if (cfd == -1) {\n59         perror("accept error");\n60         return -1;\n61     }\n62     printf("=====client bind file:%s\\n", client.sun_path);\n63     \n64     while (1) {\n65         recvlen = recv(cfd, buf, sizeof(buf), 0);\n66         if (recvlen == -1) {\n67             perror("recv error");\n68             return -1;\n69         } else if (recvlen == 0) {\n70             printf("client disconnet...\\n");\n71             close(cfd);\n72             break;\n73         } else {\n74             printf("server recv buf: %s\\n", buf);\n75             send(cfd, buf, recvlen, 0);\n76         }\n77     }\n78     \n79     close(cfd);\n80     close(lfd);\n81     return 0;\n82 }\n'})}),"\n",(0,i.jsx)(e.p,{children:"client\u6e90\u7801\uff08\u53c2\u8003jz2440\\process_socket\\client.c\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:'01 /**********************************************************************\n02  * \u529f\u80fd\u63cf\u8ff0\uff1a 1.client\u4ece\u6807\u51c6\u8f93\u5165\u83b7\u53d6\u5230\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u5c06\u8fd9\u4e2a\u5b57\u7b26\u4e32\u53d1\u9001\u7ed9server\n03  * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n04  * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n05  * \u8fd4 \u56de \u503c\uff1a \u65e0\n06  * \u4fee\u6539\u65e5\u671f        \u7248\u672c\u53f7     \u4fee\u6539\u4eba          \u4fee\u6539\u5185\u5bb9\n07  * -----------------------------------------------\n08  * 2020/05/16       V1.0      zh(ryan)        \u521b\u5efa\n09  ***********************************************************************/\n10 \n11 #include <stdio.h>\n12 #include <stdlib.h>\n13 #include <unistd.h>\n14 #include <sys/types.h>\n15 #include <sys/stat.h>\n16 #include <string.h>\n17 #include <arpa/inet.h>\n18 #include <sys/un.h>\n19 \n20 int main(int argc, char *argv[])\n21 {\n22     int lfd ,ret;\n23     struct sockaddr_un serv, client;\n24     socklen_t len = sizeof(client);\n25     char buf[1024] = {0};\n26     int recvlen;\n27 \n28     //\u521b\u5efasocket\n29     lfd = socket(AF_LOCAL, SOCK_STREAM, 0);\n30     if (lfd == -1) {\n31         perror("socket error");\n32         return -1;\n33     }\n34 \n35     //\u5982\u679c\u5957\u63a5\u5b57\u6587\u4ef6\u5b58\u5728\uff0c\u5220\u9664\u5957\u63a5\u5b57\u6587\u4ef6\n36     unlink("client.sock");\n37 \n38     //\u7ed9\u5ba2\u6237\u7aef\u7ed1\u5b9a\u4e00\u4e2a\u5957\u63a5\u5b57\u6587\u4ef6\n39     client.sun_family = AF_LOCAL;\n40     strcpy(client.sun_path, "client.sock");\n41     ret = bind(lfd, (struct sockaddr *)&client, sizeof(client));\n42     if (ret == -1) {\n43         perror("bind error");\n44         return -1;\n45     }\n46 \n47     //\u521d\u59cb\u5316server\u4fe1\u606f\n48     serv.sun_family = AF_LOCAL;\n49     strcpy(serv.sun_path, "server.sock");\n50     //\u8fde\u63a5\n51     connect(lfd, (struct sockaddr *)&serv, sizeof(serv));\n52 \n53     while (1) {\n54         fgets(buf, sizeof(buf), stdin);\n55         send(lfd, buf, strlen(buf)+1, 0);\n56 \n57         recv(lfd, buf, sizeof(buf), 0);\n58         printf("client recv buf: %s\\n", buf);\n59     }\n60 \n61     close(lfd);\n62     return 0;\n63 }\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JZ2440\u5b9e\u9a8c"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u7f16\u8bd1"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"arm-linux-gcc server.c -o server\n\narm-linux-gcc client.c -o client\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u62f7\u8d1d\u5230NFS\u6587\u4ef6\u7cfb\u7edf"}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"cp server /work/nfs_root/first_fs\n\ncp client /work/nfs_root/first_fs\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u8fd0\u884c"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"\u4e3a\u65b9\u4fbf\u770b\u7a0b\u5e8f\u8fd0\u884c\u7ed3\u679c\uff0cserver\u5728\u540e\u53f0\u6267\u884c\uff1bclient\u5728\u524d\u53f0\u8fd0\u884c\uff0cclient\u80fd\u591f\u63a5\u6536\u6765\u81ea\u7ec8\u7aef\u7684\u8f93\u5165\u3002"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-c",children:"./server &\n\n./client\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/ProcessCommunication_Image037.png",alt:"ProcessCommunication_Image037"})}),"\n",(0,i.jsx)(e.h3,{id:"464-\u4e00\u4e2aserver\u548c\u591a\u4e2aclient\u4e4b\u95f4\u7684\u901a\u4fe1",children:"4.6.4 \u4e00\u4e2aserver\u548c\u591a\u4e2aclient\u4e4b\u95f4\u7684\u901a\u4fe1"}),"\n",(0,i.jsx)(e.p,{children:"\u200b\t\t\u5728\u5b9e\u9645\u9879\u76ee\u5f00\u53d1\u4e2d\uff0c \u66f4\u5e38\u89c1\u7684\u4e00\u79cd\u573a\u666f\u662f\uff1a\u4e00\u4e2aserver\u8981\u548c\u591a\u4e2aclient\u4e4b\u95f4\u901a\u4fe1\uff0c\u8fd9\u90e8\u5206\u5b9e\u73b0\u65b9\u5f0f\u4ea4\u7ed9\u8bfb\u8005\u81ea\u884c\u5b9e\u73b0\uff0c\u5b9e\u73b0\u7684\u65b9\u5f0f\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u5982\u4e0b\u4e24\u79cd\u65b9\u5f0f\uff0c\u5f53\u7136\u8fd8\u8981\u5176\u4ed6\u65b9\u6cd5\u3002"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u591a\u8fdb\u7a0b\u5b9e\u73b0\uff0c\u4e00\u4e2a\u4e3b\u8fdb\u7a0b\u7528\u6765\u5b9e\u73b0\u68c0\u6d4bclient\u7684\u8fde\u63a5\uff0c\u6bcf\u68c0\u6d4b\u4e00\u6b21client\u8fde\u63a5\uff0c\u5219\u4e3a\u8fd9\u4e2aclient\u521b\u5efa\u4e00\u4e2a\u4e13\u95e8\u7684\u8fdb\u7a0b\uff0c\u7528\u4e8e\u5b9e\u73b0\u4e24\u8005\u95f4\u901a\u4fe1\u3002"}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsx)(e.p,{children:"\u4e5f\u53ef\u4ee5\u4f7f\u7528\u591a\u7ebf\u7a0b\u5b9e\u73b0\uff0c\u4e00\u4e2a\u4e3b\u7ebf\u7a0b\u7528\u6765\u68c0\u6d4bclient\u7684\u8fde\u63a5\uff0c\u6bcf\u68c0\u6d4b\u4e00\u6b21client\u8fde\u63a5\uff0c\u5219\u4e3a\u8fd9\u4e2aclient\u521b\u5efa\u4e00\u4e2a\u4e13\u95e8\u7684\u7ebf\u7a0b\uff0c\u7528\u4e8e\u5b9e\u73b0\u4e24\u8005\u95f4\u901a\u4fe1\u3002"}),"\n"]}),"\n"]})]})}function o(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>t,x:()=>l});var i=s(6540);const c={},r=i.createContext(c);function t(n){const e=i.useContext(r);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:t(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);