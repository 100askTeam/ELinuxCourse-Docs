"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4234],{2712:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>_,frontMatter:()=>c,metadata:()=>d,toc:()=>a});var r=s(4848),t=s(8453);const c={},i="14 CAN\u7f16\u7a0b",d={id:"Knowledge-Notes/Linux_Can",title:"14 CAN\u7f16\u7a0b",description:"14.1 CAN\u4ecb\u7ecd",source:"@site/docs/Knowledge-Notes/14_Linux_Can.md",sourceDirName:"Knowledge-Notes",slug:"/Knowledge-Notes/Linux_Can",permalink:"/en/docs/Knowledge-Notes/Linux_Can",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/linux-docs/tree/main/docs/Knowledge-Notes/14_Linux_Can.md",tags:[],version:"current",sidebarPosition:14,frontMatter:{},sidebar:"KnowledgeNotes",previous:{title:"12 I2C\u7f16\u7a0b",permalink:"/en/docs/Knowledge-Notes/IIC"},next:{title:"15 \u5b58\u50a8\u8bbe\u5907",permalink:"/en/docs/Knowledge-Notes/FlashDevice"}},l={},a=[{value:"14.1 CAN\u4ecb\u7ecd",id:"141-can\u4ecb\u7ecd",level:2},{value:"14.1.1 CAN\u662f\u4ec0\u4e48\uff1f",id:"1411-can\u662f\u4ec0\u4e48",level:3},{value:"14.1.2 CAN\u7684\u8d77\u6e90",id:"1412-can\u7684\u8d77\u6e90",level:3},{value:"14.1.3 CAN\u4f20\u8f93\u6a21\u578b",id:"1413-can\u4f20\u8f93\u6a21\u578b",level:3},{value:"14.1.4 CAN\u7f51\u7edc\u62d3\u6251",id:"1414-can\u7f51\u7edc\u62d3\u6251",level:3},{value:"14.1.5 CAN\u7269\u7406\u7279\u6027",id:"1415-can\u7269\u7406\u7279\u6027",level:3},{value:"14.1.6 CAN\u62a5\u6587\u5e27",id:"1416-can\u62a5\u6587\u5e27",level:3},{value:"14.1.6.1 CAN\u62a5\u6587\u683c\u5f0f",id:"14161-can\u62a5\u6587\u683c\u5f0f",level:4},{value:"14.1.6.2 CAN\u62a5\u6587\u5e27\u7c7b\u578b",id:"14162-can\u62a5\u6587\u5e27\u7c7b\u578b",level:4},{value:"14.2 CAN\u7f16\u7a0b\u6846\u67b6\u521b\u5efa",id:"142-can\u7f16\u7a0b\u6846\u67b6\u521b\u5efa",level:2},{value:"14.3 STM32 CAN\u5e94\u7528\u7f16\u7a0b",id:"143-stm32-can\u5e94\u7528\u7f16\u7a0b",level:2},{value:"14.3.1 STM32 CAN\u63a5\u53e3\u7535\u8def",id:"1431-stm32-can\u63a5\u53e3\u7535\u8def",level:3},{value:"14.3.2 STM32 CAN\u5e94\u7528\u7f16\u7a0b\u6b65\u9aa4",id:"1432-stm32-can\u5e94\u7528\u7f16\u7a0b\u6b65\u9aa4",level:3},{value:"<strong>14.3.2.1</strong> <strong>\u51c6\u5907STM32\u5de5\u7a0b\u6a21\u7248</strong>",id:"14321-\u51c6\u5907stm32\u5de5\u7a0b\u6a21\u7248",level:4},{value:"<strong>14.3.2.2</strong> <strong>\u7f16\u5199CAN\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570</strong>",id:"14322-\u7f16\u5199can\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570",level:4},{value:"<strong>14.3.2.3</strong> <strong>\u7f16\u5199CAN\u5e94\u7528\u5c42\u4ee3\u7801</strong>",id:"14323-\u7f16\u5199can\u5e94\u7528\u5c42\u4ee3\u7801",level:4},{value:"<strong>14.3.2.4 STM32 CAN\u6848\u4f8b\u6d4b\u8bd5</strong>",id:"14324-stm32-can\u6848\u4f8b\u6d4b\u8bd5",level:4},{value:"<strong>14.4 Linux socketcan\u57fa\u7840\u5e94\u7528\u7f16\u7a0b</strong>",id:"144-linux-socketcan\u57fa\u7840\u5e94\u7528\u7f16\u7a0b",level:2},{value:"<strong>14.4.1 socketcan\u6982\u8ff0</strong>",id:"1441-socketcan\u6982\u8ff0",level:3},{value:"<strong>14.4.2 socketcan\u57fa\u672c\u77e5\u8bc6\u70b9</strong>",id:"1442-socketcan\u57fa\u672c\u77e5\u8bc6\u70b9",level:3},{value:"<strong>14.4.2.1 CAN\u8bbe\u5907\u64cd\u4f5c</strong>",id:"14421-can\u8bbe\u5907\u64cd\u4f5c",level:4},{value:"<strong>14.4.2.2 \u4ec0\u4e48\u662fSocket\u5957\u63a5\u53e3</strong>",id:"14422-\u4ec0\u4e48\u662fsocket\u5957\u63a5\u53e3",level:4},{value:"<strong>14.4.2.3 Socket\u63a5\u53e3\u51fd\u6570</strong>",id:"14423-socket\u63a5\u53e3\u51fd\u6570",level:4},{value:"<strong>14.4.3 socket_can\u7b80\u5355\u53d1\u9001\u5b9e\u4f8b</strong>",id:"1443-socket_can\u7b80\u5355\u53d1\u9001\u5b9e\u4f8b",level:3},{value:"<strong>14.4.3.1</strong> <strong>\u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570</strong>",id:"14431-\u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570",level:4},{value:"<strong>14.4.3.2 \u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801</strong>",id:"14432-\u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801",level:4},{value:"<strong>14.4.3.3 \u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1</strong>",id:"14433-\u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1",level:4},{value:"<strong>14.4.4 socket_can \u7b80\u5355\u63a5\u6536\u5b9e\u4f8b</strong>",id:"1444-socket_can-\u7b80\u5355\u63a5\u6536\u5b9e\u4f8b",level:3},{value:"<strong>14.4.4.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570</strong>",id:"14441-\u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570",level:4},{value:"<strong>14.4.4.2</strong> <strong>\u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801</strong>",id:"14442-\u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801",level:4},{value:"<strong>14.4.4.3</strong> <strong>\u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1</strong>",id:"14443-\u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1",level:4},{value:"<strong>14.4.5 socket_can \u63a5\u6536\u548c\u53d1\u9001\u5b9e\u4f8b</strong>",id:"1445-socket_can-\u63a5\u6536\u548c\u53d1\u9001\u5b9e\u4f8b",level:3},{value:"<strong>14.4.5.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570</strong>",id:"14451-\u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570",level:4},{value:"<strong>14.5</strong> <strong>\u6c7d\u8f66\u884c\u4e1aCAN\u603b\u7ebf\u5e94\u7528</strong>",id:"145-\u6c7d\u8f66\u884c\u4e1acan\u603b\u7ebf\u5e94\u7528",level:2},{value:"<strong>14.5.1</strong> <strong>\u8f66\u5382CAN\u603b\u7ebf\u9700\u6c42</strong>",id:"1451-\u8f66\u5382can\u603b\u7ebf\u9700\u6c42",level:3},{value:"<strong>14.5.1.1</strong> <strong>\u7f51\u7edc\u62d3\u6251\u7ed3\u6784</strong>",id:"14511-\u7f51\u7edc\u62d3\u6251\u7ed3\u6784",level:4},{value:"<strong>14.5.1.2 CAN \u62a5\u6587\u5206\u7c7b</strong>",id:"14512-can-\u62a5\u6587\u5206\u7c7b",level:4},{value:"<strong>14.5.2 CAN \u5e94\u7528\u62a5\u6587\u5e94\u7528\u5206\u6790\u53ca\u5b9e\u4f8b</strong>",id:"1452-can-\u5e94\u7528\u62a5\u6587\u5e94\u7528\u5206\u6790\u53ca\u5b9e\u4f8b",level:3},{value:"<strong>14.5.2.1 CAN \u5e94\u7528\u62a5\u6587\u5b9a\u4e49</strong>",id:"14521-can-\u5e94\u7528\u62a5\u6587\u5b9a\u4e49",level:4},{value:"14.5.2.2 CAN\u5e94\u7528\u62a5\u6587\u53d1\u9001\u89c4\u5219",id:"14522-can\u5e94\u7528\u62a5\u6587\u53d1\u9001\u89c4\u5219",level:4},{value:"14.5.2.3 \u6c7d\u8f66CAN\u5e94\u7528\u62a5\u6587\u53d1\u9001\u5e94\u7528\u5b9e\u4f8b",id:"14523-\u6c7d\u8f66can\u5e94\u7528\u62a5\u6587\u53d1\u9001\u5e94\u7528\u5b9e\u4f8b",level:4}];function x(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"14-can\u7f16\u7a0b",children:"14 CAN\u7f16\u7a0b"}),"\n",(0,r.jsx)(e.h2,{id:"141-can\u4ecb\u7ecd",children:"14.1 CAN\u4ecb\u7ecd"}),"\n",(0,r.jsx)(e.h3,{id:"1411-can\u662f\u4ec0\u4e48",children:"14.1.1 CAN\u662f\u4ec0\u4e48\uff1f"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tCAN\uff0c\u5168\u79f0\u4e3a\u201cController Area Network\u201d\uff0c\u5373\u63a7\u5236\u5668\u5c40\u57df\u7f51\uff0c\u662f\u56fd\u9645\u4e0a\u5e94\u7528\u6700\u5e7f\u6cdb\u7684\u73b0\u573a\u603b\u7ebf\u4e4b\u4e00\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u6700\u521d\uff0cCAN \u88ab\u8bbe\u8ba1\u4f5c\u4e3a\u6c7d\u8f66\u73af\u5883\u4e2d\u7684\u5fae\u63a7\u5236\u5668\u901a\u8baf\uff0c\u5728\u8f66\u8f7d\u5404\u7535\u5b50\u63a7\u5236\u88c5\u7f6e ECU \u4e4b\u95f4\u4ea4\u6362\u4fe1\u606f\uff0c\u5f62\u6210\u6c7d\u8f66"}),"\n",(0,r.jsx)(e.p,{children:"\u7535\u5b50\u63a7\u5236\u7f51\u7edc\u3002\u6bd4\u5982\uff1a\u53d1\u52a8\u673a\u7ba1\u7406\u7cfb\u7edf\u3001\u53d8\u901f\u7bb1\u63a7\u5236\u5668\u3001\u4eea\u8868\u88c5\u5907\u3001\u7535\u5b50\u4e3b\u5e72\u7cfb\u7edf\u4e2d\uff0c\u5747\u5d4c\u5165 CAN \u63a7\u5236\u88c5"}),"\n",(0,r.jsx)(e.p,{children:"\u7f6e\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u4e00\u4e2a\u7531 CAN \u603b\u7ebf\u6784\u6210\u7684\u5355\u4e00\u7f51\u7edc\u4e2d\uff0c\u7406\u8bba\u4e0a\u53ef\u4ee5\u6302\u63a5\u65e0\u6570\u4e2a\u8282\u70b9\u3002\u5b9e\u9645\u5e94\u7528\u4e2d\uff0c\u8282\u70b9\u6570\u76ee\u53d7\u7f51\u7edc\u786c\u4ef6"}),"\n",(0,r.jsx)(e.p,{children:"\u7684\u7535\u6c14\u7279\u6027\u6240\u9650\u5236\u3002\u4f8b\u5982\uff0c\u5f53\u4f7f\u7528 Philips P82C250 \u4f5c\u4e3a CAN \u6536\u53d1\u5668\u65f6\uff0c\u540c\u4e00\u7f51\u7edc\u4e2d\u5141\u8bb8\u6302\u63a5 110 \u4e2a\u8282\u70b9\u3002"}),"\n",(0,r.jsx)(e.p,{children:"CAN \u53ef\u63d0\u4f9b\u9ad8\u8fbe 1Mbit/s \u7684\u6570\u636e\u4f20\u8f93\u901f\u7387\uff0c\u8fd9\u4f7f\u5b9e\u65f6\u63a7\u5236\u53d8\u5f97\u975e\u5e38\u5bb9\u6613\u3002\u53e6\u5916\uff0c\u786c\u4ef6\u7684\u9519\u8bef\u68c0\u5b9a\u7279\u6027\u4e5f\u589e"}),"\n",(0,r.jsx)(e.p,{children:"\u5f3a\u4e86 CAN \u7684\u6297\u7535\u78c1\u5e72\u6270\u80fd\u529b\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"1412-can\u7684\u8d77\u6e90",children:"14.1.2 CAN\u7684\u8d77\u6e90"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tCAN \u6700\u521d\u51fa\u73b0\u5728 80 \u5e74\u4ee3\u672b\u7684\u6c7d\u8f66\u5de5\u4e1a\u4e2d\uff0c\u7531\u5fb7\u56fd Bosch \u516c\u53f8\u6700\u5148\u63d0\u51fa\u3002\u5f53\u65f6\uff0c\u7531\u4e8e\u6d88\u8d39\u8005\u5bf9\u4e8e\u6c7d\u8f66\u529f"}),"\n",(0,r.jsx)(e.p,{children:"\u80fd\u7684\u8981\u6c42\u8d8a\u6765\u8d8a\u591a\uff0c\u800c\u8fd9\u4e9b\u529f\u80fd\u7684\u5b9e\u73b0\u5927\u591a\u662f\u57fa\u4e8e\u7535\u5b50\u64cd\u4f5c\u7684\uff0c\u8fd9\u5c31\u4f7f\u5f97\u7535\u5b50\u88c5\u7f6e\u4e4b\u95f4\u7684\u901a\u8baf\u8d8a\u6765\u8d8a\u590d\u6742\uff0c"}),"\n",(0,r.jsx)(e.p,{children:"\u540c\u65f6\u610f\u5473\u7740\u9700\u8981\u66f4\u591a\u7684\u8fde\u63a5\u4fe1\u53f7\u7ebf\u3002\u63d0\u51fa CAN \u603b\u7ebf\u7684\u6700\u521d\u52a8\u673a\u5c31\u662f\u4e3a\u4e86\u89e3\u51b3\u73b0\u4ee3\u6c7d\u8f66\u4e2d\u5e9e\u5927\u7684\u7535\u5b50\u63a7\u5236\u88c5"}),"\n",(0,r.jsx)(e.p,{children:"\u7f6e\u4e4b\u95f4\u7684\u901a\u8baf\uff0c\u51cf\u5c11\u4e0d\u65ad\u589e\u52a0\u7684\u4fe1\u53f7\u7ebf\u3002\u4e8e\u662f\uff0c\u4ed6\u4eec\u8bbe\u8ba1\u4e86\u4e00\u4e2a\u5355\u4e00\u7684\u7f51\u7edc\u603b\u7ebf\uff0c\u6240\u6709\u7684\u5916\u56f4\u5668\u4ef6\u53ef\u4ee5\u88ab"}),"\n",(0,r.jsx)(e.p,{children:"\u6302\u63a5\u5728\u8be5\u603b\u7ebf\u4e0a\u30021993 \u5e74\uff0cCAN \u5df2\u6210\u4e3a\u56fd\u9645\u6807\u51c6 ISO11898(\u9ad8\u901f\u5e94\u7528)\u548c ISO11519\uff08\u4f4e\u901f\u5e94\u7528\uff09\u3002"}),"\n",(0,r.jsx)(e.p,{children:"CAN \u662f\u4e00\u79cd\u591a\u4e3b\u65b9\u5f0f\u7684\u4e32\u884c\u901a\u8baf\u603b\u7ebf\uff0c\u57fa\u672c\u8bbe\u8ba1\u89c4\u8303\u8981\u6c42\u6709\u9ad8\u7684\u4f4d\u901f\u7387\uff0c\u9ad8\u6297\u7535\u78c1\u5e72\u6270\u6027\uff0c\u800c\u4e14\u80fd\u591f\u68c0"}),"\n",(0,r.jsx)(e.p,{children:"\u6d4b\u51fa\u4ea7\u751f\u7684\u4efb\u4f55\u9519\u8bef\u3002\u5f53\u4fe1\u53f7\u4f20\u8f93\u8ddd\u79bb\u8fbe\u5230 10Km \u65f6\uff0cCAN \u4ecd\u53ef\u63d0\u4f9b\u9ad8\u8fbe 50Kbit/s \u7684\u6570\u636e\u4f20\u8f93\u901f\u7387\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u7531\u4e8e CAN \u603b\u7ebf\u5177\u6709\u5f88\u9ad8\u7684\u5b9e\u65f6\u6027\u80fd\uff0c\u56e0\u6b64\uff0cCAN \u5df2\u7ecf\u5728\u6c7d\u8f66\u5de5\u4e1a\u3001\u822a\u7a7a\u5de5\u4e1a\u3001\u5de5\u4e1a\u63a7\u5236\u3001\u5b89\u5168\u9632\u62a4\u7b49\u9886"}),"\n",(0,r.jsx)(e.p,{children:"\u57df\u4e2d\u5f97\u5230\u4e86\u5e7f\u6cdb\u5e94\u7528\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"1413-can\u4f20\u8f93\u6a21\u578b",children:"14.1.3 CAN\u4f20\u8f93\u6a21\u578b"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tCAN \u901a\u8baf\u534f\u8bae\u4e3b\u8981\u63cf\u8ff0\u8bbe\u5907\u4e4b\u95f4\u7684\u4fe1\u606f\u4f20\u9012\u65b9\u5f0f\u3002CAN \u5c42\u7684\u5b9a\u4e49\u4e0e\u5f00\u653e\u7cfb\u7edf\u4e92\u8fde\u6a21\u578b\uff08OSI\uff09\u4e00\u81f4\u3002\u6bcf"}),"\n",(0,r.jsx)(e.p,{children:"\u4e00\u5c42\u4e0e\u53e6\u4e00\u8bbe\u5907\u4e0a\u76f8\u540c\u7684\u90a3\u4e00\u5c42\u901a\u8baf\u3002\u5b9e\u9645\u7684\u901a\u8baf\u53d1\u751f\u5728\u6bcf\u4e00\u8bbe\u5907\u4e0a\u76f8\u90bb\u7684\u4e24\u5c42\uff0c\u800c\u8bbe\u5907\u53ea\u901a\u8fc7\u6a21\u578b\u7269\u7406"}),"\n",(0,r.jsx)(e.p,{children:"\u5c42\u7684\u7269\u7406\u4ecb\u8d28\u4e92\u8fde\u3002CAN \u7684\u89c4\u8303\u5b9a\u4e49\u4e86\u6a21\u578b\u7684\u6700\u4e0b\u9762\u4e24\u5c42\uff1a\u6570\u636e\u94fe\u8def\u5c42\u548c\u7269\u7406\u5c42\u3002\u4e0b\u8868\u4e2d\u5c55\u793a\u4e86 OSI \u5f00\u653e"}),"\n",(0,r.jsx)(e.p,{children:"\u5f0f\u4e92\u8fde\u6a21\u578b\u7684\u5404\u5c42\u3002\u5e94\u7528\u5c42\u534f\u8bae\u53ef\u4ee5\u7531 CAN \u7528\u6237\u5b9a\u4e49\u6210\u9002\u5408\u7279\u522b\u5de5\u4e1a\u9886\u57df\u7684\u4efb\u4f55\u65b9\u6848\u3002\u5df2\u5728\u5de5\u4e1a\u63a7\u5236\u548c\u5236"}),"\n",(0,r.jsx)(e.p,{children:"\u9020\u4e1a\u9886\u57df\u5f97\u5230\u5e7f\u6cdb\u5e94\u7528\u7684\u6807\u51c6\u662f DeviceNet\uff0c\u8fd9\u662f\u4e3a PLC \u548c\u667a\u80fd\u4f20\u611f\u5668\u8bbe\u8ba1\u7684\u3002\u5728\u6c7d\u8f66\u5de5\u4e1a\uff0c\u8bb8\u591a\u5236\u9020\u5546"}),"\n",(0,r.jsx)(e.p,{children:"\u90fd\u5e94\u7528\u4ed6\u4eec\u81ea\u5df1\u7684\u6807\u51c6\u3002"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u8868\u683c OSI\u5f00\u53d1\u7cfb\u7edf\u4e92\u8054\u6a21\u578b"}),(0,r.jsx)(e.th,{}),(0,r.jsx)(e.th,{})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5e8f\u53f7"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5c42\u6b21"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u63cf\u8ff0"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"7"}),(0,r.jsx)(e.td,{children:"\u5e94\u7528\u5c42"}),(0,r.jsx)(e.td,{children:"\u6700\u9ad8\u5c42\u3002\u7528\u6237\u3001\u8f6f\u4ef6\u3001\u7f51\u7edc\u7ec8\u7aef\u7b49\u4e4b\u95f4\u7528\u6765\u8fdb\u884c\u4fe1\u606f\u4ea4\u6362\u3002"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"6"}),(0,r.jsx)(e.td,{children:"\u8868\u793a\u5c42"}),(0,r.jsx)(e.td,{children:"\u5c06\u4e24\u4e2a\u5e94\u7528\u4e0d\u540c\u6570\u636e\u683c\u5f0f\u7684\u7cfb\u7edf\u4fe1\u606f\u8f6c\u5316\u4e3a\u80fd\u5171\u540c\u7406\u89e3\u7684\u683c\u5f0f"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"5"}),(0,r.jsx)(e.td,{children:"\u4f1a\u8bdd\u5c42"}),(0,r.jsx)(e.td,{children:"\u4f9d\u9760\u4f4e\u5c42\u7684\u901a\u4fe1\u529f\u80fd\u6765\u8fdb\u884c\u6570\u636e\u7684\u6709\u6548\u4f20\u9012\u3002"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"4"}),(0,r.jsx)(e.td,{children:"\u4f20\u8f93\u5c42"}),(0,r.jsx)(e.td,{children:"\u4e24\u901a\u8baf\u8282\u70b9\u4e4b\u95f4\u6570\u636e\u4f20\u8f93\u63a7\u5236\u3002\u64cd\u4f5c\u5982\uff1a\u6570\u636e\u91cd\u53d1\uff0c\u6570\u636e\u9519\u8bef\u4fee\u590d"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"3"}),(0,r.jsx)(e.td,{children:"\u7f51\u7edc\u5c42"}),(0,r.jsx)(e.td,{children:"\u89c4\u5b9a\u4e86\u7f51\u7edc\u8fde\u63a5\u7684\u5efa\u7acb\u3001\u7ef4\u6301\u548c\u62c6\u9664\u7684\u534f\u8bae\u3002\u5982\uff1a\u8def\u7531\u548c\u5bfb\u5740"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"\u6570\u636e\u94fe\u8def\u5c42"}),(0,r.jsx)(e.td,{children:"\u89c4\u5b9a\u4e86\u5728\u4ecb\u8d28\u4e0a\u4f20\u8f93\u7684\u6570\u636e\u4f4d\u7684\u6392\u5217\u548c\u7ec4\u7ec7\u3002\u5982\uff1a\u6570\u636e\u6821\u9a8c\u548c\u5e27\u7ed3\u6784"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"\u7269\u7406\u5c42"}),(0,r.jsx)(e.td,{children:"\u89c4\u5b9a\u901a\u8baf\u4ecb\u8d28\u7684\u7269\u7406\u7279\u6027\u3002\u5982\uff1a\u7535\u6c14\u7279\u6027\u548c\u4fe1\u53f7\u4ea4\u6362\u7684\u89e3\u91ca"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u867d\u7136CAN\u4f20\u8f93\u534f\u8bae\u53c2\u8003\u4e86OSI \u4e03\u5c42\u6a21\u578b\uff0c\u4f46\u662f\u5b9e\u9645\u4e0aCAN\u534f\u8bae\u53ea\u5b9a\u4e49\u4e86\u4e24\u5c42\u201c\u7269\u7406\u5c42\u201d\u548c\u201c\u6570\u636e\u94fe\u8def\u5c42\u201d\uff0c\u56e0\u6b64\u51fa\u73b0\u4e86\u5404\u79cd\u4e0d\u540c\u7684\u201c\u5e94\u7528\u5c42\u201d\u534f\u8bae\uff0c\u6bd4\u5982\u7528\u5728\u81ea\u52a8\u5316\u6280\u672f\u7684\u73b0\u573a\u603b\u7ebf\u6807\u51c6DeviceNet\uff0c\u7528\u4e8e\u5de5\u4e1a\u63a7\u5236\u7684CanOpen,\u7528\u4e8e\u4e58\u7528\u8f66\u7684\u8bca\u65ad\u534f\u8baeOBD\u3001UDS(\u7edf\u4e00\u8bca\u65ad\u670d\u52a1\uff0cISO14229)\uff0c\u7528\u4e8e\u5546\u7528\u8f66\u7684CAN\u603b\u7ebf\u534f\u8baeSAEJ1939."}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u8868\u683c CAN\u7684"})}),(0,r.jsx)(e.th,{}),(0,r.jsx)(e.th,{})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5e8f\u53f7"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5c42\u6b21"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u63cf\u8ff0"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"7"}),(0,r.jsx)(e.td,{children:"\u5e94\u7528\u5c42"}),(0,r.jsx)(e.td,{children:"\u4e3b\u8981\u5b9a\u4e49CAN\u5e94\u7528\u5c42\u3002"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"\u6570\u636e\u94fe\u8def\u5c42"}),(0,r.jsxs)(e.td,{children:["\u6570\u636e\u94fe\u8def\u5c42\u5206\u4e3a\u903b\u8f91\u94fe\u63a5\u63a7\u5236\u5b50\u5c42LLC\u548c\u4ecb\u8d28\u8bbf\u95ee\u63a7\u5236\u5b50\u5c42MAC\u3002MAC \u5b50\u5c42\u662f CAN \u534f\u8bae\u7684\u6838\u5fc3\u3002\u5b83\u628a\u63a5\u6536\u5230\u7684\u62a5\u6587\u63d0\u4f9b\u7ed9  LLC \u5b50\u5c42\uff0c\u5e76\u63a5\u6536\u6765\u81ea LLC \u5b50\u5c42\u7684\u62a5\u6587\u3002 MAC \u5b50\u5c42\u8d1f\u8d23\u62a5\u6587\u5206\u5e27\u3001\u4ef2\u88c1\u3001\u5e94\u7b54\u3001\u9519\u8bef\u68c0\u6d4b\u548c\u6807\u5b9a\u3002MAC \u5b50\u5c42\u4e5f\u88ab\u79f0\u4f5c\u6545\u969c\u754c\u5b9a\u7684\u7ba1\u7406 \u5b9e\u4f53\u76d1\u7ba1  LLC \u5b50\u5c42\u6d89\u53ca\u62a5\u6587\u6ee4\u6ce2\u3001\u8fc7\u8f7d\u901a\u77e5\u3001\u4ee5\u53ca\u6062\u590d\u7ba1\u7406\u3002",(0,r.jsx)(e.code,{children:"LLC = Logical Link  Control   MAC = Medium Access  Control"})]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"\u7269\u7406\u5c42"}),(0,r.jsx)(e.td,{children:"\u7269\u7406\u5c42\uff0c\u4e3a\u7269\u7406\u7f16\u7801\u5b50\u5c42PCS.  \u8be5\u5c42\u5b9a\u4e49\u4fe1\u53f7\u662f\u5982\u4f55\u5b9e\u9645\u5730\u4f20\u8f93\u7684\uff0c\u56e0\u6b64\u6d89\u53ca\u5230\u4f4d\u65f6\u95f4\u3001\u4f4d\u7f16\u7801\u3001\u540c\u6b65\u3002"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"1414-can\u7f51\u7edc\u62d3\u6251",children:"14.1.4 CAN\u7f51\u7edc\u62d3\u6251"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tCAN\u603b\u7ebf\u662f\u4e00\u79cd\u5206\u5e03\u5f0f\u7684\u63a7\u5236\u603b\u7ebf\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tCAN\u603b\u7ebf\u4f5c\u4e3a\u4e00\u79cd\u63a7\u5236\u5668\u5c40\u57df\u7f51\uff0c\u548c\u666e\u901a\u4ee5\u592a\u7f51\u4e00\u6837\uff0c\u5b83\u7684\u7f51\u7edc\u5f88\u591aCAN\u8282\u70b9\u6784\u6210\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5176\u7f51\u7edc\u62d3\u6251\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0001.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tCAN\u7f51\u7edc\u7684\u6bcf\u4e2a\u8282\u70b9\u975e\u5e38\u7b80\u5355\uff0c\u5747\u7531\u4e00\u4e2aMCU\uff08\u5fae\u63a7\u5236\u5668\uff09\u3001\u4e00\u4e2aCAN\u63a7\u5236\u5668\u548c\u4e00\u4e2aCAN\u6536\u53d1\u5668\u6784\u6210\uff0c\u7136\u540e\u4f7f\u7528\u53cc\u7ede\u7ebf\u8fde\u63a5\u5230CAN\u7f51\u7edc\u4e2d\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"1415-can\u7269\u7406\u7279\u6027",children:"14.1.5 CAN\u7269\u7406\u7279\u6027"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tCAN\u603b\u7ebf\u9075\u5faa\u56fd\u9645\u6807\u51c6ISO11898\uff0c\u5982ISO11898-1,ISO11898-2,ISO11898-3,ISO11898-4\u6807\u51c6\u3002"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u5e8f\u53f7"}),(0,r.jsx)(e.th,{children:"\u6807\u51c6"}),(0,r.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"ISO11898-1"}),(0,r.jsx)(e.td,{children:"\u6570\u636e\u94fe\u8def\u5c42\u548c\u7269\u7406\u5c42\u4fe1\u53f7"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"ISO11898-2"}),(0,r.jsx)(e.td,{children:"\u9ad8\u901f\u63a5\u5165\u5355\u5143"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"3"}),(0,r.jsx)(e.td,{children:"ISO11898-3"}),(0,r.jsx)(e.td,{children:"\u4f4e\u901f\u5bb9\u9519\u63a5\u5165\u5355\u5143"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"4"}),(0,r.jsx)(e.td,{children:"ISO11898-4"}),(0,r.jsx)(e.td,{children:"\u65f6\u95f4\u89e6\u53d1\u901a\u8baf"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"5"}),(0,r.jsx)(e.td,{children:"ISO11898-5"}),(0,r.jsx)(e.td,{children:"\u4f4e\u529f\u8017\u7684\u63a5\u5165\u5355\u5143"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"6"}),(0,r.jsx)(e.td,{children:"ISO11898-6"}),(0,r.jsx)(e.td,{children:"\u9009\u62e9\u6027\u5524\u9192\u7684\u9ad8\u901f\u63a5\u5165\u5355\u5143"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:"CAN \u80fd\u591f\u4f7f\u7528\u591a\u79cd\u7269\u7406\u4ecb\u8d28\uff0c\u4f8b\u5982\u53cc\u7ede\u7ebf\u3001\u5149\u7ea4\u7b49\u3002\u6700\u5e38\u7528\u7684\u5c31\u662f\u53cc\u7ede\u7ebf\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4fe1\u53f7\u4f7f\u7528\u5dee\u5206\u7535\u538b\u4f20\u9001\uff0c\u4e24\u6761\u4fe1\u53f7\u7ebf\u88ab\u79f0\u4e3a\u201cCAN_H\u201d\u548c\u201cCAN_L\u201d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u9759\u6001\u65f6CAN_H\u548cCAN_L\u5747\u662f 2.5V \u5de6\u53f3\uff0c\u6b64\u65f6\u72b6\u6001\u8868\u793a\u4e3a\u903b\u8f91\u201c1\u201d\uff0c\u4e5f\u53ef\u4ee5\u53eb\u505a \u201c\u9690\u6027\u201d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u7528 CAN_H \u6bd4 CAN_L \u9ad8\u8868\u793a\u903b\u8f91\u201c0\u201d\uff0c\u79f0\u4e3a\u201c\u663e\u5f62\u201d\uff0c\u6b64\u65f6\uff0c\u901a\u5e38\u7535\u538b\u503c\u4e3a\uff1aCAN_H = 3.5V \u548c CAN_L"}),"\n",(0,r.jsx)(e.p,{children:"= 1.5V \u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u76ee\u524d\u5b9e\u9645\u5e38\u7528\u7684CAN\u6536\u53d1\u5668\u6709\u5982\u4e0b\u51e0\u79cd\u578b\u53f7\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u5e8f\u53f7"}),(0,r.jsx)(e.th,{children:"\u578b\u53f7"}),(0,r.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"PCA82C250"}),(0,r.jsx)(e.td,{children:"\u9ad8\u901f CAN \u6536\u53d1\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"PCA82C251"}),(0,r.jsx)(e.td,{children:"\u9ad8\u901f CAN \u6536\u53d1\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"3"}),(0,r.jsx)(e.td,{children:"PCA82C252"}),(0,r.jsx)(e.td,{children:"\u5bb9\u9519 CAN \u6536\u53d1\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"4"}),(0,r.jsx)(e.td,{children:"TJA1040"}),(0,r.jsx)(e.td,{children:"\u9ad8\u901f CAN \u6536\u53d1\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"5"}),(0,r.jsx)(e.td,{children:"TJA1041"}),(0,r.jsx)(e.td,{children:"\u9ad8\u901f CAN \u6536\u53d1\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"6"}),(0,r.jsx)(e.td,{children:"TJA1042"}),(0,r.jsx)(e.td,{children:"\u9ad8\u901f CAN \u6536\u53d1\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"7"}),(0,r.jsx)(e.td,{children:"TJA1043"}),(0,r.jsx)(e.td,{children:"\u9ad8\u901f CAN \u6536\u53d1\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"8"}),(0,r.jsx)(e.td,{children:"TJA1050"}),(0,r.jsx)(e.td,{children:"\u9ad8\u901f CAN \u6536\u53d1\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"9"}),(0,r.jsx)(e.td,{children:"TJA1053"}),(0,r.jsx)(e.td,{children:"\u5bb9\u9519 CAN \u6536\u53d1\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"10"}),(0,r.jsx)(e.td,{children:"TJA1054"}),(0,r.jsx)(e.td,{children:"\u5bb9\u9519 CAN \u6536\u53d1\u5668"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:"\u76ee\u524d\u5b9e\u9645\u5e38\u7528\u7684CAN\u63a7\u5236\u5668\u6709\u5982\u4e0b\u51e0\u79cd\u578b\u53f7\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u5e8f\u53f7"}),(0,r.jsx)(e.th,{children:"\u578b\u53f7"}),(0,r.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"SJA1000"}),(0,r.jsx)(e.td,{children:"\u72ec\u7acbCAN\u63a7\u5236\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"MCU\u5185\u90e8\u63a7\u5236\u5668"}),(0,r.jsx)(e.td,{children:"\u76ee\u524d\u5e02\u9762\u4e0a\u5982STM32\u7cfb\u5217\uff0cS32K\u7cfb\u5217\uff0cIMX6\u7cfb\u5217\u7b49\u7b49\u5f88\u591a\u5355\u7247\u673a\u5747\u5185\u90e8\u96c6\u6210\u4e86CAN\u63a7\u5236\u3002"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"1416-can\u62a5\u6587\u5e27",children:"14.1.6 CAN\u62a5\u6587\u5e27"}),"\n",(0,r.jsx)(e.h4,{id:"14161-can\u62a5\u6587\u683c\u5f0f",children:"14.1.6.1 CAN\u62a5\u6587\u683c\u5f0f"}),"\n",(0,r.jsx)(e.p,{children:"\u6807\u51c6 CAN \u7684\u6807\u5fd7\u7b26\u957f\u5ea6\u662f 11 \u4f4d\uff0c\u800c\u6269\u5c55\u683c\u5f0f CAN \u7684\u6807\u5fd7\u7b26\u957f\u5ea6\u53ef\u8fbe 29 \u4f4d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"CAN \u534f\u8bae\u7684 2.0A \u7248\u672c \u89c4\u5b9a CAN \u63a7\u5236\u5668\u5fc5\u987b\u6709\u4e00\u4e2a 11 \u4f4d\u7684\u6807\u5fd7\u7b26\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u540c\u65f6\uff0c\u5728 2.0B \u7248\u672c\u4e2d\u89c4\u5b9a\uff0cCAN \u63a7\u5236\u5668\u7684\u6807\u5fd7\u7b26\u957f\u5ea6\u53ef\u4ee5\u662f 11 \u4f4d\u6216 29 \u4f4d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u9075\u5faa CAN2.0B \u534f\u8bae\u7684 CAN \u63a7\u5236\u5668\u53ef\u4ee5\u53d1\u9001\u548c\u63a5\u6536 11 \u4f4d\u6807\u8bc6\u7b26\u7684\u6807\u51c6\u683c\u5f0f\u62a5\u6587\u6216 29 \u4f4d\u6807\u8bc6\u7b26\u7684\u6269\u5c55\u683c\u5f0f\u62a5\u6587\u3002"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u6807\u51c6\u5e27&\u6269\u5c55\u5e27\u5bf9\u6bd4"})}),(0,r.jsx)(e.th,{}),(0,r.jsx)(e.th,{})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u5e27\u683c\u5f0f"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u6807\u51c6\u5e27"})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u6269\u5c55\u5e27"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u89c4\u8303"}),(0,r.jsx)(e.td,{children:"CAN2.0A"}),(0,r.jsx)(e.td,{children:"CAN2.0B"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"CAN ID\uff08\u6807\u8bc6\u7b26\uff09\u957f\u5ea6"}),(0,r.jsx)(e.td,{children:"11 bits"}),(0,r.jsx)(e.td,{children:"29 bits"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"CAN ID\uff08\u6807\u8bc6\u7b26\uff09\u8303\u56f4"}),(0,r.jsx)(e.td,{children:"0x000~0x7FF"}),(0,r.jsx)(e.td,{children:"0x00000000~0x1FFFFFFF"})]})]})]}),"\n",(0,r.jsx)(e.h4,{id:"14162-can\u62a5\u6587\u5e27\u7c7b\u578b",children:"14.1.6.2 CAN\u62a5\u6587\u5e27\u7c7b\u578b"}),"\n",(0,r.jsx)(e.p,{children:"CAN\u62a5\u6587\u7c7b\u578b\u53c8\u5206\u59825\u79cd\u5e27\u7c7b\u578b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\u6570\u636e\u5e27\uff1a\u4e3b\u8981\u7528\u4e8e\u53d1\u9001\u65b9\u5411\u63a5\u6536\u65b9\u4f20\u8f93\u6570\u636e\u7684\u5e27\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u9065\u63a7\u5e27\uff1a\u4e3b\u8981\u7528\u4e8e\u63a5\u6536\u65b9\u5411\u5177\u6709\u76f8\u540cID\u7684\u53d1\u9001\u65b9\u8bf7\u6c42\u6570\u636e\u7684\u5e27\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u9519\u8bef\u5e27\uff1a\u4e3b\u8981\u7528\u4e8e\u5f53\u68c0\u6d4b\u51fa\u9519\u8bef\u65f6\u5411\u5176\u4ed6\u8282\u70b9\u901a\u77e5\u9519\u8bef\u7684\u5e27\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u8fc7\u8f7d\u5e27\uff1a\u4e3b\u8981\u7528\u4e8e\u63a5\u6536\u65b9\u901a\u77e5\u5176\u4ed6\u5c1a\u672a\u505a\u597d\u63a5\u6536\u51c6\u5907\u7684\u5e27\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u95f4\u9694\u5e27\uff1a\u4e3b\u8981\u7528\u4e8e\u5c06\u6570\u636e\u5e27\u53ca\u9065\u63a7\u5e27\u4e0e\u524d\u4e00\u5e27\u5206\u9694\u5f00\u6765\u7684\u5e27\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5176\u4e2d\u6570\u636e\u5e27\u662f\u4f7f\u7528\u6700\u591a\u7684\u5e27\u7c7b\u578b\uff0c\u8fd9\u91cc\u91cd\u70b9\u4ecb\u7ecd\u4ee5\u4e0b\u6570\u636e\u5e27\u3002\n\u6570\u636e\u5e27\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0002.jpeg",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u7531\u4e0a\u56fe\u6240\u793a\uff0c\u6570\u636e\u5e27\u5305\u62ec\uff1a\n\uff081\uff09\u5e27\u8d77\u59cb\u3002\u8868\u793a\u6570\u636e\u5e27\u5f00\u59cb\u7684\u6bb5\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\uff082\uff09\u4ef2\u88c1\u6bb5\u3002\u8868\u793a\u8be5\u5e27\u4f18\u5148\u7ea7\u7684\u6bb5\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\uff083\uff09\u63a7\u5236\u6bb5\u3002\u8868\u793a\u6570\u636e\u7684\u5b57\u8282\u6570\u53ca\u4fdd\u7559\u4f4d\u7684\u6bb5\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\uff084\uff09\u6570\u636e\u6bb5\u3002\u6570\u636e\u7684\u5185\u5bb9\uff0c\u4e00\u5e27\u53ef\u53d1\u90010~8\u4e2a\u5b57\u8282\u7684\u6570\u636e\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\uff085\uff09CRC\u6bb5\u3002\u68c0\u67e5\u5e27\u7684\u4f20\u8f93\u9519\u8bef\u7684\u6bb5\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\uff086\uff09ACK\u6bb5\u3002\u8868\u793a\u786e\u8ba4\u6b63\u5e38\u63a5\u6536\u7684\u6bb5\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\uff087\uff09\u5e27\u7ed3\u675f\u3002\u8868\u793a\u6570\u636e\u5e27\u7ed3\u675f\u7684\u6bb5\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5177\u4f53\u4ecb\u7ecd\u53ef\u4ee5\u67e5\u770b\u201dCAN2.0A\u201d\u3001\u201dCAN2.0B\u201d\u8be6\u7ec6\u4ecb\u7ecd\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u6211\u4eec\u4e3b\u8981\u5173\u6ce8\u6211\u4eec\u7f16\u7a0b\u6240\u9700\u8981\u5173\u6ce8\u7684\u51e0\u4e2a\u6bb5\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"ID: CAN\u62a5\u6587ID\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"IDE: \u4e3a0\u662f\u6807\u51c6\u5e27\uff0c\u4e3a1\u662f\u6269\u5c55\u5e27\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"RTR: \u4e3a0\u662f\u6570\u636e\u5e27\uff0c\u4e3a1\u662f\u8fdc\u7a0b\u5e27\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"DLC: CAN\u62a5\u6587\u6570\u636e\u957f\u5ea6\uff0c\u8303\u56f40~8\u5b57\u8282\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"Data\uff1a\u6570\u636e\uff0c0~8\u4e2a\u5b57\u8282\uff1b"}),"\n",(0,r.jsx)(e.h2,{id:"142-can\u7f16\u7a0b\u6846\u67b6\u521b\u5efa",children:"14.2 CAN\u7f16\u7a0b\u6846\u67b6\u521b\u5efa"}),"\n",(0,r.jsx)(e.p,{children:"\u5f53\u524d\u6211\u4eec\u6240\u5b66\u4e60\u7684\u662f\u5e94\u7528\u7f16\u7a0b\uff0c\u4e3a\u4e86\u4ee5\u540eCAN\u7f16\u7a0b\u6846\u67b6\u7684\u901a\u7528\u6027\u548c\u53ef\u79fb\u690d\u6027\uff0c\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u62bd\u8c61\u7684CAN\u5e94\u7528\u7f16\u7a0b\u6846\u67b6\uff0c\u6b64\u6846\u67b6\u53ef\u4ee5\u9002\u7528\u4e8e\u5355\u7247\u673a\u5e94\u7528\u7f16\u7a0b\uff0c\u4e5f\u53ef\u4ee5\u9002\u7528\u4e8elinux\u5e94\u7528\u7f16\u7a0b\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u56e0\u6b64\uff0c\u6839\u636eCAN\u603b\u7ebf\u7f16\u7a0b\u7684\u901a\u7528\u5c5e\u6027\uff0c\u6211\u4eec\u62bd\u8c61\u51fa\u5982\u4e0b\u5c5e\u6027\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u5c5e\u6027"}),(0,r.jsx)(e.th,{children:"\u5c5e\u6027\u63cf\u8ff0"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"CAN\u7aef\u53e3\u53f7"}),(0,r.jsx)(e.td,{children:"\u63cf\u8ff0CAN\u7aef\u53e3\uff0c\u5982CAN1,CAN2,CAN3,\u4e0e\u5177\u4f53\u786c\u4ef6\u5916\u8bbe\u6709\u5173\u3002"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"CAN\u6536\u53d1\u5668\u914d\u7f6e"}),(0,r.jsx)(e.td,{children:"\u63cf\u8ff0CAN\u6536\u53d1\u5668\u6a21\u5f0f\u8bbe\u7f6e\uff0c\u6536\u53d1\u5668\u6a21\u5f0f\u6709Normal\uff0cStanby\uff0cSleep\uff0cListenOnly\u7b49\u6a21\u5f0f\uff1b  \u672c\u7ae0\u8282\u6240\u4f7f\u7528\u7684\u6536\u53d1\u5668\u662f\u786c\u4ef6\u9ed8\u8ba4\u914d\u7f6e\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u914d\u7f6e\u3002"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"CAN\u63a7\u5236\u5668\u914d\u7f6e"}),(0,r.jsx)(e.td,{children:"\u63cf\u8ff0CAN\u6536\u53d1\u5668\u914d\u7f6e\uff0c\u5982CAN\u6ce2\u7279\u7387\u914d\u7f6e\uff0c\u91c7\u6837\u7387\u8bbe\u7f6e\uff0c\u8fc7\u6ee4\u5668\u8bbe\u7f6e\u7b49\uff1b"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"CAN\u4e2d\u65ad\u914d\u7f6e"}),(0,r.jsx)(e.td,{children:"\u63cf\u8ff0CAN\u4e2d\u65ad\u63a5\u6536\u51fd\u6570\u914d\u7f6e"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u8bfb\u53d6CAN\u62a5\u6587"}),(0,r.jsx)(e.td,{children:"\u63cf\u8ff0CAN\u8bfb\u53d6\u62a5\u6587\u5b9e\u73b0"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u53d1\u9001CAN\u62a5\u6587"}),(0,r.jsx)(e.td,{children:"\u63cf\u8ff0CAN\u53d1\u9001\u62a5\u6587\u5b9e\u73b0"}),(0,r.jsx)(e.td,{})]})]})]}),"\n",(0,r.jsx)(e.p,{children:"\u6839\u636e\u4e0a\u9762\u8868\u683c\u6240\u63cf\u8ff0\u7684\u5c5e\u6027\uff0c\u521b\u5efaCAN\u5e94\u7528\u7f16\u7a0b\u6846\u67b6\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"typedef struct _CAN_COMM_STRUCT\n{\n    /* CAN\u786c\u4ef6\u540d\u79f0 */\n    char name[10];\n    /* CAN\u7aef\u53e3\u53f7\uff0c\u88f8\u673a\u91cc\u4e3a\u7aef\u53e3\u53f7;linux\u5e94\u7528\u91cc\u4f5c\u4e3asocket\u5957\u63a5\u53e3 */\n    int  can_port;                                \n    /* CAN\u63a7\u5236\u5668\u914d\u7f6e\u51fd\u6570\uff0c\u8fd4\u56de\u7aef\u53e3\u53f7\u8d4b\u503c\u7ed9can_port */\n    int  (*can_set_controller)( void );                  \n    /* CAN\u63a5\u53e3\u4e2d\u65ad\u521b\u5efa\uff0c\u5728linux\u4e2d\u5bf9\u5e94\u521b\u5efa\u63a5\u6536\u7ebf\u7a0b */\n    void (*can_set_interrput)( int can_port , pCanInterrupt callback );             \n    /* CAN\u8bfb\u53d6\u62a5\u6587\u63a5\u53e3 */\n    void (*can_read)( int can_port , CanRxMsg* recv_msg);   \n    /* CAN\u53d1\u9001\u62a5\u6587\u63a5\u53e3*/\n    void (*can_write)( int can_port , CanTxMsg send_msg);   \n}CAN_COMM_STRUCT, *pCAN_COMM_STRUCT;\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u6b64\u6846\u67b6\u53ef\u4ee5\u7528\u7c7b\u6bd4\u5957\u7528\u5728\u5355\u7247\u673a\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5728linux socketcan\u5e94\u7528\u7f16\u7a0b\u4e0a\u3002"}),"\n",(0,r.jsx)(e.h2,{id:"143-stm32-can\u5e94\u7528\u7f16\u7a0b",children:"14.3 STM32 CAN\u5e94\u7528\u7f16\u7a0b"}),"\n",(0,r.jsx)(e.p,{children:"\u672c\u8282\u4e3b\u8981\u4f7f\u752814.2\u4e2d\u7684\u5e94\u7528\u7f16\u7a0b\u6846\u67b6\uff0c\u5728\u5355\u7247\u673a\u4e0a\u8bd5\u9a8c\u6846\u67b6\u7684\u53ef\u884c\u6027\uff0c\u4ee5\u4e00\u4e2a\u57fa\u672c\u7684\u63a5\u6536\u548c\u53d1\u9001\u7684\u6848\u4f8b\u6765\u505a\u8bb2\u89e3\uff1b"}),"\n",(0,r.jsx)(e.h3,{id:"1431-stm32-can\u63a5\u53e3\u7535\u8def",children:"14.3.1 STM32 CAN\u63a5\u53e3\u7535\u8def"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u4e3a\u672c\u7ae0STM32\u4f8b\u7a0b\u6240\u4f7f\u7528\u7684\u5f00\u53d1\u677fSTM32\u6700\u5c0f\u7cfb\u7edf\u548cCAN\u6536\u53d1\u5668\u63a5\u53e3\u7535\u8def\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0003.png",alt:"\u56fe14.3.1-1 STM32F407\u6700\u5c0f\u7cfb\u7edf"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0004.png",alt:"\u56fe14.3.1-1 TJA1050 CAN\u6536\u53d1\u5668\u63a5\u53e3\u7535\u8def"})}),"\n",(0,r.jsx)(e.h3,{id:"1432-stm32-can\u5e94\u7528\u7f16\u7a0b\u6b65\u9aa4",children:"14.3.2 STM32 CAN\u5e94\u7528\u7f16\u7a0b\u6b65\u9aa4"}),"\n",(0,r.jsx)(e.p,{children:"\u4e0b\u9762\u6211\u4eec\u6309\u7167CAN\u901a\u4fe1\u7684\u7f16\u7a0b\u6846\u67b6\u6765\u4e00\u6b65\u4e00\u6b65\u5b9e\u73b0\u57fa\u4e8eSTM32\u7684CAN\u5e94\u7528\u7f16\u7a0b\u3002"}),"\n",(0,r.jsx)(e.p,{children:"STM32 CAN\u5e94\u7528\u7f16\u7a0b\uff0c\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,r.jsxs)(e.h4,{id:"14321-\u51c6\u5907stm32\u5de5\u7a0b\u6a21\u7248",children:[(0,r.jsx)(e.strong,{children:"14.3.2.1"})," ",(0,r.jsx)(e.strong,{children:"\u51c6\u5907STM32\u5de5\u7a0b\u6a21\u7248"})]}),"\n",(0,r.jsx)(e.p,{children:"\u8bf7\u53c2\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c01_stm32f407_can\u201d\u4f8b\u7a0b\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u6240\u4f7f\u7528\u7684\u5f00\u53d1\u73af\u5883\u4e3a\uff1aMDK 5.24."}),"\n",(0,r.jsx)(e.p,{children:"\u6253\u5f00MDK\u5de5\u7a0b\u540e\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0005.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u4e0a\u56fe\u4e2d\u76ee\u5f55CMSIS, STM32F407_LIB\uff0cmain\u5747\u4e3aSTM32\u8fd0\u884c\u7684\u57fa\u7840\u6846\u67b6\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u76ee\u5f55app_can\u4e3aCAN\u5e94\u7528\u7f16\u7a0b\u6240\u9700\u8981\u7684\u6587\u4ef6\u3002"}),"\n",(0,r.jsxs)(e.h4,{id:"14322-\u7f16\u5199can\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570",children:[(0,r.jsx)(e.strong,{children:"14.3.2.2"})," ",(0,r.jsx)(e.strong,{children:"\u7f16\u5199CAN\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570"})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09\u5b9a\u4e49CAN\u7aef\u53e3\u53f7"})}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c01_stm32f407_can_addline\u201d\u4e2d\u201ccan_controller.h\u201d\u6587\u4ef6\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4e3b\u8981\u6839\u636eSTM32\u786c\u4ef6\u7684CAN\u6709\u591a\u8def\uff0c\u4f9d\u6b21\u5b9a\u4e49\u4e3aCAN_PORTCAN1, CAN_PORT_CAN2\u7b49\uff0c\u4ece\u201c14.3.1 STM32 CAN\u63a5\u53e3\u7535\u8def\u201d\u53ef\u77e5\u9053\uff0c\u5f53\u524d\u4f7f\u7528\u7684CAN1."}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"25 /* CAN\u7aef\u53e3\u53f7\u5b9a\u4e49*/\n26 enum\n27 {\n28     CAN_PORT_NONE = 0,\n29     CAN_PORT_CAN1,\n30     CAN_PORT_CAN2,\n31     CAN_PORT_MAX\n32 };\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09\u914d\u7f6eCAN\u63a7\u5236\u5668"})}),"\n",(0,r.jsx)(e.p,{children:"\u914d\u7f6eCAN\u63a7\u5236\u5668\u67093\u4e2a\u90e8\u5206\uff1aGPIO(CAN_TX,CAN_RX\u7ba1\u811a\uff09\u914d\u7f6e\uff0cCAN\u6ce2\u7279\u7387\u914d\u7f6e\uff0cCAN\u8fc7\u6ee4\u5668\u914d\u7f6e\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c01_stm32f407_can_addline\u201d\u4e2d\u201ccan_controller.c\u201d\u6587\u4ef6int CAN_Set_Controller( void )\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"A.GPIO(CAN_TX,CAN_RX\u7ba1\u811a\uff09\u914d\u7f6e"})}),"\n",(0,r.jsx)(e.p,{children:"\u914d\u7f6eGPIO\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"96     /*************************************************************/\n97     /*CAN\u76f8\u5173GPIO\u914d\u7f6e\uff0c\u6b64\u5904\u4e3a\uff1aCAN_TX, CAN_RX*/\n98\n99     /*\u4f7f\u80fdGPIO\u65f6\u949f*/\n100     RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOD, ENABLE);\n101     /*\u521d\u59cb\u5316\u7ba1\u811a\u914d\u7f6e*/\n102     GPIO_InitStructure.GPIO_Pin     = GPIO_Pin_0 ;\n103     GPIO_InitStructure.GPIO_Mode    = GPIO_Mode_AF;\n104     GPIO_InitStructure.GPIO_Speed   = GPIO_Speed_50MHz;\n105     GPIO_InitStructure.GPIO_OType   = GPIO_OType_PP;\n106     GPIO_InitStructure.GPIO_PuPd    = GPIO_PuPd_UP;\n107     GPIO_Init(GPIOD, &GPIO_InitStructure);\n108\n109     GPIO_InitStructure.GPIO_Pin     = GPIO_Pin_1;\n110     GPIO_InitStructure.GPIO_Mode    = GPIO_Mode_AF;\n111     GPIO_InitStructure.GPIO_Speed   = GPIO_Speed_50MHz;\n112     GPIO_InitStructure.GPIO_OType   = GPIO_OType_PP;\n113     GPIO_InitStructure.GPIO_PuPd    = GPIO_PuPd_UP;\n114     GPIO_Init(GPIOD, &GPIO_InitStructure);\n115     /*\u5c06GPIO\u8bbe\u7f6e\u4e3aCAN\u590d\u7528\u6a21\u5f0f*/\n116     GPIO_PinAFConfig(GPIOD, GPIO_PinSource0, GPIO_AF_CAN1);\n117     GPIO_PinAFConfig(GPIOD, GPIO_PinSource1, GPIO_AF_CAN1);\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"B.\u914d\u7f6e\u6ce2\u7279\u7387\uff0c\u5de5\u4f5c\u6a21\u5f0f"})}),"\n",(0,r.jsx)(e.p,{children:"\u6309\u7167\u5982\u4e0b\u4ee3\u7801\uff0c\u4f7f\u80fdCAN\u5916\u8bbe\uff0c\u8bbe\u7f6eCAN\u5de5\u4f5c\u6a21\u5f0f\u4e3aNormal\uff0c\u8bbe\u7f6e\u6ce2\u7279\u7387\u4e3a500kbps\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"119     /*************************************************************/\n120     /*CAN\u63a7\u5236\u5668\u76f8\u5173\u914d\u7f6e\uff0c\u6b64\u5904\u4e3a\u6ce2\u7279\u7387\uff0c\u91c7\u6837\u7387\u7b49*/\n121\n122     /* \u4f7f\u80fdCAN\u65f6\u949f */\n123     RCC_APB1PeriphClockCmd(RCC_APB1Periph_CAN1, ENABLE);\n124\n125     /* \u521d\u59cb\u5316CAN\u63a7\u5236\u5668\u5de5\u4f5c\u6a21\u5f0f*/\n126     CAN_DeInit(CAN1);\n127     CAN_StructInit(&CAN_InitStructure);\n128     CAN_InitStructure.CAN_TTCM = DISABLE;\n129     CAN_InitStructure.CAN_ABOM = DISABLE;\n130     CAN_InitStructure.CAN_AWUM = DISABLE;\n131     CAN_InitStructure.CAN_NART = DISABLE;\n132     CAN_InitStructure.CAN_RFLM = DISABLE;\n133     CAN_InitStructure.CAN_TXFP = DISABLE;\n134     CAN_InitStructure.CAN_Mode = CAN_Mode_Normal;//CAN\u5de5\u4f5c\u6a21\u5f0f\n135\n136     /* \u521d\u59cb\u5316CAN\u6ce2\u7279\u7387 */\n137     CAN_Baud_Process(500,&CAN_InitStructure);\n138     CAN_Init(CAN1, &CAN_InitStructure);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u5176\u4e2d\u914d\u7f6e\u6ce2\u7279\u7387\u7684\u51fd\u6570\u662f\u4e00\u4e2a\u81ea\u5b9a\u4e49\u51fd\u6570\uff0c\u8fd9\u91cc\u53ef\u4ee5\u4e0d\u4e86\u89e3\uff0c\u53ea\u9700\u8981\u77e5\u9053\u662f\u914d\u7f6e\u6ce2\u7279\u7387\u5373\u53ef\uff0c\u5982\u679c\u9700\u8981\u4f7f\u7528\u672c\u7ae0\u4ee3\u7801\uff0c\u53ef\u4ee5\u67e5\u770b\u5177\u4f53\u7684\u6e90\u7801\u5de5\u7a0b\u3002"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"C."})," ",(0,r.jsx)(e.strong,{children:"\u914d\u7f6eCAN\u8fc7\u6ee4\u5668"})]}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u4e0b\u4ee3\u7801\u4e3a\u914d\u7f6e\u8fc7\u6ee4\u5668\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"141     /*************************************************************/\n142     /* \u521d\u59cb\u5316CAN\u8fc7\u6ee4\u5668 */\n143     CAN_FilterInitStructure.CAN_FilterNumber = 0;                       /* CAN1\u6ee4\u6ce2\u5668\u53f7\u4ece0\u523013 */\n144     CAN_FilterInitStructure.CAN_FilterMode = CAN_FilterMode_IdMask;     /* \u6ee4\u6ce2\u5c4f\u853d\u6a21\u5f0f */\n145     CAN_FilterInitStructure.CAN_FilterScale = CAN_FilterScale_32bit;\n146     CAN_FilterInitStructure.CAN_FilterIdHigh = 0x0000;\n147     CAN_FilterInitStructure.CAN_FilterIdLow = 0x0000;\n148     CAN_FilterInitStructure.CAN_FilterMaskIdHigh = 0x0000;      /* \u4e0d\u5c4f\u853d\u4efb\u4f55ID */\n149     CAN_FilterInitStructure.CAN_FilterMaskIdLow = 0x0000;           /* \u4e0d\u5c4f\u853d\u4efb\u4f55ID */\n150     CAN_FilterInitStructure.CAN_FilterFIFOAssignment = 0;\n151\n152     CAN_FilterInitStructure.CAN_FilterActivation = ENABLE;\n153     CAN_FilterInit(&CAN_FilterInitStructure);\n154\n155     /*************************************************************/\n156     /* \u8bbe\u7f6e\u5b8cCAN\u540e\uff0c\u8fd4\u56de\u5f53\u524d\u8bbe\u7f6e\u7684CAN\u7684\u7aef\u53e3\u53f7\uff0c\u6b64\u5904\u4e3b\u8981\u7c7b\u6bd4linux socketcan\u4e2d\u7684\u5957\u63a5\u53e3 */\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u6b64\u5904\u6211\u4eec\u8bbe\u7f6e\u8fc7\u6ee4\u5668\u4e0d\u5c4f\u853d\u4efb\u4f55\u62a5\u6587ID\uff0c\u8fd9\u91cc\u53ea\u662f\u4e86\u89e3\u5355\u7247\u673a\u4e0b\u7684\u4e00\u4e9b\u8fc7\u7a0b\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u914d\u7f6eCAN\u63a5\u6536\u4e2d\u65ad"})}),"\n",(0,r.jsx)(e.p,{children:"CAN\u603b\u7ebf\u652f\u6301\u53d1\u9001\u4e2d\u65ad\u548c\u63a5\u6536\u4e2d\u65ad\uff0c\u6b64\u5904\u4ec5\u4ec5\u4f7f\u7528\u4e86\u63a5\u6536\u4e2d\u65ad\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c01_stm32f407_can_addline\u201d\u4e2d\u201ccan_controller.c\u201d\u6587\u4ef6void CAN_Set_Interrupt(int can_port, pCanInterrupt callback)\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:"CAN\u4e2d\u65ad\u914d\u7f6e\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"163 /**********************************************************************\n164 * \u51fd\u6570\u540d\u79f0\uff1a void CAN_Set_Interrupt(int can_port,  pCanInterrupt callback)\n165 * \u529f\u80fd\u63cf\u8ff0\uff1a \u4f7f\u80fdCAN\u4e2d\u65ad\u5904\u7406\uff0c\u5e76\u4f20\u5165\u5e94\u7528\u7684\u7684\u56de\u8c03\u51fd\u6570\uff0c\u56de\u8c03\u51fd\u6570\u4e3b\u8981\u5904\u7406\u5e94\u7528\u5c42\u7684\u529f\u80fd\n166 * \u8f93\u5165\u53c2\u6570\uff1a can_port,\u7aef\u53e3\u53f7\n167 *            callback\uff1a \u4e2d\u65ad\u5177\u4f53\u5904\u7406\u5e94\u7528\u529f\u80fd\u7684\u56de\u8c03\u51fd\u6570\n168 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n169 * \u8fd4 \u56de \u503c\uff1a \u65e0\n170 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n171 * -----------------------------------------------\n172 * 2020/05/13         V1.0             bert            \u521b\u5efa\n173 ***********************************************************************/\n174 void CAN_Set_Interrupt(int can_port,  pCanInterrupt callback)\n175 {\n176     NVIC_InitTypeDef NVIC_InitStructure;\n177\n178     /* \u6839\u636eCAN\u7aef\u53e3\u53f7\u914d\u7f6e\u4e2d\u65ad */\n179     switch( can_port )\n180     {\n181         case CAN_PORT_CAN1:\n182         {\n183             /* \u521d\u59cb\u5316\u56de\u8c03\u63a5\u53e3\u51fd\u6570 */\n184             if ( NULL != callback )\n185             {\n186                 g_pCanInterrupt = callback;\n187             }\n188\n189             /* \u4f7f\u7528CAN0_RX\u4e2d\u65ad\uff0c\u5728linux socket can\u4e2d\u7c7b\u4f3c\u521b\u5efa\u63a5\u6536\u7ebf\u7a0b */\n190             NVIC_InitStructure.NVIC_IRQChannel = CAN1_RX0_IRQn;\n191             NVIC_PriorityGroupConfig(NVIC_PriorityGroup_4);\n192             NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;\n193             NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;\n194             NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;\n195             NVIC_Init(&NVIC_InitStructure);\n196             CAN_ITConfig(CAN1, CAN_IT_FMP0, ENABLE);\n197         }\n198         break;\n199\n200         default:\n201             break;\n202\n203     }\n204     return ;\n205 }\n"})}),"\n",(0,r.jsx)(e.p,{children:"CAN\u63a5\u6536\u4e2d\u65ad\u51fd\u6570\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"275 /**********************************************************************\n276 * \u51fd\u6570\u540d\u79f0\uff1a void CAN1_RX0_IRQHandler(void)\n277 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u63a5\u6536\u4e2d\u65ad\u51fd\u6570\n278 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n279 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n280 * \u8fd4 \u56de \u503c\uff1a \u65e0\n281 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n282 * -----------------------------------------------\n283 * 2020/05/13         V1.0             bert            \u521b\u5efa\n284 ***********************************************************************/\n285 void CAN1_RX0_IRQHandler(void)\n286 {\n287     /* \u5982\u679c\u56de\u8c03\u51fd\u6570\u5b58\u5728\uff0c\u5219\u6267\u884c\u56de\u8c03\u51fd\u6570 */\n288     if( g_pCanInterrupt != NULL)\n289     {\n290         g_pCanInterrupt();\n291     }\n292\n293     /* \u6e05\u9664\u6302\u8d77\u4e2d\u65ad */\n294     CAN_ClearITPendingBit(CAN1,CAN_IT_FMP0);\n295 }\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u6b64\u5904CAN\u4e2d\u65ad\u901a\u8fc7\u56de\u8c03\u51fd\u6570g_pCanInterrupt()\u51fd\u6570\u5c06\u5e94\u7528\u5c42\u9700\u8981\u7684\u4ee3\u7801\u5206\u5c42\u5230\u5e94\u7528\u5c42\uff0c\u6b64\u5904\u4e3a\u9a71\u52a8\u90e8\u5206\u901a\u7528\u63a5\u53e3\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u5f53CAN\u63a5\u6536\u4e2d\u65ad\u4ea7\u751f\uff0c\u901a\u8fc7CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570\u4eceFIFO\u4e2d\u8bfb\u53d6\u5df2\u7ecf\u63a5\u6536\u5230\u7684CAN\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c01_stm32f407_can_addline\u201d\u4e2d\u201ccan_controller.c\u201d\u6587\u4ef6void CAN_Read(int can_port, CanRxMsg* recv_msg)\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:"CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"208 /**********************************************************************\n209 * \u51fd\u6570\u540d\u79f0\uff1a void CAN_Read(int can_port, CanRxMsg* recv_msg)\n210 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u8bfb\u53d6\u63a5\u6536\u5bc4\u5b58\u5668\uff0c\u53d6\u51fa\u63a5\u6536\u5230\u7684\u62a5\u6587\n211 * \u8f93\u5165\u53c2\u6570\uff1a can_port,\u7aef\u53e3\u53f7\n212 * \u8f93\u51fa\u53c2\u6570\uff1a recv_msg\uff1a\u63a5\u6536\u62a5\u6587\n213 * \u8fd4 \u56de \u503c\uff1a \u65e0\n214 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n215 * -----------------------------------------------\n216 * 2020/05/13         V1.0             bert            \u521b\u5efa\n217 ***********************************************************************/\n218 void CAN_Read(int can_port, CanRxMsg* recv_msg)\n219 {\n220     switch( can_port )\n221     {\n222         case CAN_PORT_CAN1:\n223         {\n224             /* \u4eceFIFO\u4e2d\u8bfb\u53d6CAN\u62a5\u6587 */\n225             CAN_Receive(CAN1,CAN_FIFO0, recv_msg);\n226         }\n227         break;\n228\n229         default:\n230             break;\n231     }\n232     return ;\n233 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff085\uff09CAN\u62a5\u6587\u53d1\u9001\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u5f53\u9700\u8981\u53d1\u9001CAN\u62a5\u6587\u65f6\uff0c\u901a\u8fc7\u5411CAN\u53d1\u9001\u90ae\u7bb1\u586b\u5145\u6570\u636e\uff0c\u542f\u52a8\u53d1\u9001\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c01_stm32f407_can_addline\u201d\u4e2d\u201ccan_controller.c\u201d\u6587\u4ef6void CAN_Write(int can_port, CanTxMsg send_msg)\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:"CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"235 /**********************************************************************\n236 * \u51fd\u6570\u540d\u79f0\uff1a void CAN_Write(int can_port, CanTxMsg send_msg)\n237 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u62a5\u6587\u53d1\u9001\u63a5\u53e3\uff0c\u8c03\u7528\u53d1\u9001\u5bc4\u5b58\u5668\u53d1\u9001\u62a5\u6587\n238 * \u8f93\u5165\u53c2\u6570\uff1a can_port,\u7aef\u53e3\u53f7\n239 * \u8f93\u51fa\u53c2\u6570\uff1a send_msg\uff1a\u53d1\u9001\u62a5\u6587\n240 * \u8fd4 \u56de \u503c\uff1a \u65e0\n241 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n242 * -----------------------------------------------\n243 * 2020/05/13         V1.0             bert            \u521b\u5efa\n244 ***********************************************************************/\n245 void CAN_Write(int can_port, CanTxMsg send_msg)\n246 {\n247     unsigned char i;\n248     uint8_t transmit_mailbox = 0;\n249     CanTxMsg TxMessage;\n250\n251     switch( can_port )\n252     {\n253         case CAN_PORT_CAN1:\n254         {\n255             TxMessage.StdId = send_msg.StdId;     // \u6807\u51c6\u6807\u8bc6\u7b26\u4e3a0x000~0x7FF\n256             TxMessage.ExtId = 0x0000;             // \u6269\u5c55\u6807\u8bc6\u7b260x0000\n257             TxMessage.IDE   = CAN_ID_STD;         // \u4f7f\u7528\u6807\u51c6\u6807\u8bc6\u7b26\n258             TxMessage.RTR   = CAN_RTR_DATA;       // \u8bbe\u7f6e\u4e3a\u6570\u636e\u5e27\n259             TxMessage.DLC   = send_msg.DLC;       // \u6570\u636e\u957f\u5ea6, can\u62a5\u6587\u89c4\u5b9a\u6700\u5927\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u5b57\u8282\n260\n261             for(i=0; i<TxMessage.DLC; i++)\n262             {\n263                 TxMessage.Data[i] = send_msg.Data[i];\n264             }\n265             transmit_mailbox = CAN_Transmit(CAN1,&TxMessage);  /* \u8fd4\u56de\u8fd9\u4e2a\u4fe1\u606f\u8bf7\u6c42\u53d1\u9001\u7684\u90ae\u7bb1\u53f70,1,2\u6216\u6ca1\u6709\u90ae\u7bb1\u7533\u8bf7\u53d1\u9001no_box */\n266         }\n267         break;\n268\n269         default:\n270             break;\n271     }\n272     return ;\n273 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff086\uff09CAN\u62bd\u8c61\u7ed3\u6784\u4f53\u6846\u67b6\u521d\u59cb\u5316"})}),"\n",(0,r.jsx)(e.p,{children:"\u5b9a\u4e49\u4e00\u4e2acan1\u901a\u4fe1\u7ed3\u6784\u5b9e\u4f8bCAN_COMM_STRUCT can1_controller\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u4f7f\u7528\uff081\uff09~\uff085\uff09\u6b65\u9aa4\u5b9e\u73b0\u7684\u51fd\u6570\uff0c\u521d\u59cb\u5316can1_controller\uff0c\u6784\u6210\u4e0e\u5e94\u7528\u5c42\u5173\u8054\u7684\u4e00\u4e2a\u8fde\u63a5\u70b9\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'298 /**********************************************************************\n299 * \u540d\u79f0\uff1a     can1_controller\n300 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN1\u7ed3\u6784\u4f53\u521d\u59cb\u5316\n301 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n302 * -----------------------------------------------\n303 * 2020/05/13         V1.0             bert            \u521b\u5efa\n304 ***********************************************************************/\n305 CAN_COMM_STRUCT can1_controller = {\n306     .name                   = "can0",\n307     .can_port               = CAN_PORT_CAN1,\n308     .can_set_controller     = CAN_Set_Controller,\n309     .can_set_interrput      = CAN_Set_Interrupt,\n310     .can_read               = CAN_Read,\n311     .can_write              = CAN_Write,\n312 };\n'})}),"\n",(0,r.jsxs)(e.h4,{id:"14323-\u7f16\u5199can\u5e94\u7528\u5c42\u4ee3\u7801",children:[(0,r.jsx)(e.strong,{children:"14.3.2.3"})," ",(0,r.jsx)(e.strong,{children:"\u7f16\u5199CAN\u5e94\u7528\u5c42\u4ee3\u7801"})]}),"\n",(0,r.jsx)(e.p,{children:"\u6839\u636e14.3.2.2 \u5df2\u7ecf\u5c06\u5177\u4f53\u7684CAN\u786c\u4ef6\u64cd\u4f5c\u5df2\u7ecf\u5b9e\u73b0\uff0c\u5e76\u4e14\u5df2\u7ecf\u62bd\u8c61\u5b9e\u4f8b\u5316\u4e86CAN\u7f16\u7a0b\u6846\u67b6\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4f46\u662f\u6211\u4eec\u73b0\u5728\u8fd8\u6ca1\u5173\u8054\u5230\u5e94\u7528\u5c42\uff0c\u5e94\u7528\u5c42\u5e76\u4e0d\u77e5\u9053\u8c03\u7528\u54ea\u4e2a\u63a5\u53e3\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09CAN\u5e94\u7528\u5c42\u6ce8\u518c\u5b9e\u4f8b"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u5e94\u7528\u5c42\u7f16\u5199\u4e00\u4e2a\u901a\u7528\u7684\u5b9e\u4f8b\u5316\u6ce8\u518c\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c01_stm32f407_can_addline\u201d\u4e2d\u201capp_can.c\u201d\u6587\u4ef6int register_can_controller(const pCAN_COMM_STRUCT p_can_controller)\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"62 /**********************************************************************\n63 * \u51fd\u6570\u540d\u79f0\uff1a int register_can_controller(const pCAN_COMM_STRUCT p_can_controller)\n64 * \u529f\u80fd\u63cf\u8ff0\uff1a \u5e94\u7528\u5c42\u8fdb\u884cCAN1\u7ed3\u6784\u4f53\u6ce8\u518c\n65 * \u8f93\u5165\u53c2\u6570\uff1a p_can_controller\uff0cCAN\u63a7\u5236\u5668\u62bd\u8c61\u7ed3\u6784\u4f53\n66 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n67 * \u8fd4 \u56de \u503c\uff1a \u65e0\n68 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n69 * -----------------------------------------------\n70 * 2020/05/13         V1.0             bert            \u521b\u5efa\n71 ***********************************************************************/\n72 int register_can_controller(const pCAN_COMM_STRUCT p_can_controller)\n73 {\n74     /* \u5224\u65ad\u4f20\u5165\u7684p_can_controller\u4e3a\u975e\u7a7a\uff0c\u76ee\u7684\u662f\u786e\u8ba4\u8fd9\u4e2a\u7ed3\u6784\u4f53\u662f\u5b9e\u4f53*/\n75     if( p_can_controller != NULL )\n76     {\n77         /* \u5c06\u4f20\u5165\u7684\u53c2\u6570p_can_controller\u8d4b\u503c\u7ed9\u5e94\u7528\u5c42\u7ed3\u6784\u4f53gCAN_COMM_STRUCT */\n78\n79         /*\u7aef\u53e3\u53f7\uff0c\u7c7b\u6bd4socketcan\u5957\u63a5\u53e3*/\n80         gCAN_COMM_STRUCT.can_port              = p_can_controller->can_port;\n81         /*CAN\u63a7\u5236\u5668\u914d\u7f6e\u51fd\u6570*/\n82         gCAN_COMM_STRUCT.can_set_controller    = p_can_controller->can_set_controller;\n83         /*CAN\u4e2d\u65ad\u914d\u7f6e*/\n84         gCAN_COMM_STRUCT.can_set_interrput     = p_can_controller->can_set_interrput;\n85         /*CAN\u62a5\u6587\u8bfb\u51fd\u6570*/\n86         gCAN_COMM_STRUCT.can_read              = p_can_controller->can_read;\n87         /*CAN\u62a5\u6587\u53d1\u9001\u51fd\u6570*/\n88         gCAN_COMM_STRUCT.can_write             = p_can_controller->can_write;\n89         return 1;\n90     }\n91      return 0;\n92 }\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u901a\u8fc7\u8c03\u7528register_can_controller( &can1_controller );\u5c06\u5b9e\u4f8bcan1_controller\u6ce8\u518c\u7ed9\u5e94\u7528\u76844 static CAN_COMM_STRUCT gCAN_COMM_STRUCT;"}),"\n",(0,r.jsx)(e.p,{children:"\u4e4b\u540e\u5e94\u7528\u5c42\u53ea\u9700\u8981\u8c03\u7528\u5e94\u7528\u5c42\u81ea\u5df1\u7684gCAN_COMM_STRUCT\u5b9e\u4f8b\u5373\u53ef\u64cd\u4f5cCAN\u901a\u4fe1\u529f\u80fd\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"315 /**********************************************************************\n316 * \u51fd\u6570\u540d\u79f0\uff1a void CAN1_contoller_add(void)\n317 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u7ed3\u6784\u4f53\u6ce8\u518c\u63a5\u53e3\uff0c\u5e94\u7528\u5c42\u5728\u4f7f\u7528can1_controller\u524d\u8c03\u7528\n318 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n319 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n320 * \u8fd4 \u56de \u503c\uff1a \u65e0\n321 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n322 * -----------------------------------------------\n323 * 2020/05/13         V1.0             bert            \u521b\u5efa\n324 ***********************************************************************/\n325 void CAN1_contoller_add(void)\n326 {\n327     /*\u5c06can1_controller\u4f20\u9012\u7ed9\u5e94\u7528\u5c42*/\n328     register_can_controller( &can1_controller );\n329 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316"})}),"\n",(0,r.jsx)(e.p,{children:"CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316\u4ee3\u7801\u5982\u4e0b\uff1b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"94 /**********************************************************************\n95 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_init(void)\n96 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316\n97 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n98 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n99 * \u8fd4 \u56de \u503c\uff1a \u65e0\n100 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n101 * -----------------------------------------------\n102 * 2020/05/13         V1.0             bert            \u521b\u5efa\n103 ***********************************************************************/\n104 void app_can_init(void)\n105 {\n106     /**\n107     * \u5e94\u7528\u5c42\u8fdb\u884cCAN1\u7ed3\u6784\u4f53\u6ce8\u518c\n108     */\n109     CAN1_contoller_add();\n110\n111     /*\n112     *\u8c03\u7528can_set_controller\u8fdb\u884cCAN\u63a7\u5236\u5668\u914d\u7f6e\uff0c\n113     *\u8fd4\u56decan_port\uff0c\u7c7b\u6bd4linux socketcan\u4e2d\u7684\u5957\u63a5\u53e3\uff0c\u5355\u7247\u673a\u4f8b\u7a0b\u4e2d\u4f5c\u4e3a\u81ea\u5b9a\u4e49CAN\u901a\u9053\n114     */\n115     gCAN_COMM_STRUCT.can_port = gCAN_COMM_STRUCT.can_set_controller();\n116     /**\n117     * \u8c03\u7528can_set_interrput\u914d\u7f6eCAN\u63a5\u6536\u4e2d\u65ad\uff0c\u7c7b\u6bd4socketcan\u4e2d\u7684\u63a5\u6536\u7ebf\u7a0b\n118     */\n119     gCAN_COMM_STRUCT.can_set_interrput( gCAN_COMM_STRUCT.can_port, CAN_RX_IRQHandler_Callback );\n120 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u8bbe\u8ba1\u4e00\u4e2a\u7b80\u5355\u7684\u5468\u671f\u53d1\u9001\u62a5\u6587\u529f\u80fd"})}),"\n",(0,r.jsx)(e.p,{children:"CAN\u5468\u671f\u53d1\u9001\u62a5\u6587\u7684\u529f\u80fd\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"123 /**********************************************************************\n124 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_tx_test(void)\n125 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u62a5\u6587\u53d1\u9001\u51fd\u6570\uff0c\u7528\u4e8e\u6d4b\u8bd5\u5468\u671f\u53d1\u9001\u62a5\u6587\n126 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n127 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n128 * \u8fd4 \u56de \u503c\uff1a \u65e0\n129 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n130 * -----------------------------------------------\n131 * 2020/05/13         V1.0             bert            \u521b\u5efa\n132 ***********************************************************************/\n133 void app_can_tx_test(void)\n134 {\n135     // \u4ee510ms\u4e3a\u57fa\u51c6\uff0c\u8fd0\u884cCAN\u6d4b\u8bd5\u7a0b\u5e8f\n136\n137     unsigned char i=0;\n138\n139     /* \u53d1\u9001\u62a5\u6587\u5b9a\u4e49 */\n140     CanTxMsg TxMessage;\n141\n142     /* \u53d1\u9001\u62a5\u6587\u4e2d\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4f5c\u4e3a\u8ba1\u6570\u5668 */\n143     static unsigned char tx_counter = 0;\n144\n145     /* \u4ee510ms\u4e3a\u57fa\u51c6\uff0c\u901a\u8fc7timer\u8ba1\u6570\u5668\u8bbe\u7f6e\u8be5\u5904\u7406\u51fd\u6570\u540e\u9762\u8fd0\u884c\u4ee3\u7801\u7684\u5468\u671f\u4e3a1\u79d2\u949f*/\n146     static unsigned int timer =0;\n147     if(timer++>100)\n148     {\n149         timer = 0;\n150     }\n151     else\n152     {\n153         return ;\n154     }\n155\n156     /* \u53d1\u9001\u62a5\u6587\u62a5\u6587\u6570\u636e\u586b\u5145\uff0c\u6b64\u62a5\u6587\u5468\u671f\u662f1\u79d2 */\n157     TxMessage.StdId = TX_CAN_ID;          /* \u6807\u51c6\u6807\u8bc6\u7b26\u4e3a0x000~0x7FF */\n158     TxMessage.ExtId = 0x0000;             /* \u6269\u5c55\u6807\u8bc6\u7b260x0000 */\n159     TxMessage.IDE   = CAN_ID_STD;         /* \u4f7f\u7528\u6807\u51c6\u6807\u8bc6\u7b26 */\n160     TxMessage.RTR   = CAN_RTR_DATA;       /* \u8bbe\u7f6e\u4e3a\u6570\u636e\u5e27  */\n161     TxMessage.DLC   = 8;                  /* \u6570\u636e\u957f\u5ea6, can\u62a5\u6587\u89c4\u5b9a\u6700\u5927\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u5b57\u8282 */\n162\n163     /* \u586b\u5145\u6570\u636e\uff0c\u6b64\u5904\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u5e94\u7528\u586b\u5145 */\n164     TxMessage.Data[0] = tx_counter++;       /* \u7528\u6765\u8bc6\u522b\u62a5\u6587\u53d1\u9001\u8ba1\u6570\u5668 */\n165     for(i=1; i<TxMessage.DLC; i++)\n166     {\n167         TxMessage.Data[i] = i;\n168     }\n169\n170     /*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587 */\n171     gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n172\n173 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09\u8bbe\u8ba1\u4e00\u4e2a\u7b80\u5355\u7684\u63a5\u6536\u62a5\u6587\u529f\u80fd"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"220 /**********************************************************************\n221 * \u51fd\u6570\u540d\u79f0\uff1a void CAN_RX_IRQHandler_Callback(void)\n222 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN1\u63a5\u6536\u4e2d\u65ad\u51fd\u6570\uff1b\u5728linux\u4e2d\u53ef\u4ee5\u7c7b\u6bd4\u7528\u7ebf\u7a0b\uff0c\u6216\u5b9a\u65f6\u5668\u53bb\u8bfbCAN\u6570\u636e\n223 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n224 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n225 * \u8fd4 \u56de \u503c\uff1a \u65e0\n226 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n227 * -----------------------------------------------\n228 * 2020/05/13         V1.0             bert            \u521b\u5efa\n229 ***********************************************************************/\n230 void CAN_RX_IRQHandler_Callback(void)\n231 {\n232     /* \u63a5\u6536\u62a5\u6587\u5b9a\u4e49 */\n233     CanRxMsg RxMessage;\n234\n235     /* \u63a5\u6536\u62a5\u6587\u6e05\u96f6 */\n236     memset( &RxMessage, 0, sizeof(CanRxMsg) );\n237\n238     /* \u901a\u8fc7can_read\u63a5\u53e3\u8bfb\u53d6\u5bc4\u5b58\u5668\u5df2\u7ecf\u63a5\u6536\u5230\u7684\u62a5\u6587 */\n239     gCAN_COMM_STRUCT.can_read(gCAN_COMM_STRUCT.can_port, &RxMessage);\n240\n241     /* \u5c06\u8bfb\u53d6\u5230\u7684CAN\u62a5\u6587\u5b58\u62f7\u8d1d\u5230\u5168\u5c40\u62a5\u6587\u7ed3\u6784\u4f53g_CAN1_Rx_Message */\n242     memcpy(&g_CAN1_Rx_Message, &RxMessage, sizeof( CanRxMsg ) );\n243\n244     /* \u8bbe\u7f6e\u5f53\u524d\u63a5\u6536\u5b8c\u6210\u6807\u5fd7\uff0c\u5224\u65ad\u5f53\u524d\u63a5\u6536\u62a5\u6587ID\u4e3aRX_CAN_ID\uff0c\u5219\u8bbe\u7f6eg_CAN1_Rx_Flag=1*/\n245     if( g_CAN1_Rx_Message.StdId == RX_CAN_ID )\n246     {\n247         g_CAN1_Rx_Flag = 1;\n248     }\n249 }\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"176 /**********************************************************************\n177 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_rx_test(void)\n178 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u63a5\u6536\u62a5\u6587\u5904\u7406\u51fd\u6570\uff0c\u7528\u4e8e\u5904\u7406\u4e2d\u65ad\u51fd\u6570\u4e2d\u63a5\u6536\u7684\u62a5\u6587\n179 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n180 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n181 * \u8fd4 \u56de \u503c\uff1a \u65e0\n182 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n183 * -----------------------------------------------\n184 * 2020/05/13         V1.0             bert            \u521b\u5efa\n185 ***********************************************************************/\n186 void app_can_rx_test(void)\n187 {\n188     unsigned char i=0;\n189\n190     /* \u53d1\u9001\u62a5\u6587\u5b9a\u4e49 */\n191     CanTxMsg TxMessage;\n192\n193     /* \u53d1\u9001\u62a5\u6587\u4e2d\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4f5c\u4e3a\u8ba1\u6570\u5668 */\n194     static unsigned char rx_counter = 0;\n195\n196\n197     if( g_CAN1_Rx_Flag == 1)\n198     {\n199         g_CAN1_Rx_Flag = 0;\n200\n201         /* \u53d1\u9001\u62a5\u6587\u62a5\u6587\u6570\u636e\u586b\u5145\uff0c\u6b64\u62a5\u6587\u5468\u671f\u662f1\u79d2 */\n202         TxMessage.StdId = RX_TO_TX_CAN_ID;    /* \u6807\u51c6\u6807\u8bc6\u7b26\u4e3a0x000~0x7FF */\n203         TxMessage.ExtId = 0x0000;             /* \u6269\u5c55\u6807\u8bc6\u7b260x0000 */\n204         TxMessage.IDE   = CAN_ID_STD;         /* \u4f7f\u7528\u6807\u51c6\u6807\u8bc6\u7b26 */\n205         TxMessage.RTR   = CAN_RTR_DATA;       /* \u8bbe\u7f6e\u4e3a\u6570\u636e\u5e27  */\n206         TxMessage.DLC   = 8;                  /* \u6570\u636e\u957f\u5ea6, can\u62a5\u6587\u89c4\u5b9a\u6700\u5927\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u5b57\u8282 */\n207\n208         /* \u586b\u5145\u6570\u636e\uff0c\u6b64\u5904\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u5e94\u7528\u586b\u5145 */\n209         TxMessage.Data[0] = rx_counter++;      /* \u7528\u6765\u8bc6\u522b\u62a5\u6587\u53d1\u9001\u8ba1\u6570\u5668 */\n210         for(i=1; i<TxMessage.DLC; i++)\n211         {\n212             TxMessage.Data[i] = g_CAN1_Rx_Message.Data[i];\n213         }\n214\n215         /*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587 */\n216         gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n217     }\n218 }\n"})}),"\n",(0,r.jsx)(e.h4,{id:"14324-stm32-can\u6848\u4f8b\u6d4b\u8bd5",children:(0,r.jsx)(e.strong,{children:"14.3.2.4 STM32 CAN\u6848\u4f8b\u6d4b\u8bd5"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u524d\u9762\u51e0\u4e2a\u7ae0\u8282\u5c06\u4ee3\u7801\u7f16\u5199\u5b8c\u6210\u4e4b\u540e\uff0c\u6211\u4eec\u505a\u4e2a\u6d4b\u8bd5\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u6d4b\u8bd5\u5de5\u5177\u4f7f\u7528\u7684\u662f\uff1a\u82f1\u7279\u84d3\u65af\u7684Valuecan3(CAN\u534f\u8bae\u76d2)\uff0cVehicle Vspy3\uff08\u7535\u8111\u7aef\u8f6f\u4ef6\uff09\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4e5f\u53ef\u4ee5\u5728\u6dd8\u5b9d\u4e0a\u8d2d\u4e70\u4fbf\u5b9c\u7684USB\u8f6cCAN\u7684\u5de5\u5177\u5373\u53ef\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u6d4b\u8bd5\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"Step1\uff1a\u5c06\u5df2\u7ecf\u5b8c\u6210\u7684STM32 CAN\u6d4b\u8bd5\u7a0b\u5e8f\u4e0b\u8f7d\u5230\u5b9e\u9645\u5f00\u53d1\u677f\u4e0a\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"Step2\uff1a\u901a\u8fc7CAN\u6d4b\u8bd5\u5de5\u5177Vehicle Vspy3\u53d1\u9001\u62a5\u6587ID\u4e3a0X201\u7684\u62a5\u6587\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"Step3\uff1a\u89c2\u5bdfCAN\u6d4b\u8bd5\u8f6f\u4ef6\u663e\u793a\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\u62a5\u6587ID\u4e3a0x101\u7684\u62a5\u6587\u662f\u6309\u71671\u79d2\u5468\u671f\u8fdb\u884c\u53d1\u9001\uff0c\u5982\u56fe14.3.2.4-1\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u62a5\u6587ID\u4e3a0x201\u7684\u62a5\u6587\u662fVehicle Spy3\u6309\u7167\u5468\u671f500ms\u53d1\u9001\u7ed9STM32\u5f00\u53d1\u677f\uff0c\u5982\u56fe14.3.2.4-1"}),"\n",(0,r.jsx)(e.p,{children:"\u62a5\u6587ID\u4e3a0x301\u7684\u62a5\u6587\u662f\u5728\u63a5\u6536\u5230\u62a5\u6587ID\u4e3a0x201\u7684\u62a5\u6587\u540e\uff0c\u7136\u540e\u8f6c\u53d1\u51fa\u62a5\u6587ID\u4e3a0x301\u7684\u62a5\u6587\uff0c\u5982\u56fe14.3.2.4-2\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0006.png",alt:"\u56fe14.3.2.4-1 \u62a5\u6587\u53d1\u9001\u7ed3\u679c\u67e5\u770b"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0007.png",alt:"\u56fe14.3.2.4-2 \u62a5\u6587\u63a5\u6536\u60c5\u51b5\u67e5\u770b"})}),"\n",(0,r.jsx)(e.h2,{id:"144-linux-socketcan\u57fa\u7840\u5e94\u7528\u7f16\u7a0b",children:(0,r.jsx)(e.strong,{children:"14.4 Linux socketcan\u57fa\u7840\u5e94\u7528\u7f16\u7a0b"})}),"\n",(0,r.jsx)(e.h3,{id:"1441-socketcan\u6982\u8ff0",children:(0,r.jsx)(e.strong,{children:"14.4.1 socketcan\u6982\u8ff0"})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tsocketcan\u662f\u5728Linux\u4e0bCAN\u534f\u8bae(Controller Area Network)\u5b9e\u73b0\u7684\u4e00\u79cd\u5b9e\u73b0\u65b9\u6cd5\u3002 CAN\u662f\u4e00\u79cd\u5728\u4e16\u754c\u8303\u56f4\u5185\u5e7f\u6cdb\u7528\u4e8e\u81ea\u52a8\u63a7\u5236\u3001\u5d4c\u5165\u5f0f\u8bbe\u5907\u548c\u6c7d\u8f66\u9886\u57df\u7684\u7f51\u7edc\u6280\u672f\u3002Linux\u4e0b\u6700\u65e9\u4f7f\u7528CAN\u7684\u65b9\u6cd5\u662f\u57fa\u4e8e\u5b57\u7b26\u8bbe\u5907\u6765\u5b9e\u73b0\u7684\uff0c\u4e0e\u4e4b\u4e0d\u540c\u7684\u662fSocket CAN\u4f7f\u7528\u4f2f\u514b\u5229\u7684socket\u63a5\u53e3\u548clinux\u7f51\u7edc\u534f\u8bae\u6808\uff0c\u8fd9\u79cd\u65b9\u6cd5\u4f7f\u5f97can\u8bbe\u5907\u9a71\u52a8\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u63a5\u53e3\u6765\u8c03\u7528\u3002Socket CAN\u7684\u63a5\u53e3\u88ab\u8bbe\u8ba1\u7684\u5c3d\u91cf\u63a5\u8fd1TCP/IP\u7684\u534f\u8bae\uff0c\u8ba9\u90a3\u4e9b\u719f\u6089\u7f51\u7edc\u7f16\u7a0b\u7684\u7a0b\u5e8f\u5458\u80fd\u591f\u6bd4\u8f83\u5bb9\u6613\u7684\u5b66\u4e60\u548c\u4f7f\u7528\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u4f7f\u7528Socket CAN\u7684\u4e3b\u8981\u76ee\u7684\u5c31\u662f\u4e3a\u7528\u6237\u7a7a\u95f4\u7684\u5e94\u7528\u7a0b\u5e8f\u63d0\u4f9b\u57fa\u4e8eLinux\u7f51\u7edc\u5c42\u7684\u5957\u63a5\u5b57\u63a5\u53e3\u3002\u4e0e\u5e7f\u4e3a\u4eba\u77e5\u7684TCP/IP\u534f\u8bae\u4ee5\u53ca\u4ee5\u592a\u7f51\u4e0d\u540c\uff0cCAN\u603b\u7ebf\u6ca1\u6709\u7c7b\u4f3c\u4ee5\u592a\u7f51\u7684MAC\u5c42\u5730\u5740\uff0c\u53ea\u80fd\u7528\u4e8e\u5e7f\u64ad\u3002CAN ID\u4ec5\u4ec5\u7528\u6765\u8fdb\u884c\u603b\u7ebf\u7684\u4ef2\u88c1\u3002\u56e0\u6b64CAN ID\u5728\u603b\u7ebf\u4e0a\u5fc5\u987b\u662f\u552f\u4e00\u7684\u3002\u5f53\u8bbe\u8ba1\u4e00\u4e2aCAN-ECU(Electronic Control Unit \u7535\u5b50\u63a7\u5236\u5355\u5143\uff09\u7f51\u7edc\u7684\u65f6\u5019\uff0cCAN\u62a5\u6587ID\u53ef\u4ee5\u6620\u5c04\u5230\u5177\u4f53\u7684ECU\u3002\u56e0\u6b64CAN\u62a5\u6587ID\u53ef\u4ee5\u5f53\u4f5c\u53d1\u9001\u6e90\u7684\u5730\u5740\u6765\u4f7f\u7528\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"1442-socketcan\u57fa\u672c\u77e5\u8bc6\u70b9",children:(0,r.jsx)(e.strong,{children:"14.4.2 socketcan\u57fa\u672c\u77e5\u8bc6\u70b9"})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u5728\u201c14.3 STM32 CAN\u5e94\u7528\u7f16\u7a0b\u201d\u4e2d\u6211\u4eec\u5df2\u7ecf\u5b8c\u6574\u7684\u6784\u5efa\u4e86CAN\u5e94\u7528\u7f16\u7a0b\u6846\u67b6\uff0c\u4f46\u662f\u5728linux\u5e94\u7528\u7f16\u7a0b\u4e2d\uff0c\u64cd\u4f5cCAN\u5e95\u5c42\u9a71\u52a8\u4e0eSTM32\u601d\u8def\u4e0a\u76f8\u4f3c\uff0c\u4f46\u662f\u64cd\u4f5c\u65b9\u6cd5\u6216\u8005\u8bf4\u8c03\u7528\u7684\u63a5\u53e3\u8fd8\u662f\u5dee\u5f02\u5f88\u5927\u7684\uff0c\u56e0\u4e3aSTM32\u662f\u76f4\u63a5\u8c03\u7528\u7684SDK\u5305\u6216\u76f4\u63a5\u64cd\u4f5c\u5bc4\u5b58\u5668\uff0c\u4f46\u662flinux\u7cfb\u7edf\u662f\u9700\u8981\u901a\u8fc7\u8c03\u7528\u7cfb\u7edf\u547d\u4ee4\u6216linuxCAN\u9a71\u52a8\u6765\u5b9e\u73b0\u7269\u7406\u5c42\u7684\u64cd\u4f5c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u56e0\u6b64\u8fd9\u91cc\u6211\u4eec\u91cd\u70b9\u4ecb\u7ecdlinux\u4e0a\u7684\u4e00\u4e9b\u7cfb\u7edf\u8c03\u7528\u547d\u4ee4\uff0c\u548c\u4e00\u4e9bsocketcan\u76f8\u5173\u7684\u6982\u5ff5\u3002"}),"\n",(0,r.jsx)(e.h4,{id:"14421-can\u8bbe\u5907\u64cd\u4f5c",children:(0,r.jsx)(e.strong,{children:"14.4.2.1 CAN\u8bbe\u5907\u64cd\u4f5c"})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tCAN\u8bbe\u5907\u6709\u5f00\u542f\u3001\u5173\u95ed\u3001\u8bbe\u7f6e\u53c2\u65703\u4e2a\u529f\u80fd\u3002\u56e0\u4e3alinux\u4e0bCAN\u8bbe\u5907\u662f\u6a21\u62df\u7f51\u7edc\u64cd\u4f5c\u7684\u65b9\u5f0f\uff0c\u8fd9\u91ccCAN\u8bbe\u5907\u7684\u5f00\u542f\u3001\u5173\u95ed\u548c\u8bbe\u7f6e\uff0c\u5747\u901a\u8fc7ip\u547d\u4ee4\u6765\u64cd\u4f5c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u5728100ask_IMX6ULL\u5f00\u53d1\u677f\u4e0a\u6253\u5f00\u4e32\u53e3\uff0c\u4f7f\u7528\u201cifconfig -a\u201d\u67e5\u770b\u6240\u6709\u7684\u7f51\u7edc\u8282\u70b9\uff0c\u53d1\u73b0\u7b2c1\u4e2a\u8282\u70b9\u5c31\u662f\u201ccan0\u201d\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0008.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\uff081\uff09Linux CAN\u8bbe\u5907\u5f00\u542f\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'#define ip_cmd_open      "ifconfig can0 up"     /* \u6253\u5f00CAN0 */\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u8bf4\u660e\uff1acan0\uff1acan\u8bbe\u5907\u540d\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"up\uff1a \u6253\u5f00\u8bbe\u5907\u547d\u4ee4"}),"\n",(0,r.jsx)(e.p,{children:"\uff082\uff09Linux CAN\u8bbe\u5907\u5173\u95ed\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'#define ip_cmd_close      "ifconfig can0 down"    /* \u5173\u95edCAN0 */\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u8bf4\u660e\uff1acan0\uff1acan\u8bbe\u5907\u540d\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"down\uff1a \u5173\u95ed\u8bbe\u5907\u547d\u4ee4"}),"\n",(0,r.jsx)(e.p,{children:"\uff082\uff09Linux CAN\u53c2\u6570\u8bbe\u7f6e\uff08\u6ce2\u7279\u7387\uff0c\u91c7\u6837\u7387\uff09\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'#define ip_cmd_set_can_params "ip link set can0 type can bitrate 500000 triple-sampling on"\n\n/* \u5c06CAN0\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a500000 bps */\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u8bf4\u660e\uff1acan0\uff1acan\u8bbe\u5907\u540d\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"down\uff1a \u5173\u95ed\u8bbe\u5907\u547d\u4ee4"}),"\n",(0,r.jsx)(e.p,{children:"Type can\uff1a \u8bbe\u5907\u7c7b\u578b\u4e3acan"}),"\n",(0,r.jsx)(e.p,{children:"Bitrate 500000\uff1a \u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a500kbps"}),"\n",(0,r.jsx)(e.p,{children:"Triple-sampleing on: \u91c7\u6837\u6253\u5f00"}),"\n",(0,r.jsx)(e.h4,{id:"14422-\u4ec0\u4e48\u662fsocket\u5957\u63a5\u53e3",children:(0,r.jsx)(e.strong,{children:"14.4.2.2 \u4ec0\u4e48\u662fSocket\u5957\u63a5\u53e3"})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u5728linux\u91cc\u7f51\u7edc\u64cd\u4f5c\u4f7f\u7528socket\u8fdb\u884c\u63a5\u53e3\u521b\u5efa\uff0c\u7adf\u7136CAN\u8bbe\u5907\u4e5f\u662f\u865a\u62df\u6210\u7f51\u7edc\u63a5\u53e3\uff0c\u4e5f\u662f\u4f7f\u7528\u7684socket\u5957\u63a5\u53e3\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u7535\u8bddA\u547c\u53eb\u7535\u8bddB\uff0c\u7535\u8bddA\u4f1a\u8f93\u5165\u7535\u8bddB\u7684\u53f7\u7801\uff0c\u7535\u8bddB\u4f1a\u63a5\u6536\u5230\u7535\u8bddA\u7684\u6765\u7535\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u7535\u8bddA\u548c\u7535\u8bddB\u662f\u4e24\u4e2a\u7aef\u70b9\u3002\u800clinux\u5957\u63a5\u53e3\u4e0e\u8fd9\u4e2a\u7535\u8bdd\u901a\u4fe1\u7c7b\u4f3c\uff0c\u5957\u63a5\u53e3\u5c31\u662f\u4e00\u4e2a\u901a\u4fe1\u7684\u7aef\u70b9\uff0c\u7aef\u70b9\u4e4b\u95f4\u662f\u901a\u4fe1\u94fe\u8def\uff1b\u7535\u8bdd\u901a\u4fe1\u662f\u901a\u8fc7\u7535\u8bdd\u53f7\u7801\u8fdb\u884c\u62e8\u53f7\u901a\u4fe1\uff0c\u800c\u5957\u63a5\u53e3\u662f\u4f7f\u7528\u5730\u5740\u8fdb\u884c\u8bc6\u522b\u5bf9\u65b9\u7684\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0009.png",alt:"\u56fe14.2.2.2 \u7535\u8bdd\u901a\u4fe1\u6a21\u578b"})}),"\n",(0,r.jsx)(e.h4,{id:"14423-socket\u63a5\u53e3\u51fd\u6570",children:(0,r.jsx)(e.strong,{children:"14.4.2.3 Socket\u63a5\u53e3\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u6211\u4eec\u8981\u521b\u5efa\u5e76\u4f7f\u7528socket\u5957\u63a5\u53e3\u8fdb\u884c\u901a\u4fe1\u7f16\u7a0b\uff0c\u5c31\u9700\u8981\u4e86\u89e3\u4e00\u4e0bsocket\u76f8\u5173\u7684\u63a5\u53e3\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u9700\u8981\u67e5\u8be2linux\u7cfb\u7edf\u91cc\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u901a\u8fc7man\u547d\u4ee4\u67e5\u770b\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4e3e\u4f8b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"man socket  /* \u67e5\u770bsocket\u51fd\u6570\u63cf\u8ff0 */"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09socket()\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728linux\u7cfb\u7edf\u4e0b\uff0c\u901a\u8fc7\u201cman socket\u201d\u547d\u4ee4\uff0c\u67e5\u8be2socket()\u51fd\u6570\u63cf\u8ff0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0010.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"Socket\u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#include <sys/types.h>     \n\n#include <sys/socket.h>\n\nint socket(int domain, int type, int protocol);  /* \u5957\u63a5\u53e3\u51fd\u6570\u539f\u578b */\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u4e09\u4e2a\u53c2\u6570\u5982\u4e0b:"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.th,{children:"domain\uff1a\u5373\u534f\u8bae\u57df\uff0c\u53c8\u79f0\u4e3a\u534f\u8bae\u65cf\uff08family\uff09\u3002  \u5e38\u7528\u7684\u534f\u8bae\u65cf\u6709\uff0cAF_INET\u3001AF_INET6\u3001AF_LOCAL\uff08\u6216\u79f0AF_UNIX\uff0cUnix\u57dfsocket\uff09\u3001AF_ROUTE\u7b49\u7b49\u3002\u534f\u8bae\u65cf\u51b3\u5b9a\u4e86socket\u7684\u5730\u5740\u7c7b\u578b\uff0c\u5728\u901a\u4fe1\u4e2d\u5fc5\u987b\u91c7\u7528\u5bf9\u5e94\u7684\u5730\u5740\uff0c\u5982AF_INET\u51b3\u5b9a\u4e86\u8981\u7528ipv4\u5730\u5740\uff0832\u4f4d\u7684\uff09\u4e0e\u7aef\u53e3\u53f7\uff0816\u4f4d\u7684\uff09\u7684\u7ec4\u5408\u3001AF_UNIX\u51b3\u5b9a\u4e86\u8981\u7528\u4e00\u4e2a\u7edd\u5bf9\u8def\u5f84\u540d\u4f5c\u4e3a\u5730\u5740\u3002"})})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:"type\uff1a \u6307\u5b9asocket\u7c7b\u578b\u3002\u5e38\u7528\u7684socket\u7c7b\u578b\u6709\uff0c  SOCK_STREAM\u3001SOCK_DGRAM\u3001SOCK_RAW\u3001SOCK_PACKET\u3001SOCK_SEQPACKET\u7b49\u7b49\u3002"})}),(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:"protocol\uff1a\u5c31\u662f\u6307\u5b9a\u534f\u8bae\u3002  \u5e38\u7528\u7684\u534f\u8bae\u6709\uff0cIPPROTO_TCP\u3001IPPTOTO_UDP\u3001IPPROTO_SCTP\u3001IPPROTO_TIPC\u7b49\uff0c\u5b83\u4eec\u5206\u522b\u5bf9\u5e94TCP\u4f20\u8f93\u534f\u8bae\u3001UDP\u4f20\u8f93\u534f\u8bae\u3001STCP\u4f20\u8f93\u534f\u8bae\u3001TIPC\u4f20\u8f93\u534f\u8bae\u3002"})})]})]}),"\n",(0,r.jsx)(e.p,{children:"\u6ce8\u610f\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t1.\u5e76\u4e0d\u662f\u4e0a\u9762\u7684type\u548cprotocol\u53ef\u4ee5\u968f\u610f\u7ec4\u5408\u7684\uff0c\u5982SOCK_STREAM\u4e0d\u53ef\u4ee5\u8ddfIPPROTO_UDP\u7ec4\u5408\u3002\u5f53protocol\u4e3a0\u65f6\uff0c\u4f1a\u81ea\u52a8\u9009\u62e9type\u7c7b\u578b\u5bf9\u5e94\u7684\u9ed8\u8ba4\u534f\u8bae\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u5f53\u6211\u4eec\u8c03\u7528socket\u521b\u5efa\u4e00\u4e2asocket\u65f6\uff0c\u8fd4\u56de\u7684socket\u63cf\u8ff0\u5b57\u5b83\u5b58\u5728\u4e8e\u534f\u8bae\u65cf\uff08address family\uff0cAF_XXX\uff09\u7a7a\u95f4\u4e2d\uff0c\u4f46\u6ca1\u6709\u4e00\u4e2a\u5177\u4f53\u7684\u5730\u5740\u3002\u5982\u679c\u60f3\u8981\u7ed9\u5b83\u8d4b\u503c\u4e00\u4e2a\u5730\u5740\uff0c\u5c31\u5fc5\u987b\u8c03\u7528bind()\u51fd\u6570\uff0c\u5426\u5219\u5c31\u5f53\u8c03\u7528connect()\u3001listen()\u65f6\u7cfb\u7edf\u4f1a\u81ea\u52a8\u968f\u673a\u5206\u914d\u4e00\u4e2a\u7aef\u53e3\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t2. Socketcan\u4f7f\u7528\u7684domain\u534f\u8bae\u57df\u662fAF_CAN(\u6216PF_CAN)\uff0ctype\u7c7b\u578b\u662fSOCK_RAW, \u6307\u5b9a\u534f\u8baeprotocol\u662fCAN_RAW."}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09bind()\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u5728linux\u7cfb\u7edf\u4e0b\uff0c\u901a\u8fc7\u201cman bind\u201d\u547d\u4ee4\uff0c\u67e5\u8be2bind()\u51fd\u6570\u63cf\u8ff0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0011.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tbind()\u51fd\u6570\u628a\u4e00\u4e2a\u5730\u5740\u65cf\u4e2d\u7684\u7279\u5b9a\u5730\u5740\u8d4b\u7ed9socket\u3002\u4f8b\u5982\u5bf9\u5e94AF_INET\u3001AF_INET6\u5c31\u662f\u628a\u4e00\u4e2aipv4\u6216ipv6\u5730\u5740\u548c\u7aef\u53e3\u53f7\u7ec4\u5408\u8d4b\u7ed9socket\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\tBind\u51fd\u6570\u539f\u578b\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#include <sys/types.h>          \n#include <sys/socket.h>\nint bind(int sockfd, const struct sockaddr *addr,socklen_t addrlen);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u7684\u4e09\u4e2a\u53c2\u6570\u5206\u522b\u4e3a\uff1a"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"sockfd"}),"\uff1a\u5373socket\u63cf\u8ff0\u5b57\uff0c\u5b83\u662f\u901a\u8fc7socket()\u51fd\u6570\u521b\u5efa\u4e86\uff0c\u552f\u4e00\u6807\u8bc6\u4e00\u4e2asocket\u3002bind()\u51fd\u6570\u5c31\u662f\u5c06\u7ed9\u8fd9\u4e2a\u63cf\u8ff0\u5b57\u7ed1\u5b9a\u4e00\u4e2a\u540d\u5b57\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"addr"}),"\uff1a\u4e00\u4e2aconst struct sockaddr *\u6307\u9488\uff0c\u6307\u5411\u8981\u7ed1\u5b9a\u7ed9sockfd\u7684\u534f\u8bae\u5730\u5740\u3002\u8fd9\u4e2a\u5730\u5740\u7ed3\u6784\u6839\u636e\u5730\u5740\u521b\u5efasocket\u65f6\u7684\u5730\u5740\u534f\u8bae\u65cf\u7684\u4e0d\u540c\u800c\u4e0d\u540c\uff0c"]}),"\n",(0,r.jsx)(e.p,{children:"\u5982ipv4\u5bf9\u5e94\u7684\u662f\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"struct sockaddr_in {\n    sa_family_t    sin_family;   /* address family: AF_INET */\n    in_port_t      sin_port;    /* port in network byte order */\n    struct in_addr sin_addr;     /* internet address */\n};\n/* Internet address. */struct in_addr {\n    uint32_t       s_addr;     /* address in network byte order */\n};\n"})}),"\n",(0,r.jsx)(e.p,{children:"ipv6\u5bf9\u5e94\u7684\u662f\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"struct sockaddr_in6 { \n    sa_family_t     sin6_family;   /* AF_INET6 */ \n    in_port_t       sin6_port;     /* port number */ \n    uint32_t        sin6_flowinfo; /* IPv6 flow information */ \n    struct in6_addr  sin6_addr;     /* IPv6 address */ \n    uint32_t        sin6_scope_id; /* Scope ID (new in 2.4) */ \n};\nstruct in6_addr { \n    unsigned char   s6_addr[16];   /* IPv6 address */ \n};\n"})}),"\n",(0,r.jsx)(e.p,{children:"Unix\u57df\u5bf9\u5e94\u7684\u662f\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#define UNIX_PATH_MAX  108\nstruct sockaddr_un { \n  sa_family_t sun_family;        /* AF_UNIX */ \n  char    sun_path[UNIX_PATH_MAX]; /* pathname */ \n};\n"})}),"\n",(0,r.jsx)(e.p,{children:"CAN\u57df\u5bf9\u5e94\u7684\u662f\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u6587\u4ef6\u201cLinux-4.9.88\\include\\uapi\\linux\\can.h\u201d\u4e2d\u6709\u5b9a\u4e49\uff0c\u8fd9\u4e2a\u662f\u672c\u7ae0\u9700\u8981\u91cd\u70b9\u4e86\u89e3\u7684\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"/**\n * struct sockaddr_can - CAN sockets\u7684\u5730\u5740\u7ed3\u6784\n * @can_family:  \u5730\u5740\u534f\u8bae\u65cf AF_CAN.\n * @can_ifindex:  CAN\u7f51\u7edc\u63a5\u53e3\u7d22\u5f15\n * @can_addr:    \u534f\u8bae\u5730\u5740\u4fe1\u606f\n */\nstruct sockaddr_can {\n\t__kernel_sa_family_t can_family;\n\tint         can_ifindex;\n\tunion {\n\t\t/* \u4f20\u8f93\u534f\u8bae\u7c7b\u5730\u5740\u4fe1\u606f (e.g. ISOTP) */\n\t\tstruct { canid_t rx_id, tx_id; } tp;\n\n\t\t/* \u9884\u7559\u7ed9\u5c06\u6765\u4f7f\u7528\u7684CAN\u534f\u8bae\u5730\u5740\u4fe1\u606f*/\n\t} can_addr;\n};\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"addrlen"}),"\uff1a\u5bf9\u5e94\u7684\u662f\u5730\u5740\u7684\u957f\u5ea6\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u901a\u5e38\u670d\u52a1\u5668\u5728\u542f\u52a8\u7684\u65f6\u5019\u90fd\u4f1a\u7ed1\u5b9a\u4e00\u4e2a\u4f17\u6240\u5468\u77e5\u7684\u5730\u5740\uff08\u5982ip\u5730\u5740+\u7aef\u53e3\u53f7\uff09\uff0c\u7528\u4e8e\u63d0\u4f9b\u670d\u52a1\uff0c\u5ba2\u6237\u5c31\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u63a5\u8fde\u670d\u52a1\u5668\uff1b\u800c\u5ba2\u6237\u7aef\u5c31\u4e0d\u7528\u6307\u5b9a\uff0c\u6709\u7cfb\u7edf\u81ea\u52a8\u5206\u914d\u4e00\u4e2a\u7aef\u53e3\u53f7\u548c\u81ea\u8eab\u7684ip\u5730\u5740\u7ec4\u5408\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u901a\u5e38\u670d\u52a1\u5668\u7aef\u5728listen\u4e4b\u524d\u4f1a\u8c03\u7528bind()\uff0c\u800c\u5ba2\u6237\u7aef\u5c31\u4e0d\u4f1a\u8c03\u7528\uff0c\u800c\u662f\u5728connect()\u65f6\u7531\u7cfb\u7edf\u968f\u673a\u751f\u6210\u4e00\u4e2a\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09ioctl()\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728linux\u7cfb\u7edf\u4e0b\uff0c\u901a\u8fc7\u201cman ioctl\u201d\u547d\u4ee4\uff0c\u67e5\u8be2ioctl()\u51fd\u6570\u63cf\u8ff0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0012.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"Ioctl()\u51fd\u6570\u8c03\u7528\u5c42\u6b21\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0013.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"Ioctl()\u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#include <sys/ioctl.h>\nint ioctl(int fd, unsigned long request, ...);\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u7528ioctl\u83b7\u5f97\u672c\u5730\u7f51\u7edc\u63a5\u53e3\u5730\u5740\u65f6\u8981\u7528\u5230\u4e24\u4e2a\u7ed3\u6784\u4f53ifconf\u548cifreq\u3002"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"struct ifreq\u5b9a\u4e49"}),"\nifreq\u7528\u6765\u4fdd\u5b58\u67d0\u4e2a\u63a5\u53e3\u7684\u4fe1\u606f\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u6587\u4ef6\u201cLinux-4.9.88\\include\\uapi\\linux\\if.h\u201d\u4e2d\u6709\u5b9a\u4e49struct ifreq\uff0c\u8fd9\u4e2a\u53ea\u9700\u8981\u4e86\u89e3\u662f\u5728ioctl()\u51fd\u6570\u8c03\u7528\u65f6\u7528\u6765\u83b7\u53d6CAN\u8bbe\u5907\u7d22\u5f15\uff08ifr_ifindex\uff09\u4f7f\u7528\uff0c\u5176\u4ed6\u7684\u53c2\u6570\u53ef\u4ee5\u4e0d\u7528\u5173\u6ce8\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"/*\n * Interface request structure used for socket\n * ioctl's.  All interface ioctl's must have parameter\n * definitions which begin with ifr_name.  The\n * remainder may be interface specific.\n */\n\n/* for compatibility with glibc net/if.h */\n#if __UAPI_DEF_IF_IFREQ\nstruct ifreq {\n#define IFHWADDRLEN\t6\n\tunion\n\t{\n\t\tchar\tifrn_name[IFNAMSIZ];\t\t/* if name, e.g. \"en0\" */\n\t} ifr_ifrn;\n\t\n\tunion {\n\t\tstruct\tsockaddr ifru_addr;\n\t\tstruct\tsockaddr ifru_dstaddr;\n\t\tstruct\tsockaddr ifru_broadaddr;\n\t\tstruct\tsockaddr ifru_netmask;\n\t\tstruct  sockaddr ifru_hwaddr;\n\t\tshort\tifru_flags;\n\t\tint\tifru_ivalue;\n\t\tint\tifru_mtu;\n\t\tstruct  ifmap ifru_map;\n\t\tchar\tifru_slave[IFNAMSIZ];\t/* Just fits the size */\n\t\tchar\tifru_newname[IFNAMSIZ];\n\t\tvoid __user *\tifru_data;\n\t\tstruct\tif_settings ifru_settings;\n\t} ifr_ifru;\n};\n#endif /* __UAPI_DEF_IF_IFREQ */\n\n#define ifr_name\tifr_ifrn.ifrn_name\t/* interface name \t*/\n#define ifr_hwaddr\tifr_ifru.ifru_hwaddr\t/* MAC address \t\t*/\n#define\tifr_addr\tifr_ifru.ifru_addr\t/* address\t\t*/\n#define\tifr_dstaddr\tifr_ifru.ifru_dstaddr\t/* other end of p-p lnk\t*/\n#define\tifr_broadaddr\tifr_ifru.ifru_broadaddr\t/* broadcast address\t*/\n#define\tifr_netmask\tifr_ifru.ifru_netmask\t/* interface net mask\t*/\n#define\tifr_flags\tifr_ifru.ifru_flags\t/* flags\t\t*/\n#define\tifr_metric\tifr_ifru.ifru_ivalue\t/* metric\t\t*/\n#define\tifr_mtu\t\tifr_ifru.ifru_mtu\t/* mtu\t\t\t*/\n#define ifr_map\t\tifr_ifru.ifru_map\t/* device map\t\t*/\n#define ifr_slave\tifr_ifru.ifru_slave\t/* slave device\t\t*/\n#define\tifr_data\tifr_ifru.ifru_data\t/* for use by interface\t*/\n#define ifr_ifindex\tifr_ifru.ifru_ivalue\t/* interface index\t*/\n#define ifr_bandwidth\tifr_ifru.ifru_ivalue    /* link bandwidth\t*/\n#define ifr_qlen\tifr_ifru.ifru_ivalue\t/* Queue length \t*/\n#define ifr_newname\tifr_ifru.ifru_newname\t/* New name\t\t*/\n#define ifr_settings\tifr_ifru.ifru_settings\t/* Device/proto settings*/\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"struct ifconf\u5b9a\u4e49"}),"\nifconf\u901a\u5e38\u662f\u7528\u6765\u4fdd\u5b58\u6240\u6709\u63a5\u53e3\u4fe1\u606f\u7684\uff0c\u672c\u7ae0\u8282\u672a\u4f7f\u7528\u5230\uff0c\u5728\u6b64\u4e0d\u4f5c\u8be6\u7ec6\u4ecb\u7ecd\u3002"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09setsockopt()\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u5728linux\u7cfb\u7edf\u4e0b\uff0c\u901a\u8fc7\u201cman setsockopt\u201d\u547d\u4ee4\uff0c\u67e5\u8be2setsockopt()\u51fd\u6570\u63cf\u8ff0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0014.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"setsockopt()\u548cgetsockopt\u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#include <sys/types.h>    \n#include <sys/socket.h>\nint getsockopt(int sockfd, int level, int optname,void *optval, socklen_t *optlen);\nint setsockopt(int sockfd, int level, int optname, const void *optval, socklen_t optlen);\n"})}),"\n",(0,r.jsxs)(e.p,{children:["Setsockopt()\u7528\u4e8e\u4efb\u610f\u7c7b\u578b\u3001\u4efb\u610f\u72b6\u6001",(0,r.jsx)(e.a,{href:"https://baike.baidu.com/item/%E5%A5%97%E6%8E%A5%E5%8F%A3/10058888",children:"\u5957\u63a5\u53e3"}),"\u7684\u8bbe\u7f6e\u9009\u9879\u503c\u3002\u5c3d\u7ba1\u5728\u4e0d\u540c\u534f\u8bae\u5c42\u4e0a\u5b58\u5728\u9009\u9879\uff0c\u4f46\u672c\u51fd\u6570\u4ec5\u5b9a\u4e49\u4e86\u6700\u9ad8\u7684\u201c\u5957\u63a5\u53e3\u201d\u5c42\u6b21\u4e0a\u7684\u9009\u9879\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u5176\u51fd\u6570\u53c2\u6570\u5982\u4e0b\uff1a\u53ef\u4ee5\u770b\u51fa\u5176\u53c2\u6570"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.th,{children:"sockfd\uff1a\u6807\u8bc6\u4e00\u4e2a\u5957\u63a5\u53e3\u7684\u63cf\u8ff0\u5b57\u3002"})})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:"level\uff1a\u9009\u9879\u5b9a\u4e49\u7684\u5c42\u6b21\uff1b\u652f\u6301SOL_SOCKET\u3001IPPROTO_TCP\u3001IPPROTO_IP\uff0cIPPROTO_IPV6\uff0cSOL_CAN_RAW\u7b49\u3002"})}),(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:"optname\uff1a\u9700\u8bbe\u7f6e\u7684\u9009\u9879\u3002"})}),(0,r.jsx)(e.tr,{children:(0,r.jsxs)(e.td,{children:["optval\uff1a",(0,r.jsx)(e.a,{href:"https://baike.baidu.com/item/%E6%8C%87%E9%92%88",children:"\u6307\u9488"}),"\uff0c\u6307\u5411\u5b58\u653e\u9009\u9879\u5f85\u8bbe\u7f6e\u7684\u65b0\u503c\u7684",(0,r.jsx)(e.a,{href:"https://baike.baidu.com/item/%E7%BC%93%E5%86%B2%E5%8C%BA",children:"\u7f13\u51b2\u533a"}),"\u3002"]})}),(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:"optlen\uff1aoptval\u7f13\u51b2\u533a\u957f\u5ea6\u3002"})})]})]}),"\n",(0,r.jsx)(e.p,{children:"\u51fd\u6570\u8c03\u7528\u793a\u4f8b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u793a\u4f8b1\uff1a\u8bbe\u7f6eCAN\u8fc7\u6ee4\u5668\u4e3a\u4e0d\u63a5\u6536\u6240\u6709\u62a5\u6587\u3002"})})})}),(0,r.jsx)(e.tbody,{children:(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:"//\u7981\u7528\u8fc7\u6ee4\u89c4\u5219\uff0c\u672c\u8fdb\u7a0b\u4e0d\u63a5\u6536\u62a5\u6587\uff0c\u53ea\u8d1f\u8d23\u53d1\u9001    //\u8bbe\u7f6e\u8fc7\u6ee4\u89c4\u5219  setsockopt(s, SOL_CAN_RAW, CAN_RAW_FILTER, NULL,  0);"})})})]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u793a\u4f8b2\uff1a\u8bbe\u7f6eCAN\u8fc7\u6ee4\u5668\u4e3a\u63a5\u6536\u67d0\u4e2a\u6307\u5b9a\u62a5\u6587"})})})}),(0,r.jsx)(e.tbody,{children:(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:"//\u5b9a\u4e49\u63a5\u6536\u89c4\u5219\uff0c\u53ea\u63a5\u6536\u8868\u793a\u7b26\u7b49\u4e8e 0x201 \u7684\u62a5\u6587     //\u5728linux\u5934\u6587\u4ef6\u6709\u5b9a\u4e49\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49  #define CAN_SFF_MASK 0x000007ffU     //\u5b9a\u4e49\u8fc7\u6ee4\u5668\uff081\u4e2a\uff09  struct can_filter rfilter[1];  rfilter[0].can_id = 0x201;  rfilter[0].can_mask = CAN_SFF_MASK;  //\u8bbe\u7f6e\u8fc7\u6ee4\u89c4\u5219 setsockopt(s, SOL_CAN_RAW, CAN_RAW_FILTER,  &rfilter, sizeof(rfilter));"})})})]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.th,{children:(0,r.jsx)(e.strong,{children:"\u793a\u4f8b2\uff1a\u8bbe\u7f6eCAN\u8fc7\u6ee4\u5668\u4e3a\u63a5\u6536\u67d0\u4e2a\u6307\u5b9a\u62a5\u6587"})})})}),(0,r.jsx)(e.tbody,{children:(0,r.jsx)(e.tr,{children:(0,r.jsx)(e.td,{children:"//\u5b9a\u4e49\u63a5\u6536\u89c4\u5219\uff0c\u53ea\u63a5\u6536\u8868\u793a\u7b26\u7b49\u4e8e 0x201 \u7684\u62a5\u6587     //\u5728linux\u5934\u6587\u4ef6\u6709\u5b9a\u4e49\uff0c\u4e5f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49  #define CAN_SFF_MASK 0x000007ffU     //\u5b9a\u4e49\u8fc7\u6ee4\u5668\uff083\u4e2a\uff09  struct can_filter rfilter[3];  rfilter[0].can_id = 0x201;  rfilter[0].can_mask = CAN_SFF_MASK;     rfilter[1].can_id = 0x401;  rfilter[1].can_mask = CAN_SFF_MASK;     rfilter[2].can_id = 0x601;  rfilter[2].can_mask = CAN_SFF_MASK;     //\u8bbe\u7f6e\u8fc7\u6ee4\u89c4\u5219 setsockopt(s, SOL_CAN_RAW, CAN_RAW_FILTER,  &rfilter, sizeof(rfilter));"})})})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff085\uff09write()\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728linux\u7cfb\u7edf\u4e0b\uff0c\u901a\u8fc7\u201cman 2 write\u201d\u547d\u4ee4\uff0c\u67e5\u8be2write()\u51fd\u6570\u63cf\u8ff0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0015.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"Write\u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#include <unistd.h>\nssize_t write(int fd, const void *buf, size_t count);\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff086\uff09read()\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728linux\u7cfb\u7edf\u4e0b\uff0c\u901a\u8fc7\u201cman 2 read\u201d\u547d\u4ee4\uff0c\u67e5\u8be2read()\u51fd\u6570\u63cf\u8ff0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0016.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"Read\u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#include <unistd.h>\nssize_t read(int fd, void *buf, size_t count);\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff087\uff09close()\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728linux\u7cfb\u7edf\u4e0b\uff0c\u901a\u8fc7\u201cman 2 close\u201d\u547d\u4ee4\uff0c\u67e5\u8be2close()\u51fd\u6570\u63cf\u8ff0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0017.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"close()\u51fd\u6570\u539f\u578b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#include <unistd.h>\nint close(int fd);\n"})}),"\n",(0,r.jsx)(e.h3,{id:"1443-socket_can\u7b80\u5355\u53d1\u9001\u5b9e\u4f8b",children:(0,r.jsx)(e.strong,{children:"14.4.3 socket_can\u7b80\u5355\u53d1\u9001\u5b9e\u4f8b"})}),"\n",(0,r.jsx)(e.p,{children:"\u7b80\u5355\u53d1\u9001\u5b9e\u4f8b\u4ee3\u7801\u76ee\u5f55\uff1a\u201c02_socketcan_send\u201d"}),"\n",(0,r.jsx)(e.p,{children:"\u6848\u4f8b\u63cf\u8ff0\uff1a"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"\u5b9e\u73b0\u5468\u671f1\u79d2\u53d1\u9001\u62a5\u6587ID\uff1a0x101\u7684\u62a5\u6587\uff1b"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u4e86\u89e3\u5185\u5bb9\uff1aIMX6 CAN\u63a5\u53e3\u7535\u8def"})}),"\n",(0,r.jsx)(e.p,{children:"\u4ece\u4e0b\u9762CAN\u5916\u56f4\u7535\u8def\u770b\uff0c\u548cSTM32\u662f\u5b8c\u5168\u76f8\u540c\u7684\uff0c\u53ea\u662f\u5904\u7406\u5185\u90e8\u7684CAN\u63a7\u5236\u5668\u56e0\u4e3a\u4e0d\u540c\u82af\u7247\u5236\u9020\u5382\u5bb6\u7684\u4e0d\u540c\uff0c\u4f1a\u6709\u4e00\u4e9b\u8f83\u5c0f\u7684\u5dee\u5f02\u3002\u8fd9\u91cc\u7535\u8def\u53ea\u662f\u5bf9\u6bd4\u4e86\u89e3\u4e00\u4e0b\uff0c\u505alinux\u5e94\u7528\u53ef\u4ee5\u4e0d\u9700\u8981\u5173\u6ce8\u5e95\u5c42\u9a71\u52a8\u5904\u7406\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0018.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u90a3\u6211\u4eec\u73b0\u5728\u6309\u716714.3\u7ae0\u8282\u6784\u5efaSTM32\u4e0bCAN\u5e94\u7528\u7f16\u7a0b\u7684\u6846\u67b6\uff0c\u4e00\u6b65\u4e00\u6b65\u7f16\u5199linux\u4e0bsocketCAN\u7684\u5e94\u7528\u7f16\u7a0b\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u51c6\u5907\u5de5\u4f5c\uff1a"})}),"\n",(0,r.jsx)(e.p,{children:"\u6211\u4eec\u6309\u716714.3\u7ae0\u8282\u51c6\u5907\u597dcan\u5e94\u7528\u7684\u4ee3\u7801\u6587\u4ef6\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u6587\u4ef6\u540d"}),(0,r.jsx)(e.th,{children:"\u6587\u4ef6\u5185\u5bb9\u63cf\u8ff0"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"App_can.c"}),(0,r.jsx)(e.td,{children:"CAN\u5e94\u7528\u529f\u80fd\u5b9e\u73b0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"App_can.h"}),(0,r.jsx)(e.td,{children:"CAN\u5e94\u7528\u529f\u80fd\u5934\u6587\u4ef6"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Can_controller.c"}),(0,r.jsx)(e.td,{children:"CAN\u9a71\u52a8\u64cd\u4f5c\u62bd\u8c61\u5c42\u5177\u4f53\u5b9e\u73b0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Can_controller.h"}),(0,r.jsx)(e.td,{children:"CAN\u9a71\u52a8\u64cd\u4f5c\u62bd\u8c61\u5c42\u5934\u6587\u4ef6"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Can_msg.h"}),(0,r.jsx)(e.td,{children:"CAN\u62a5\u6587\u57fa\u672c\u7ed3\u6784\u4f53\uff0c\u4eceSTM32 CAN\u9a71\u52a8\u62f7\u8d1d\u8fc7\u6765\u7684\uff0c\u4e3b\u8981\u5728\u4f7f\u7528CAN\u62a5\u6587\u65f6\u4f7f\u7528\u6211\u4eec\u6700\u719f\u6089\u7684\u7ed3\u6784\u4f53\u3002  \u6b64\u6587\u4ef6\u76f8\u5bf9STM32\u4e3a\u65b0\u589e\u6587\u4ef6\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u6846\u67b6\u662f\u57fa\u4e8e\u5355\u7247\u673a\u5e94\u7528\uff0c\u7136\u540e\u7c7b\u6bd4\u8fc1\u79fb\u5b66\u4e60\u5230linux\u4e0a\u3002"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Makefile"}),(0,r.jsx)(e.td,{children:"Makefile\u7f16\u8bd1\u811a\u672c"})]})]})]}),"\n",(0,r.jsxs)(e.h4,{id:"14431-\u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570",children:[(0,r.jsx)(e.strong,{children:"14.4.3.1"})," ",(0,r.jsx)(e.strong,{children:"\u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570"})]}),"\n",(0,r.jsx)(e.p,{children:"\u9996\u5148\u6211\u4eec\u4f7f\u752814.3\u7ae0\u8282\u5df2\u7ecf\u6784\u5efa\u597d\u7684\u62bd\u8c61\u7ed3\u6784\u4f53\uff0c\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c02_socketcan_send_addline\u201d\u4e2d\u201ccan_controller.h\u201d\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"34 /* CAN\u901a\u4fe1\u62bd\u8c61\u7ed3\u6784\u4f53\u5b9a\u4e49*/\n35 typedef struct _CAN_COMM_STRUCT\n36 {\n37     /* CAN\u786c\u4ef6\u540d\u79f0 */\n38     char *name;\n39     /* CAN\u7aef\u53e3\u53f7\uff0c\u88f8\u673a\u91cc\u4e3a\u7aef\u53e3\u53f7;linux\u5e94\u7528\u91cc\u4f5c\u4e3asocket\u5957\u63a5\u53e3 */\n40     int  can_port;                                \n41     /* CAN\u63a7\u5236\u5668\u914d\u7f6e\u51fd\u6570\uff0c\u8fd4\u56de\u7aef\u53e3\u53f7\u8d4b\u503c\u7ed9can_port */\n42     int  (*can_set_controller)( void );                  \n43     /* CAN\u63a5\u53e3\u4e2d\u65ad\u521b\u5efa\uff0c\u5728linux\u4e2d\u5bf9\u5e94\u521b\u5efa\u63a5\u6536\u7ebf\u7a0b */\n44     void (*can_set_interrput)( int can_port , pCanInterrupt callback );             \n45     /* CAN\u8bfb\u53d6\u62a5\u6587\u63a5\u53e3 */\n46     void (*can_read)( int can_port , CanRxMsg* recv_msg);   \n47     /* CAN\u53d1\u9001\u62a5\u6587\u63a5\u53e3*/\n48     void (*can_write)( int can_port , CanTxMsg send_msg);   \n49 }CAN_COMM_STRUCT, *pCAN_COMM_STRUCT;\n50 \n"})}),"\n",(0,r.jsx)(e.p,{children:"\u6211\u4eec\u5c31\u6309\u7167\u8fd9\u4e2a\u7ed3\u6784\u4f53\u7684\u987a\u5e8f\u4f9d\u6b21\u7f16\u5199can_controller.c\u4e2d\u7684CAN\u9a71\u52a8\u64cd\u4f5c\u5177\u4f53\u5b9e\u73b0\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09\u5b9a\u4e49CAN\u8bbe\u5907"})}),"\n",(0,r.jsx)(e.p,{children:"\u6839\u636e14.4.2.1\u7ae0\u8282\u63cf\u8ff0\uff0clinux\u5e94\u7528\u5c42\u64cd\u4f5cCAN\u8bbe\u5907\uff0c\u9700\u8981\u77e5\u9053\u8bbe\u5907\u540d\u3002."}),"\n",(0,r.jsx)(e.p,{children:"\u5728100ask_IMX6ULL\u5f00\u53d1\u677f\u4e0a\u6253\u5f00\u4e32\u53e3\uff0c\u4f7f\u7528\u201cifconfig -a\u201d\u547d\u4ee4\u67e5\u770b\uff0c\u77e5\u9053\u5f53\u524dCAN\u8bbe\u5907\u540d\u79f0\u4e3a\u201dcan0\u201d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u76f4\u63a5\u5728linux\u547d\u4ee4\u884c\u76f4\u63a5\u4f7f\u7528ip\u547d\u4ee4\u53ef\u4ee5\u6253\u5f00\uff0c\u8bbe\u7f6e\uff0c\u548c\u5173\u95edCAN\u8bbe\u5907\uff0c\u56e0\u6b64\u6211\u4eec\u5b9a\u4e49\u4e86\u4e09\u4e2a\u5b8fip_cmd_open, ip_cmd_close,ip_cmd_set_can_params, \u8fd9\u4e09\u4e2a\u5b8f\u53ef\u4ee5\u901a\u8fc7\u7cfb\u7edf\u8c03\u7528system()\u8fdb\u884c\u6267\u884c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c02_socketcan_send_addline\u201d\u4e2d\u201ccan_controller.c\u201d\u6587\u4ef6\u4e2d\u5b8f\u5b9a\u4e49\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'29 /**************\u5b8f\u5b9a\u4e49**************************************************/\n30 \n31 /* \u5c06CAN0\u6ce2\u7279\u7387\u8bbe\u7f6e\u4e3a500000 bps */\n32 #define ip_cmd_set_can_params  "ip link set can0 type can bitrate 500000 triple-sampling on"\n33 \n34 /* \u6253\u5f00CAN0 */\n35 #define ip_cmd_open            "ifconfig can0 up"     \n36 \n37 /* \u5173\u95edCAN0 */    \n38 #define ip_cmd_close           "ifconfig can0 down"   \n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09\u914d\u7f6eCAN\u63a7\u5236\u5668"})}),"\n",(0,r.jsx)(e.p,{children:"\u914d\u7f6eCAN\u63a7\u5236\u5668\u67093\u4e2a\u90e8\u5206\uff1a\u6253\u5f00can0\u8bbe\u5907\uff0cCAN\u6ce2\u7279\u7387\u914d\u7f6e\uff0cCAN\u8fc7\u6ee4\u5668\u914d\u7f6e\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c01_stm32f407_can_addline\u201d\u4e2d\u201ccan_controller.c\u201d\u6587\u4ef6int CAN_Set_Controller( void )\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"A.\u914d\u7f6e\u6ce2\u7279\u7387\uff0c\u6253\u5f00can0\u8bbe\u5907"})}),"\n",(0,r.jsx)(e.p,{children:"\u4f7f\u7528\uff081\uff09\u4e2d\u7684\u4e09\u4e2a\u547d\u4ee4ip_cmd_open, ip_cmd_close,ip_cmd_set_can_params,\u901a\u8fc7system\u7cfb\u7edf\u8c03\u7528\uff1a\u5177\u4f53\u4ee3\u7801\u5982\u4e0b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"77     /* \u901a\u8fc7system\u8c03\u7528ip\u547d\u4ee4\u8bbe\u7f6eCAN\u6ce2\u7279\u7387 */\n78     system(ip_cmd_close);               \n79     system(ip_cmd_set_can_params);\n80     system(ip_cmd_open);\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"B.\u521b\u5efa\u5957\u63a5\u53e3"})}),"\n",(0,r.jsx)(e.p,{children:"\u56e0\u4e3alinux\u5e94\u7528\u64cd\u4f5c\u8bbe\u5907\u5747\u4f7f\u7528\u8bfbread\u5199write\u64cd\u4f5c\uff0clinux\u4e00\u5207\u7686\u6587\u4ef6\uff0c\u800csocketcan\u53c8\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u6587\u4ef6\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u8c03\u7528socket()\u51fd\u6570\u521b\u5efa\u4e00\u4e2asocketcan\u63a5\u53e3\uff0c\u83b7\u53d6sock_fd\u63cf\u8ff0\u7b26\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'82   /*************************************************************/\n83   /* \u521b\u5efa\u5957\u63a5\u53e3 sock_fd */\n84   sock_fd = socket(AF_CAN, SOCK_RAW, CAN_RAW);\n85 \tif(sock_fd < 0)\n86 \t{\n87 \t\tperror("socket create error!\\n");\n88 \t\treturn -1;\n89 \t}\n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"C.\u7ed1\u5b9acan0\u8bbe\u5907\u4e0e\u5957\u63a5\u53e3"})}),"\n",(0,r.jsx)(e.p,{children:"\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'92   //\u5c06\u5957\u63a5\u5b57\u4e0e can0 \u7ed1\u5b9a\n93   strcpy(ifr.ifr_name, "can0");\n94 \tioctl(sock_fd, SIOCGIFINDEX,&ifr); // \u8bbe\u7f6e\u8bbe\u5907\u4e3acan0\n95 \n96 \tifr.ifr_ifindex = if_nametoindex(ifr.ifr_name);\n97 \tprintf("ifr_name:%s \\n",ifr.ifr_name);\n98 \tprintf("can_ifindex:%d \\n",ifr.ifr_ifindex);\n99 \n100 addr.can_family = AF_CAN;\n101 addr.can_ifindex = ifr.ifr_ifindex;\n102 \t\t\n103 if( bind(sock_fd, (struct sockaddr *)&addr, sizeof(addr)) < 0 )\n104 {\n105 \tperror("bind error!\\n");\n106 \treturn -1;\n107 }\n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"C.\u914d\u7f6e\u8fc7\u6ee4\u5668"})}),"\n",(0,r.jsx)(e.p,{children:"\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"109 \t/*************************************************************/\n110 \t//\u7981\u7528\u8fc7\u6ee4\u89c4\u5219\uff0c\u672c\u8fdb\u7a0b\u4e0d\u63a5\u6536\u62a5\u6587\uff0c\u53ea\u8d1f\u8d23\u53d1\u9001\n111  setsockopt(sock_fd, SOL_CAN_RAW, CAN_RAW_FILTER, NULL, 0); \n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"D.\u914d\u7f6e\u975e\u963b\u585e\u64cd\u4f5c"})}),"\n",(0,r.jsx)(e.p,{children:"Linux\u7cfb\u7edf\u8c03\u7528read\u548cwrite\u51fd\u6570\u6709\u963b\u585e\u548c\u975e\u963b\u585e\uff0c\u6211\u4eec\u5728\u5468\u671f\u8c03\u7528\u65f6\uff0c\u6b64\u91c7\u7528\u975e\u963b\u585e\u65b9\u5f0f\u5bf9CAN\u62a5\u6587\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5177\u4f53\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"114     //\u8bbe\u7f6eread()\u548cwrite()\u51fd\u6570\u8bbe\u7f6e\u4e3a\u975e\u5835\u585e\u65b9\u5f0f\n115     int flags;\n116     flags = fcntl(sock_fd, F_GETFL);\n117     flags |= O_NONBLOCK;\n118     fcntl(sock_fd, F_SETFL, flags);  \n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"E.\u8fd4\u56desock_fd\u5957\u63a5\u53e3"})}),"\n",(0,r.jsx)(e.p,{children:"\u5177\u4f53\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"int CAN_Set_Controller( void )\u51fd\u6570\u76f4\u63a5\u7ed3\u675f\u540e\uff0c\u8fd4\u56de\u503c\u8d4b\u503c\u7ed9CAN_COMM_STRUCT\u7684can_port\u6210\u5458\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u540e\u7eed\u5e94\u7528\u5c42\u6240\u8bbf\u95ee\u7684sock_fd\u63cf\u8ff0\u7b26\u5373\u4e3acan_port."}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u521b\u5efaCAN\u63a5\u6536\u7ebf\u7a0b"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728STM32\u4e2d\uff0c\u63a5\u6536\u4f7f\u7528\u7684\u63a5\u6536FIFO\u4e2d\u65ad\u8fdb\u884c\u5904\u7406\uff0c\u5728linux\u5e94\u7528\u4e2d\uff0c\u6211\u4eec\u5219\u91c7\u7528\u7ebf\u7a0b\u8f6e\u8be2\u53bb\u8bfb\u53d6\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u56e0\u6b64\u6211\u4eec\u9700\u8981\u521b\u5efa\u4e00\u4e2aCAN\u63a5\u6536\u7ebf\u7a0b\uff0c\u5177\u4f53\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'127 /**********************************************************************\n128 * \u51fd\u6570\u540d\u79f0\uff1a void CAN_Set_Interrupt(int can_port,  pCanInterrupt callback)\n129 * \u529f\u80fd\u63cf\u8ff0\uff1a \u521b\u5efaCAN\u63a5\u6536\u7ebf\u7a0b\uff0c\u5e76\u4f20\u5165\u5e94\u7528\u7684\u7684\u56de\u8c03\u51fd\u6570\uff0c\u56de\u8c03\u51fd\u6570\u4e3b\u8981\u5904\u7406\u5e94\u7528\u5c42\u7684\u529f\u80fd\n130 * \u8f93\u5165\u53c2\u6570\uff1a can_port,\u7aef\u53e3\u53f7\n131 *          callback\uff1a \u4e2d\u65ad\u5177\u4f53\u5904\u7406\u5e94\u7528\u529f\u80fd\u7684\u56de\u8c03\u51fd\u6570\n132 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n133 * \u8fd4 \u56de \u503c\uff1a \u65e0\n134 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n135 * -----------------------------------------------\n136 * 2020/05/13         V1.0             bert            \u521b\u5efa\n137 ***********************************************************************/\n138 void CAN_Set_Interrupt(int can_port,  pCanInterrupt callback)\n139 {\n140     int err;\n141     \n142     if ( NULL != callback ) \n143     {\n144         g_pCanInterrupt = callback;\n145     }\n146     \n147     err = pthread_create(&ntid, NULL,CAN1_RX0_IRQHandler, NULL );\n148     if( err !=0 )\n149     {\n150         printf("create thread fail! \\n");\n151         return ;\n152     }\n153     printf("create thread success!\\n");\n154     \n155 \n156     return ;\n157 }\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u521b\u5efa\u540e\u7684\u7ebf\u7a0b\u51fd\u6570\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"CAN1_RX0_IRQHandler\u662f\u4e00\u4e2aCAN\u63a5\u6536\u7ebf\u7a0b\u51fd\u6570\uff0c\u4e0eCAN\u63a5\u6536\u4e2d\u65ad\u529f\u80fd\u76f8\u4f3c\uff0c\u53ea\u8fd9\u91cc\u91c7\u7528\u8f6e\u8be2\u65b9\u5f0f\u8bfb\u53d6CAN\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"253 /**********************************************************************\n254 * \u51fd\u6570\u540d\u79f0\uff1a void CAN1_RX0_IRQHandler(void)\n255 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u63a5\u6536\u7ebf\u7a0b\u51fd\u6570\n256 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0  \n257 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n258 * \u8fd4 \u56de \u503c\uff1a \u65e0\n259 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n260 * -----------------------------------------------\n261 * 2020/05/13         V1.0             bert            \u521b\u5efa\n262 ***********************************************************************/\n263 void *CAN1_RX0_IRQHandler(void *arg)\n264 {\n265     /* \u63a5\u6536\u62a5\u6587\u5b9a\u4e49 */\n266     while( 1 )\n267     {\n268     /* \u5982\u679c\u56de\u8c03\u51fd\u6570\u5b58\u5728\uff0c\u5219\u6267\u884c\u56de\u8c03\u51fd\u6570 */\n269         if( g_pCanInterrupt != NULL)\n270         {\n271             g_pCanInterrupt();\n272         }\n273         usleep(10000);\n274     }\n275 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'161 /**********************************************************************\n162 * \u51fd\u6570\u540d\u79f0\uff1a void CAN_Read(int can_port, CanRxMsg* recv_msg)\n163 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u8bfb\u53d6\u63a5\u6536\u5bc4\u5b58\u5668\uff0c\u53d6\u51fa\u63a5\u6536\u5230\u7684\u62a5\u6587\n164 * \u8f93\u5165\u53c2\u6570\uff1a can_port,\u7aef\u53e3\u53f7     \n165 * \u8f93\u51fa\u53c2\u6570\uff1a recv_msg\uff1a\u63a5\u6536\u62a5\u6587\n166 * \u8fd4 \u56de \u503c\uff1a \u65e0\n167 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n168 * -----------------------------------------------\n169 * 2020/05/13         V1.0             bert            \u521b\u5efa\n170 ***********************************************************************/\n171 void CAN_Read(int can_port, CanRxMsg* recv_msg)\n172 { \n173     unsigned char i;\n174     static unsigned int rxcounter =0;\n175     \n176     int nbytes;\n177     struct can_frame rxframe;\n178     \n179     \n180     nbytes = read(can_port, &rxframe, sizeof(struct can_frame));\n181 \tif(nbytes>0)\n182 \t{\n183 \t    printf("nbytes = %d \\n",nbytes );\n184 \t    \n185 \t    recv_msg->StdId = rxframe.can_id;\n186 \t    recv_msg->DLC = rxframe.can_dlc;\n187 \t    memcpy( recv_msg->Data, &rxframe.data[0], rxframe.can_dlc);\n188 \t    \n189 \t\trxcounter++;\n190 \t\tprintf("rxcounter=%d, ID=%03X, DLC=%d, data=%02X %02X %02X %02X %02X %02X %02X %02X \\n",  \\\n191 \t\t\trxcounter,\n192 \t\t\trxframe.can_id, rxframe.can_dlc,  \\\n193 \t\t\trxframe.data[0],\\\n194 \t\t\trxframe.data[1],\\\n195 \t\t\trxframe.data[2],\\\n196 \t\t\trxframe.data[3],\\\n197 \t\t\trxframe.data[4],\\\n198 \t\t\trxframe.data[5],\\\n199 \t\t\trxframe.data[6],\\\n200 \t\t\trxframe.data[7] );\n201 \t}\n202 \n203     return ;\n204 }\n205  \n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff085\uff09CAN\u62a5\u6587\u53d1\u9001\u51fd\u6570"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'206 /**********************************************************************\n207 * \u51fd\u6570\u540d\u79f0\uff1a void CAN_Write(int can_port, CanTxMsg send_msg)\n208 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u62a5\u6587\u53d1\u9001\u63a5\u53e3\uff0c\u8c03\u7528\u53d1\u9001\u5bc4\u5b58\u5668\u53d1\u9001\u62a5\u6587\n209 * \u8f93\u5165\u53c2\u6570\uff1a can_port,\u7aef\u53e3\u53f7     \n210 * \u8f93\u51fa\u53c2\u6570\uff1a send_msg\uff1a\u53d1\u9001\u62a5\u6587\n211 * \u8fd4 \u56de \u503c\uff1a \u65e0\n212 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n213 * -----------------------------------------------\n214 * 2020/05/13         V1.0             bert            \u521b\u5efa\n215 ***********************************************************************/\n216 void CAN_Write(int can_port, CanTxMsg send_msg)\n217 {\n218     unsigned char i;\n219     static unsigned int txcounter=0;\n220     int nbytes;\n221     \n222     struct can_frame txframe;\n223     \n224     txframe.can_id = send_msg.StdId;\n225     txframe.can_dlc = send_msg.DLC;\n226     memcpy(&txframe.data[0], &send_msg.Data[0], txframe.can_dlc);\n227 \n228     nbytes = write(can_port, &txframe, sizeof(struct can_frame)); //\u53d1\u9001 frame[0]\n229 \t\n230 \tif(nbytes == sizeof(txframe))\n231 \t{\n232 \t    txcounter++;\n233 \t    printf("txcounter=%d, ID=%03X, DLC=%d, data=%02X %02X %02X %02X %02X %02X %02X %02X \\n",  \\\n234 \t\t\ttxcounter,\n235 \t\t\ttxframe.can_id, txframe.can_dlc,  \\\n236 \t\t\ttxframe.data[0],\\\n237 \t\t\ttxframe.data[1],\\\n238 \t\t\ttxframe.data[2],\\\n239 \t\t\ttxframe.data[3],\\\n240 \t\t\ttxframe.data[4],\\\n241 \t\t\ttxframe.data[5],\\\n242 \t\t\ttxframe.data[6],\\\n243 \t\t\ttxframe.data[7] );\n244     }\n245     else\n246 \t{\n247 \t\t//printf("Send Error frame[0], nbytes=%d\\n!",nbytes);\n248 \t}\n249 \n250     return ;\n251 }\n252 \n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff086\uff09CAN\u62bd\u8c61\u7ed3\u6784\u4f53\u6846\u67b6\u521d\u59cb\u5316"})}),"\n",(0,r.jsx)(e.p,{children:"\u4e0e14.3\u7ae0\u8282STM32\u5b9a\u4e49\u5b9e\u4f8b\u7c7b\u4f3c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5b9a\u4e49\u4e00\u4e2acan1\u901a\u4fe1\u7ed3\u6784\u5b9e\u4f8bCAN_COMM_STRUCT can1_controller\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u4f7f\u7528\uff081\uff09~\uff085\uff09\u6b65\u9aa4\u5b9e\u73b0\u7684\u51fd\u6570\uff0c\u521d\u59cb\u5316can1_controller\uff0c\u6784\u6210\u4e0e\u5e94\u7528\u5c42\u5173\u8054\u7684\u4e00\u4e2a\u8fde\u63a5\u70b9\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'298 /**********************************************************************\n299 * \u540d\u79f0\uff1a     can1_controller\n300 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN1\u7ed3\u6784\u4f53\u521d\u59cb\u5316\n301 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n302 * -----------------------------------------------\n303 * 2020/05/13         V1.0             bert            \u521b\u5efa\n304 ***********************************************************************/\n305 CAN_COMM_STRUCT can1_controller = {\n306     .name                   = "can0",\n307     .can_port               = CAN_PORT_CAN1,\n308     .can_set_controller     = CAN_Set_Controller,\n309     .can_set_interrput      = CAN_Set_Interrupt,\n310     .can_read               = CAN_Read,\n311     .can_write              = CAN_Write,\n312 };\n'})}),"\n",(0,r.jsx)(e.h4,{id:"14432-\u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801",children:(0,r.jsx)(e.strong,{children:"14.4.3.2 \u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801"})}),"\n",(0,r.jsx)(e.p,{children:"\u6839\u636e14.4.3.1 \u5df2\u7ecf\u5c06\u5177\u4f53\u7684linux\u4e0bsocketCAN\u786c\u4ef6\u64cd\u4f5c\u5df2\u7ecf\u5b9e\u73b0\uff0c\u5e76\u4e14\u5df2\u7ecf\u62bd\u8c61\u5b9e\u4f8b\u5316\u4e86CAN\u7f16\u7a0b\u6846\u67b6\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4f46\u662f\u6211\u4eec\u73b0\u5728\u8fd8\u6ca1\u5173\u8054\u5230\u5e94\u7528\u5c42\uff0c\u5e94\u7528\u5c42\u5e76\u4e0d\u77e5\u9053\u8c03\u7528\u54ea\u4e2a\u63a5\u53e3\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09CAN\u5e94\u7528\u5c42\u6ce8\u518c\u5b9e\u4f8b"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u5e94\u7528\u5c42\u7f16\u5199\u4e00\u4e2a\u901a\u7528\u7684\u5b9e\u4f8b\u5316\u6ce8\u518c\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u89c1\u7b2c14\u7ae0\u8282\u4ee3\u7801\u201c02_socketcan_send_addline\u201d\u4e2d\u201capp_can.c\u201d\u6587\u4ef6int register_can_controller(const pCAN_COMM_STRUCT p_can_controller)\u51fd\u6570\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a\uff08\u548cSTM32\u5e94\u7528\u7f16\u7a0b\u5b8c\u5168\u4e00\u6837\uff0c\u4ee3\u7801\u51e0\u4e4e\u4e0d\u7528\u66f4\u6539\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"73 /**********************************************************************\n74 * \u51fd\u6570\u540d\u79f0\uff1a int register_can_controller(const pCAN_COMM_STRUCT p_can_controller)\n75 * \u529f\u80fd\u63cf\u8ff0\uff1a \u5e94\u7528\u5c42\u8fdb\u884cCAN1\u7ed3\u6784\u4f53\u6ce8\u518c\n76 * \u8f93\u5165\u53c2\u6570\uff1a p_can_controller\uff0cCAN\u63a7\u5236\u5668\u62bd\u8c61\u7ed3\u6784\u4f53\n77 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n78 * \u8fd4 \u56de \u503c\uff1a \u65e0\n79 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n80 * -----------------------------------------------\n81 * 2020/05/13         V1.0             bert            \u521b\u5efa\n82 ***********************************************************************/\n83 int register_can_controller(const pCAN_COMM_STRUCT p_can_controller)\n84 {\n85     /* \u5224\u65ad\u4f20\u5165\u7684p_can_controller\u4e3a\u975e\u7a7a\uff0c\u76ee\u7684\u662f\u786e\u8ba4\u8fd9\u4e2a\u7ed3\u6784\u4f53\u662f\u5b9e\u4f53*/\n86     if( p_can_controller != NULL )\n87     {\n88         /* \u5c06\u4f20\u5165\u7684\u53c2\u6570p_can_controller\u8d4b\u503c\u7ed9\u5e94\u7528\u5c42\u7ed3\u6784\u4f53gCAN_COMM_STRUCT */\n89         \n90         /*\u7aef\u53e3\u53f7\uff0c\u7c7b\u6bd4socketcan\u5957\u63a5\u53e3*/\n91         gCAN_COMM_STRUCT.can_port              = p_can_controller->can_port; \n92         /*CAN\u63a7\u5236\u5668\u914d\u7f6e\u51fd\u6570*/\n93         gCAN_COMM_STRUCT.can_set_controller    = p_can_controller->can_set_controller; \n94         /*CAN\u4e2d\u65ad\u914d\u7f6e*/\n95         gCAN_COMM_STRUCT.can_set_interrput     = p_can_controller->can_set_interrput;\n96         /*CAN\u62a5\u6587\u8bfb\u51fd\u6570*/\n97         gCAN_COMM_STRUCT.can_read              = p_can_controller->can_read;\n98         /*CAN\u62a5\u6587\u53d1\u9001\u51fd\u6570*/\n99         gCAN_COMM_STRUCT.can_write             = p_can_controller->can_write;\n100         return 1;\n101     }\n102 \treturn 0;\n103 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316"})}),"\n",(0,r.jsx)(e.p,{children:"CAN\u5e94\u7528\u5c42\u4ee3\u7801\u521d\u59cb\u5316\u5982\u4e0b\uff1a\uff08\u548cSTM32 CAN\u5e94\u7528\u4ee3\u7801\u5b8c\u5168\u4e00\u6837\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"105 /**********************************************************************\n106 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_init(void)\n107 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316\n108 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n109 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n110 * \u8fd4 \u56de \u503c\uff1a \u65e0\n111 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n112 * -----------------------------------------------\n113 * 2020/05/13         V1.0             bert            \u521b\u5efa\n114 ***********************************************************************/\n115 void app_can_init(void)\n116 {\n117     /** \n118     * \u5e94\u7528\u5c42\u8fdb\u884cCAN1\u7ed3\u6784\u4f53\u6ce8\u518c\n119     */\n120     CAN1_contoller_add();\n121     \n122     /*\n123     *\u8c03\u7528can_set_controller\u8fdb\u884cCAN\u63a7\u5236\u5668\u914d\u7f6e\uff0c\n124     *\u8fd4\u56decan_port\uff0c\u7c7b\u6bd4linux socketcan\u4e2d\u7684\u5957\u63a5\u53e3\uff0c\u5355\u7247\u673a\u4f8b\u7a0b\u4e2d\u4f5c\u4e3a\u81ea\u5b9a\u4e49CAN\u901a\u9053 \n125     */\n126     gCAN_COMM_STRUCT.can_port = gCAN_COMM_STRUCT.can_set_controller();\n127     /** \n128     * \u8c03\u7528can_set_interrput\u914d\u7f6eCAN\u63a5\u6536\u4e2d\u65ad\uff0c\u7c7b\u6bd4socketcan\u4e2d\u7684\u63a5\u6536\u7ebf\u7a0b\uff0c\u672c\u4f8b\u4e0d\u7528\u63a5\u6536\uff0c\u56e0\u6b64\u56de\u8c03\u51fd\u6570\u4f20\u5165NULL\n129     */\n130     gCAN_COMM_STRUCT.can_set_interrput( gCAN_COMM_STRUCT.can_port, NULL );\n131 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u8bbe\u8ba1\u4e00\u4e2a\u7b80\u5355\u7684\u5468\u671f\u53d1\u9001\u62a5\u6587\u529f\u80fd"})}),"\n",(0,r.jsx)(e.p,{children:"\u6211\u4eec\u9700\u8981\u5148\u8bbe\u8ba1\u4e00\u4e2a\u572810ms\u5468\u671f\u51fd\u6570\u4e2d\u8c03\u7528\u7684void app_can_tx_test(void)\u529f\u80fd\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u5728main\u4e3b\u7ebf\u7a0b\u51fd\u6570\u4e2d\u8fdb\u884c\u8c03\u7528\u3002"}),"\n",(0,r.jsx)(e.p,{children:"CAN\u5468\u671f\u53d1\u9001\u62a5\u6587\u7684\u529f\u80fd\u51fd\u6570\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"134 /**********************************************************************\n135 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_tx_test(void)\n136 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u62a5\u6587\u53d1\u9001\u51fd\u6570\uff0c\u7528\u4e8e\u6d4b\u8bd5\u5468\u671f\u53d1\u9001\u62a5\u6587\n137 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n138 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n139 * \u8fd4 \u56de \u503c\uff1a \u65e0\n140 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n141 * -----------------------------------------------\n142 * 2020/05/13         V1.0             bert            \u521b\u5efa\n143 ***********************************************************************/\n144 void app_can_tx_test(void)\n145 {\n146     // \u4ee510ms\u4e3a\u57fa\u51c6\uff0c\u8fd0\u884cCAN\u6d4b\u8bd5\u7a0b\u5e8f\n147     \n148     unsigned char i=0;\n149     \n150     /* \u53d1\u9001\u62a5\u6587\u5b9a\u4e49 */\n151     CanTxMsg TxMessage;\n152     \n153     /* \u53d1\u9001\u62a5\u6587\u4e2d\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4f5c\u4e3a\u8ba1\u6570\u5668 */\n154     static unsigned char tx_counter = 0;\n155     \n156     /* \u4ee510ms\u4e3a\u57fa\u51c6\uff0c\u901a\u8fc7timer\u8ba1\u6570\u5668\u8bbe\u7f6e\u8be5\u5904\u7406\u51fd\u6570\u540e\u9762\u8fd0\u884c\u4ee3\u7801\u7684\u5468\u671f\u4e3a1\u79d2\u949f*/  \n157     static unsigned int timer =0;\n158     if(timer++>100)\n159     {\n160         timer = 0;\n161     }\n162     else\n163     {\n164         return ;\n165     }\n166     \n167     /* \u53d1\u9001\u62a5\u6587\u62a5\u6587\u6570\u636e\u586b\u5145\uff0c\u6b64\u62a5\u6587\u5468\u671f\u662f1\u79d2 */\n168     TxMessage.StdId = TX_CAN_ID;\t      /* \u6807\u51c6\u6807\u8bc6\u7b26\u4e3a0x000~0x7FF */\n169     TxMessage.ExtId = 0x0000;             /* \u6269\u5c55\u6807\u8bc6\u7b260x0000 */\n170     TxMessage.IDE   = CAN_ID_STD;         /* \u4f7f\u7528\u6807\u51c6\u6807\u8bc6\u7b26 */\n171     TxMessage.RTR   = CAN_RTR_DATA;       /* \u8bbe\u7f6e\u4e3a\u6570\u636e\u5e27  */\n172     TxMessage.DLC   = 8;                  /* \u6570\u636e\u957f\u5ea6, can\u62a5\u6587\u89c4\u5b9a\u6700\u5927\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u5b57\u8282 */\n173     \n174     /* \u586b\u5145\u6570\u636e\uff0c\u6b64\u5904\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u5e94\u7528\u586b\u5145 */\n175     TxMessage.Data[0] = tx_counter++;       /* \u7528\u6765\u8bc6\u522b\u62a5\u6587\u53d1\u9001\u8ba1\u6570\u5668 */\n176     for(i=1; i<TxMessage.DLC; i++)\n177     {\n178         TxMessage.Data[i] = i;            \n179     }\n180     \n181     /*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587 */\n182     gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n183     \n184 }\n185 \n"})}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u5c06void app_can_tx_test(void)\u51fd\u6570\u52a0\u5165\u5230main\u51fd\u6570\u4e2d\uff0c\u8fdb\u884c10ms\u5468\u671f\u6267\u884c\uff0c\u5176\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"188 /**********************************************************************\n189 * \u51fd\u6570\u540d\u79f0\uff1a int main(int argc, char **argv)\n190 * \u529f\u80fd\u63cf\u8ff0\uff1a \u4e3b\u51fd\u6570\n191 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n192 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n193 * \u8fd4 \u56de \u503c\uff1a \u65e0\n194 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n195 * -----------------------------------------------\n196 * 2020/05/13         V1.0             bert            \u521b\u5efa\n197 ***********************************************************************/\n198 int main(int argc, char **argv)\n199 {\n200     /* CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316 */\n201     app_can_init();\n202     \n203     while(1)\n204     {\n205         /* CAN\u5e94\u7528\u5c42\u5468\u671f\u53d1\u9001\u62a5\u6587 */\n206         app_can_tx_test();\n207         \n208         /* \u5229\u7528linux\u7684\u5ef6\u65f6\u51fd\u6570\u8bbe\u8ba110ms\u7684\u8fd0\u884c\u57fa\u51c6 */\n209         usleep(10000);\n210     }\n211 }\n"})}),"\n",(0,r.jsx)(e.h4,{id:"14433-\u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1",children:(0,r.jsx)(e.strong,{children:"14.4.3.3 \u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1"})}),"\n",(0,r.jsx)(e.p,{children:"\u5f53\u6211\u4eec\u4e0a\u9762\u4ee3\u7801\u5b8c\u6210\u7f16\u5199\u540e\uff0c\u76ee\u5f55\u6587\u4ef6\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0019.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09\u7f16\u5199Makfile"})}),"\n",(0,r.jsx)(e.p,{children:"Makefile\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"all:\n\tarm-linux-gnueabihf-gcc -lpthread -o socketcan_send   can_controller.c  app_can.c\nclean:\n\trm socketcan_send\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09\u7f16\u8bd1socket_send"})}),"\n",(0,r.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u7f16\u8bd1\u662f\u5728100ask-vmware_ubuntu18.04\u865a\u62df\u673a\u73af\u5883\u4e2d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u8fdb\u5165ubuntu\u865a\u62df\u673a\u5bf9\u5e94\u7684socket_send\u76ee\u5f55\u4e0b"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0020.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u8f93\u5165make\u547d\u4ee4\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0021.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u901a\u8fc7make\u547d\u4ee4\u7f16\u8bd1\u540e\uff0c\u751f\u6210socket_send\u53ef\u6267\u884c\u6587\u4ef6\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u8fd0\u884csocket_send"})}),"\n",(0,r.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u8fd0\u884c\u5728100ask_imx6\u5f00\u53d1\u677f\u4e0a\u8fd0\u884c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u6b64\u5904\u4f7f\u7528\u7684\u662fnfs\u6587\u4ef6\u8fdb\u884c\u8fd0\u884c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5148\u7ed9100ask_imx6ull\u5f00\u53d1\u677f\u4e0a\u7535\uff0c\u6253\u5f00\u4e32\u53e3\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0022.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u8f93\u5165root\u7528\u6237\u767b\u5f55\u8fdb\u5165\u5f00\u53d1\u677flinux\u7cfb\u7edf\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u6302\u8f7dnfs\uff0c\u64cd\u4f5c\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"Mount -t nfs -o nolock 192.168.1.100:/home/book  /mnt\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0023.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u76ee\u524d\u6211\u7684\u5f00\u53d1\u677fIP\uff1a192.168.1.101\uff0c Ubuntu\u865a\u62df\u673a\u662f192.168.1.100."}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u518d\u8fd0\u884c./socketcan_send"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u679c\u8fd0\u884c\u65f6\u63d0\u793a\u6743\u9650\u4e0d\u5141\u8bb8\uff0c\u53ef\u4ee5\u4f7f\u7528chmod\u547d\u4ee4\u8bbe\u7f6e\u6743\u9650:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"Chmod 777 socketcan_send\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u8fd0\u884c\u540e\u4e32\u53e3\u67e5\u770b\u6253\u5370\u4fe1\u606f\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0024.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u518d\u89c2\u5bdfVehcile Spy3\u4e0a\u4f4d\u673a\u6d4b\u8bd5\u7ed3\u679c\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\u62a5\u6587\u6309\u7167\u65f6\u95f41S\u7684\u5468\u671f\u6027\u53d1\u9001\u62a5\u6587ID\u4e3a0x101\u7684CAN\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0025.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09\u6d4b\u8bd5\u603b\u7ed3"})}),"\n",(0,r.jsx)(e.p,{children:"\u5230\u6b64\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u901a\u8fc7socketcan\u5efa\u7acb\u8d77\u6765\u4e86linux\u4e0b\u5e94\u7528\u7f16\u7a0b\u7684\u6846\u67b6\uff0c\u5e76\u4e14\u6210\u529f\u7684\u8c03\u8bd5\u6210\u529f\u4e86CAN\u5468\u671f\u53d1\u9001\u62a5\u6587\u7684\u529f\u80fd\u7f16\u7a0b\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u540e\u9762\u5c06\u57fa\u4e8e\u6b64\u6846\u67b6\uff0c\u4e00\u6b65\u4e00\u6b65\u7684\u4e86\u89e3linux\u4e0bCAN\u5e94\u7528\u7f16\u7a0b\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u5bf9\u4e8e\u76f8\u5173\u6848\u4f8b\u7ae0\u8282\u7684\u76ee\u7684\u8bbe\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u7ae0\u8282"}),(0,r.jsx)(e.th,{children:"\u76ee\u7684"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"14.4.3 socket_can\u7b80\u5355\u53d1\u9001\u5b9e\u4f8b"}),(0,r.jsx)(e.td,{children:"\u7b80\u5355\u76f4\u63a5\u7684\u4e86\u89e3\u53d1\u9001\u62a5\u6587"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"14.4.4 socket_can\u7b80\u5355\u63a5\u6536\u5b9e\u4f8b"}),(0,r.jsx)(e.td,{children:"\u7b80\u5355\u76f4\u63a5\u7684\u4e86\u89e3\u63a5\u6536\u62a5\u6587"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"14.4.5 socket_can\u63a5\u6536\u548c\u53d1\u9001\u5b9e\u4f8b"}),(0,r.jsx)(e.td,{children:"\u53d1\u9001\u548c\u63a5\u6536\u62a5\u6587\u7684\u7ec4\u5408\u64cd\u4f5c"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"1444-socket_can-\u7b80\u5355\u63a5\u6536\u5b9e\u4f8b",children:(0,r.jsx)(e.strong,{children:"14.4.4 socket_can \u7b80\u5355\u63a5\u6536\u5b9e\u4f8b"})}),"\n",(0,r.jsx)(e.p,{children:"\u7b80\u5355\u63a5\u6536\u5b9e\u4f8b\u4ee3\u7801\u76ee\u5f55\uff1a\u201c03_socketcan_recv\u201d"}),"\n",(0,r.jsx)(e.p,{children:"\u6211\u4eec\u572814.4.3\u7ae0\u8282\u5df2\u7ecf\u4e86\u89e3\u4e86\u53d1\u9001\u62a5\u6587\u53d1\u9001\u7684\u529f\u80fd\uff0c\u800c\u4e14\u5df2\u7ecf\u5efa\u7acb\u8d77\u4e86linux\u4e0b\u5e94\u7528\u7f16\u7a0b\u7684\u6846\u67b6\uff1b\u672c\u8282\u91cd\u70b9\u4e86\u89e3\u7b80\u5355\u63a5\u6536\u529f\u80fd\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u6848\u4f8b\u63cf\u8ff0\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"1.\u5b9e\u73b0\u63a5\u6536\u62a5\u65870x201\u7684\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.h4,{id:"14441-\u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570",children:(0,r.jsx)(e.strong,{children:"14.4.4.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09\u5b9a\u4e49CAN\u8bbe\u5907"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff081\uff09\u5b9a\u4e49CAN\u8bbe\u5907\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09\u914d\u7f6eCAN\u63a7\u5236\u5668"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff082\uff09\u914d\u7f6eCAN\u63a7\u5236\u5668\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u56e0\u4e3a\u5728\u201c14.4.3.1\u201d\u4e2d\u6211\u4eec\u53ea\u53d1\u9001\uff0c\u5e76\u4e14\u8bbe\u7f6e\u4e86\u8fc7\u6ee4\u5668\u4e3a\u7981\u6b62\u6240\u6709\u62a5\u6587\u3002\u5177\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"109 /*************************************************************/\n110 //\u7981\u7528\u8fc7\u6ee4\u89c4\u5219\uff0c\u672c\u8fdb\u7a0b\u4e0d\u63a5\u6536\u62a5\u6587\uff0c\u53ea\u8d1f\u8d23\u53d1\u9001\n111 setsockopt(sock_fd, SOL_CAN_RAW, CAN_RAW_FILTER, NULL, 0);  \n"})}),"\n",(0,r.jsx)(e.p,{children:"\u800c\u672c\u6848\u4f8b\u9700\u8981\u914d\u7f6e\u63a5\u6536\uff0c\u8fc7\u6ee4\u5668\u914d\u7f6e\u4f1a\u6709\u76f8\u5e94\u5dee\u5f02\uff0c\u6211\u4eec\u76ee\u524d\u662f\u914d\u7f6e\u4ec5\u4ec5\u63a5\u6536\u62a5\u6587ID\u4e3a0x201\u7684\u62a5\u6587\uff0c"}),"\n",(0,r.jsx)(e.p,{children:"\u5177\u4f53\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"110 \t//\u5b9a\u4e49\u63a5\u6536\u89c4\u5219\uff0c\u53ea\u63a5\u6536\u8868\u793a\u7b26\u7b49\u4e8e 0x201 \u7684\u62a5\u6587\n111 \tstruct can_filter rfilter[1];\n112 \trfilter[0].can_id = 0x201;\n113 \trfilter[0].can_mask = CAN_SFF_MASK;\n114 \t//\u8bbe\u7f6e\u8fc7\u6ee4\u89c4\u5219\n115 \tsetsockopt(sock_fd, SOL_CAN_RAW, CAN_RAW_FILTER, &rfilter, sizeof(rfilter));\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u4f5c\u4e3a\u6269\u5c55\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u591a\u4e2a\u8fc7\u6ee4\u5668\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"\u5b9a\u4e49\u8fc7\u6ee4\u5668\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"struct can_filter rfilter[5];  /*\u5b9a\u4e4910\u4e2a\u8fc7\u6ee4\u5668*/\nrfilter[0].can_id = 0x201;\nrfilter[0].can_mask = 0x7FF;  /*\u8fc7\u6ee4\u89c4\u5219\uff1acan_id & mask = 0x201 & 0x7FF = 0x201*/\nrfilter[1].can_id = 0x302;\nrfilter[1].can_mask = 0x7FF;  /*\u8fc7\u6ee4\u89c4\u5219\uff1acan_id & mask = 0x302& 0x7FF = 0x302*/\nrfilter[2].can_id = 0x403;\nrfilter[2].can_mask = 0x7FF;  /*\u8fc7\u6ee4\u89c4\u5219\uff1acan_id & mask = 0x403& 0x7FF = 0x403*/\nrfilter[3].can_id = 0x504;\nrfilter[3].can_mask = 0x700;  /*\u8fc7\u6ee4\u89c4\u5219\uff1acan_id & mask = 0x504 & 0x700 = 0x500,\u5373\u63a5\u6536\u62a5\u6587ID\u4e3a0x5**\u7684\u62a5\u6587*/\nrfilter[3].can_id = 0x605;\nrfilter[3].can_mask = 0x700;  /*\u8fc7\u6ee4\u89c4\u5219\uff1acan_id & mask = 0x504 & 0x700 = 0x600*/\nsetsockopt(sock_fd, SOL_CAN_RAW, CAN_RAW_FILTER, &rfilter, sizeof(rfilter));\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u521b\u5efaCAN\u63a5\u6536\u7ebf\u7a0b"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff083\uff09\u521b\u5efaCAN\u63a5\u6536\u7ebf\u7a0b\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff084\uff09CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff085\uff09CAN\u62a5\u6587\u53d1\u9001\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff085\uff09CAN\u62a5\u6587\u53d1\u9001\u51fd\u6570\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff086\uff09CAN\u62bd\u8c61\u7ed3\u6784\u4f53\u6846\u67b6\u521d\u59cb\u5316"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff086\uff09CAN\u62bd\u8c61\u7ed3\u6784\u4f53\u6846\u67b6\u521d\u59cb\u5316\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsxs)(e.h4,{id:"14442-\u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801",children:[(0,r.jsx)(e.strong,{children:"14.4.4.2"})," ",(0,r.jsx)(e.strong,{children:"\u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801"})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09CAN\u5e94\u7528\u5c42\u6ce8\u518c\u5b9e\u4f8b"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.2 \u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801\u201d\u4e2d\u201c\uff081\uff09CAN\u5e94\u7528\u5c42\u6ce8\u518c\u5b9e\u4f8b\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u672c\u7b80\u5355\u63a5\u6536\u5b9e\u4f8b\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u5c06\u63a5\u6536\u7ebf\u7a0b\u91cc\u7684\u56de\u8c03\u6307\u9488\u51fd\u6570CAN_RX_IRQHandler_Callback\u4f20\u5165\uff0c\u5728\u8fd9\u4e2a\u51fd\u6570\u91cc\uff0c\u5e94\u7528\u5c42\u53ef\u4ee5\u81ea\u884c\u8fdb\u884c\u8bfb\u53d6CAN\u62a5\u6587\u7b49\u5904\u7406\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"105 /**********************************************************************\n106 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_init(void)\n107 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316\n108 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n109 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n110 * \u8fd4 \u56de \u503c\uff1a \u65e0\n111 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n112 * -----------------------------------------------\n113 * 2020/05/13         V1.0             bert            \u521b\u5efa\n114 ***********************************************************************/\n115 void app_can_init(void)\n116 {\n117     /** \n118     * \u5e94\u7528\u5c42\u8fdb\u884cCAN1\u7ed3\u6784\u4f53\u6ce8\u518c\n119     */\n120     CAN1_contoller_add();\n121     \n122     /*\n123     *\u8c03\u7528can_set_controller\u8fdb\u884cCAN\u63a7\u5236\u5668\u914d\u7f6e\uff0c\n124     *\u8fd4\u56decan_port\uff0c\u7c7b\u6bd4linux socketcan\u4e2d\u7684\u5957\u63a5\u53e3\uff0c\u5355\u7247\u673a\u4f8b\u7a0b\u4e2d\u4f5c\u4e3a\u81ea\u5b9a\u4e49CAN\u901a\u9053 \n125     */\n126     gCAN_COMM_STRUCT.can_port = gCAN_COMM_STRUCT.can_set_controller();\n127     /** \n128     * \u8c03\u7528can_set_interrput\u914d\u7f6eCAN\u63a5\u6536\u4e2d\u65ad\uff0c\u7c7b\u6bd4socketcan\u4e2d\u7684\u63a5\u6536\u7ebf\u7a0b\n129     */\n130     gCAN_COMM_STRUCT.can_set_interrput( gCAN_COMM_STRUCT.can_port, CAN_RX_IRQHandler_Callback );\n131 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u8bbe\u8ba1\u4e00\u4e2a\u7b80\u5355\u7684\u63a5\u6536\u62a5\u6587\u529f\u80fd"})}),"\n",(0,r.jsx)(e.p,{children:"\u5173\u4e8evoid CAN_RX_IRQHandler_Callback(void)\u7684\u5177\u4f53\u5b9e\u73b0\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"CAN_RX_IRQHandler_Callback\u662f\u5728\u63a5\u6536\u7ebf\u7a0b\u4e2d\u5faa\u73af\u6267\u884c\uff0c\u5e94\u7528\u5c42\u5728CAN_RX_IRQHandler_Callback\u51fd\u6570\u8fdb\u884cgCAN_COMM_STRUCT.can_read\u8bfb\u53d6CAN\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"133 /**********************************************************************\n134 * \u51fd\u6570\u540d\u79f0\uff1a void CAN_RX_IRQHandler_Callback(void)\n135 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN1\u63a5\u6536\u4e2d\u65ad\u51fd\u6570\uff1b\u5728linux\u4e2d\u53ef\u4ee5\u7c7b\u6bd4\u7528\u7ebf\u7a0b\uff0c\u6216\u5b9a\u65f6\u5668\u53bb\u8bfbCAN\u6570\u636e\n136 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n137 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n138 * \u8fd4 \u56de \u503c\uff1a \u65e0\n139 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n140 * -----------------------------------------------\n141 * 2020/05/13         V1.0             bert            \u521b\u5efa\n142 ***********************************************************************/\n143 void CAN_RX_IRQHandler_Callback(void)\n144 {\n145     /* \u63a5\u6536\u62a5\u6587\u5b9a\u4e49 */\n146     CanRxMsg RxMessage; \n147     \n148     /* \u63a5\u6536\u62a5\u6587\u6e05\u96f6 */\n149     memset( &RxMessage, 0, sizeof(CanRxMsg) );\n150    \n151     /* \u901a\u8fc7can_read\u63a5\u53e3\u8bfb\u53d6\u5bc4\u5b58\u5668\u5df2\u7ecf\u63a5\u6536\u5230\u7684\u62a5\u6587 */\n152     gCAN_COMM_STRUCT.can_read(gCAN_COMM_STRUCT.can_port, &RxMessage);\n153 \n154     /* \u5c06\u8bfb\u53d6\u5230\u7684CAN\u62a5\u6587\u5b58\u62f7\u8d1d\u5230\u5168\u5c40\u62a5\u6587\u7ed3\u6784\u4f53g_CAN1_Rx_Message */\n155     memcpy(&g_CAN1_Rx_Message, &RxMessage, sizeof( CanRxMsg ) );\n156     \n157 }\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u672c\u6848\u4f8b\u65e0\u53d1\u9001\u62a5\u6587\u529f\u80fd\uff0c\u4e3b\u7ebf\u7a0b\u4e2d\u65e0\u4ee3\u7801\u5904\u7406\uff0c\u53ea\u9700\u8981\u7a7a\u8dd1\u8fd0\u884c\u5373\u53ef\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"159 /**********************************************************************\n160 * \u51fd\u6570\u540d\u79f0\uff1a int main(int argc, char **argv)\n161 * \u529f\u80fd\u63cf\u8ff0\uff1a \u4e3b\u51fd\u6570\n162 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n163 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n164 * \u8fd4 \u56de \u503c\uff1a \u65e0\n165 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n166 * -----------------------------------------------\n167 * 2020/05/13         V1.0             bert            \u521b\u5efa\n168 ***********************************************************************/\n169 int main(int argc, char **argv)\n170 {\n171     /* CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316 */\n172     app_can_init();\n173     \n174     while(1)\n175     {        \n176         /* \u5229\u7528linux\u7684\u5ef6\u65f6\u51fd\u6570\u8bbe\u8ba110ms\u7684\u8fd0\u884c\u57fa\u51c6 */\n177         usleep(10000);\n178     }\n179 }\n180 \n"})}),"\n",(0,r.jsxs)(e.h4,{id:"14443-\u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1",children:[(0,r.jsx)(e.strong,{children:"14.4.4.3"})," ",(0,r.jsx)(e.strong,{children:"\u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1"})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09\u7f16\u5199Makfile"})}),"\n",(0,r.jsx)(e.p,{children:"Makefile\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"all:\n\n   arm-linux-gnueabihf-gcc -lpthread -o socketcan_recv  can_controller.c app_can.c\n\nclean:\n\n   rm socketcan_recv\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09\u7f16\u8bd1socket_recv"})}),"\n",(0,r.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u7f16\u8bd1\u662f\u5728100ask-vmware_ubuntu18.04\u865a\u62df\u673a\u73af\u5883\u4e2d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u8fdb\u5165ubuntu\u865a\u62df\u673a\u5bf9\u5e94\u7684socket_recv\u76ee\u5f55\u4e0b\uff0c\u6267\u884cmake all\u8fdb\u884c\u7f16\u8bd1\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u7f16\u8bd1\u8fc7\u7a0b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0026.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u8fd0\u884csocket_recv"})}),"\n",(0,r.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u8fd0\u884c\u5728100ask_imx6\u5f00\u53d1\u677f\u4e0a\u8fd0\u884c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u6b64\u5904\u4f7f\u7528\u7684\u662fnfs\u6587\u4ef6\u8fdb\u884c\u8fd0\u884c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"Nfs\u6302\u8f7d\uff0c\u8bf7\u53c2\u8003\u201c14.4,3.3 \u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1\u201d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5728100ask_imx6\u5f00\u53d1\u677f\u73af\u5883\u4e0b\uff0c\u6267\u884c\u201c./socket_recv\u201d,\u8fd0\u884c\u7a0b\u5e8f\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u901a\u8fc7Vhicle Spy3\u5411100ask_imx6\u5f00\u53d1\u677fCAN\u7aef\u53d1\u9001\u62a5\u6587ID\u672a0x201\u7684\u62a5\u6587\uff0c\u62a5\u6587trace\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0027.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"100ask_imx6\u5f00\u53d1\u677f\u4e32\u53e3\u6253\u5370\u4fe1\u606f\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0028.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09\u6d4b\u8bd5\u603b\u7ed3"})}),"\n",(0,r.jsx)(e.p,{children:"\u5230\u6b64\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u8c03\u8bd5\u6210\u529f\u4e86CAN\u62a5\u6587\u63a5\u6536\u7684\u529f\u80fd\u7f16\u7a0b\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"1445-socket_can-\u63a5\u6536\u548c\u53d1\u9001\u5b9e\u4f8b",children:(0,r.jsx)(e.strong,{children:"14.4.5 socket_can \u63a5\u6536\u548c\u53d1\u9001\u5b9e\u4f8b"})}),"\n",(0,r.jsx)(e.p,{children:"\u7b80\u5355\u63a5\u6536\u5b9e\u4f8b\u4ee3\u7801\u76ee\u5f55\uff1a\u201c04_socketcan_recv_send\u201d"}),"\n",(0,r.jsx)(e.p,{children:"\u672c\u6848\u4f8b\u6574\u5408\u4e86\u201c14.4.3 \u7b80\u5355\u53d1\u9001\u5b9e\u4f8b\u201d\u548c\u201c14.4.3 \u7b80\u5355\u63a5\u6536\u5b9e\u4f8b\u201d\uff0c\u6784\u5efa\u6210\u4e00\u4e2a\u53d1\u9001\u548c\u63a5\u6536\u5747\u6709\u7684\u7ec4\u5408\u6848\u4f8b\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u6848\u4f8b\u63cf\u8ff0\uff1a"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u5b9e\u73b0\u5468\u671f1\u79d2\u53d1\u9001\u62a5\u6587ID\uff1a0x101\u7684\u62a5\u6587\uff1b"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u5b9e\u73b0\u63a5\u6536\u62a5\u65870x201\u7684\u62a5\u6587\uff0c\u5e76\u5c06\u5185\u5bb9\u590d\u5236\u5230\u62a5\u65870x301\u7684\u62a5\u6587\uff0c\u5e76\u53d1\u9001\u51fa\u53bb\uff1b"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"14451-\u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570",children:(0,r.jsx)(e.strong,{children:"14.4.5.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09\u5b9a\u4e49CAN\u8bbe\u5907"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff081\uff09\u5b9a\u4e49CAN\u8bbe\u5907\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.4.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff081\uff09\u5b9a\u4e49CAN\u8bbe\u5907\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09\u914d\u7f6eCAN\u63a7\u5236\u5668"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff082\uff09\u914d\u7f6eCAN\u63a7\u5236\u5668\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.4.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff082\uff09\u914d\u7f6eCAN\u63a7\u5236\u5668\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u521b\u5efaCAN\u63a5\u6536\u7ebf\u7a0b"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff083\uff09\u521b\u5efaCAN\u63a5\u6536\u7ebf\u7a0b\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.4.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff083\uff09\u521b\u5efaCAN\u63a5\u6536\u7ebf\u7a0b\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff084\uff09CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.4.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff084\uff09CAN\u62a5\u6587\u8bfb\u53d6\u51fd\u6570\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff085\uff09CAN\u62a5\u6587\u53d1\u9001\u51fd\u6570"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff085\uff09CAN\u62a5\u6587\u53d1\u9001\u51fd\u6570\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.4.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff085\uff09CAN\u62a5\u6587\u53d1\u9001\u51fd\u6570\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff086\uff09CAN\u62bd\u8c61\u7ed3\u6784\u4f53\u6846\u67b6\u521d\u59cb\u5316"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff086\uff09CAN\u62bd\u8c61\u7ed3\u6784\u4f53\u6846\u67b6\u521d\u59cb\u5316\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.4.1 \u7f16\u5199\u62bd\u8c61\u6846\u67b6\u7684\u5b9e\u73b0\u51fd\u6570\u201d\u4e2d\u201c\uff086\uff09CAN\u62bd\u8c61\u7ed3\u6784\u4f53\u6846\u67b6\u521d\u59cb\u5316\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"14.4.5.2"})," ",(0,r.jsx)(e.strong,{children:"\u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801"})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09CAN\u5e94\u7528\u5c42\u6ce8\u518c\u5b9e\u4f8b"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.2 \u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801\u201d\u4e2d\u201c\uff081\uff09CAN\u5e94\u7528\u5c42\u6ce8\u518c\u5b9e\u4f8b\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.4.2 \u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801\u201d\u4e2d\u201c\uff081\uff09CAN\u5e94\u7528\u5c42\u6ce8\u518c\u5b9e\u4f8b\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.4.2 \u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801\u201d\u4e2d\u201c\uff082\uff09CAN\u5e94\u7528\u5c42\u521d\u59cb\u5316\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u8bbe\u8ba1\u4e00\u4e2a\u7b80\u5355\u7684\u5468\u671f\u53d1\u9001\u62a5\u6587\u529f\u80fd"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.3.2 \u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801\u201d\u4e2d\u201c\uff083\uff09\u8bbe\u8ba1\u4e00\u4e2a\u7b80\u5355\u7684\u53d1\u9001\u62a5\u6587\u529f\u80fd\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09\u8bbe\u8ba1\u4e00\u4e2a\u7b80\u5355\u7684\u5468\u671f\u63a5\u6536\u62a5\u6587\u529f\u80fd"})}),"\n",(0,r.jsx)(e.p,{children:"\u53c2\u8003\u201c14.4.4.2 \u7f16\u5199\u5e94\u7528\u5c42\u4ee3\u7801\u201d\u4e2d\u201c\uff083\uff09\u8bbe\u8ba1\u4e00\u4e2a\u7b80\u5355\u7684\u63a5\u6536\u62a5\u6587\u529f\u80fd\u201d\u63cf\u8ff0\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u540c\u65f6\uff0c\u6211\u4eec\u6b64\u5904\u9700\u8981\u5c06\u63a5\u6536\u5230\u7684ID:0X201\u7684\u62a5\u6587\uff0c\u5c06\u5185\u5bb9\u590d\u5236\u7ed9\u62a5\u6587ID\uff1a0x301\u7684\u62a5\u6587\uff0c\u5e76\u53d1\u9001\u51fa\u53bb\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u6211\u4eec\u5728\u201c14.4.4 \u7b80\u5355\u63a5\u6536\u62a5\u6587\u201d\u7684\u57fa\u7840\u4e0a\u589e\u52a0\u4e00\u4e2a\u7b80\u5355\u7684\u903b\u8f91\uff0c\u5728\u63a5\u6536\u7ebf\u7a0b\u7684\u56de\u8c03\u51fd\u6570CAN_RX_IRQHandler_Callback\u4e2d\uff0c\u8c03\u7528gCAN_COMM_STRUCT.can_read(gCAN_COMM_STRUCT.can_port, &RxMessage);\u63a5\u6536\u5230\u62a5\u6587ID\uff1a0x201\u7684\u62a5\u6587\u540e\uff0c\u8bbe\u7f6e\u6807\u5fd7g_CAN1_Rx_Flag = 1; \u7136\u540e\u53bb\u4e3b\u7ebf\u7a0b\u53bb\u5224\u65ad\u6b64\u6807\u5fd7\u662f\u5426\u88ab\u8bbe\u7f6e\u4e3a1\uff0c\u6807\u8bc6\u5df2\u7ecf\u63a5\u6536\u5230\uff0c\u5219\u5728void app_can_rx_test(void)\u4e2d\u53bb\u62f7\u8d1d\u62a5\u6587ID:0X201\u7684\u62a5\u6587\u5185\u5bb9\uff0c\u7136\u540e\u8d4b\u503c\u7ed9\u62a5\u6587ID:0x301\u7684\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u63a5\u6536\u7ebf\u7a0b\u56de\u8c03\u51fd\u6570CAN_RX_IRQHandler_Callback\u7684\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"231 /**********************************************************************\n232 * \u51fd\u6570\u540d\u79f0\uff1a void CAN_RX_IRQHandler_Callback(void)\n233 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN1\u63a5\u6536\u4e2d\u65ad\u51fd\u6570\uff1b\u5728linux\u4e2d\u53ef\u4ee5\u7c7b\u6bd4\u7528\u7ebf\u7a0b\uff0c\u6216\u5b9a\u65f6\u5668\u53bb\u8bfbCAN\u6570\u636e\n234 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n235 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n236 * \u8fd4 \u56de \u503c\uff1a \u65e0\n237 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n238 * -----------------------------------------------\n239 * 2020/05/13         V1.0             bert            \u521b\u5efa\n240 ***********************************************************************/\n241 void CAN_RX_IRQHandler_Callback(void)\n242 {\n243     /* \u63a5\u6536\u62a5\u6587\u5b9a\u4e49 */\n244     CanRxMsg RxMessage; \n245     \n246     /* \u63a5\u6536\u62a5\u6587\u6e05\u96f6 */\n247     memset( &RxMessage, 0, sizeof(CanRxMsg) );\n248    \n249     /* \u901a\u8fc7can_read\u63a5\u53e3\u8bfb\u53d6\u5bc4\u5b58\u5668\u5df2\u7ecf\u63a5\u6536\u5230\u7684\u62a5\u6587 */\n250     gCAN_COMM_STRUCT.can_read(gCAN_COMM_STRUCT.can_port, &RxMessage);\n251 \n252     /* \u5c06\u8bfb\u53d6\u5230\u7684CAN\u62a5\u6587\u5b58\u62f7\u8d1d\u5230\u5168\u5c40\u62a5\u6587\u7ed3\u6784\u4f53g_CAN1_Rx_Message */\n253     memcpy(&g_CAN1_Rx_Message, &RxMessage, sizeof( CanRxMsg ) );\n254     \n255     /* \u8bbe\u7f6e\u5f53\u524d\u63a5\u6536\u5b8c\u6210\u6807\u5fd7\uff0c\u5224\u65ad\u5f53\u524d\u63a5\u6536\u62a5\u6587ID\u4e3aRX_CAN_ID\uff0c\u5219\u8bbe\u7f6eg_CAN1_Rx_Flag=1*/\n256     if( g_CAN1_Rx_Message.StdId == RX_CAN_ID )\n257     {\n258         g_CAN1_Rx_Flag = 1;  \n259     }\n260 }\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u4e3b\u7ebf\u7a0b\u4e2dapp_can_rx_test\u7684\u63a5\u6536\u89e6\u53d1\u5904\u7406\u51fd\u6570\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"187 /**********************************************************************\n188 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_rx_test(void)\n189 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u63a5\u6536\u62a5\u6587\u5904\u7406\u51fd\u6570\uff0c\u7528\u4e8e\u5904\u7406\u4e2d\u65ad\u51fd\u6570\u4e2d\u63a5\u6536\u7684\u62a5\u6587\n190 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n191 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n192 * \u8fd4 \u56de \u503c\uff1a \u65e0\n193 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n194 * -----------------------------------------------\n195 * 2020/05/13         V1.0             bert            \u521b\u5efa\n196 ***********************************************************************/\n197 void app_can_rx_test(void)\n198 {\n199     unsigned char i=0;\n200     \n201     /* \u53d1\u9001\u62a5\u6587\u5b9a\u4e49 */\n202     CanTxMsg TxMessage;\n203     \n204     /* \u53d1\u9001\u62a5\u6587\u4e2d\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4f5c\u4e3a\u8ba1\u6570\u5668 */\n205     static unsigned char rx_counter = 0;\n206     \n207     \n208     if( g_CAN1_Rx_Flag == 1)\n209     {\n210         g_CAN1_Rx_Flag = 0;\n211         \n212         /* \u53d1\u9001\u62a5\u6587\u62a5\u6587\u6570\u636e\u586b\u5145\uff0c\u6b64\u62a5\u6587\u5468\u671f\u662f1\u79d2 */\n213         TxMessage.StdId = RX_TO_TX_CAN_ID;\t  /* \u6807\u51c6\u6807\u8bc6\u7b26\u4e3a0x000~0x7FF */\n214         TxMessage.ExtId = 0x0000;             /* \u6269\u5c55\u6807\u8bc6\u7b260x0000 */\n215         TxMessage.IDE   = CAN_ID_STD;         /* \u4f7f\u7528\u6807\u51c6\u6807\u8bc6\u7b26 */\n216         TxMessage.RTR   = CAN_RTR_DATA;       /* \u8bbe\u7f6e\u4e3a\u6570\u636e\u5e27  */\n217         TxMessage.DLC   = 8;                  /* \u6570\u636e\u957f\u5ea6, can\u62a5\u6587\u89c4\u5b9a\u6700\u5927\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u5b57\u8282 */\n218         \n219         /* \u586b\u5145\u6570\u636e\uff0c\u6b64\u5904\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u5e94\u7528\u586b\u5145 */\n220         TxMessage.Data[0] = rx_counter++;      /* \u7528\u6765\u8bc6\u522b\u62a5\u6587\u53d1\u9001\u8ba1\u6570\u5668 */\n221         for(i=1; i<TxMessage.DLC; i++)\n222         {\n223             TxMessage.Data[i] = g_CAN1_Rx_Message.Data[i];            \n224         }\n225         \n226         /*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587 */\n227         gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n228     }\n229 }\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"14.4.5.3"})," ",(0,r.jsx)(e.strong,{children:"\u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1"})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09\u7f16\u5199Makfile"})}),"\n",(0,r.jsx)(e.p,{children:"Makefile\u6587\u4ef6\u5bb9\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"all:\n\n   arm-linux-gnueabihf-gcc -lpthread -o socketcan_recv_send  can_controller.c app_can.c\n\nclean:\n\n   rm socketcan_recv_send\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09\u7f16\u8bd1socket_recv_send"})}),"\n",(0,r.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u7f16\u8bd1\u662f\u5728100ask-vmware_ubuntu18.04\u865a\u62df\u673a\u73af\u5883\u4e2d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u8fdb\u5165ubuntu\u865a\u62df\u673a\u5bf9\u5e94\u7684socket_send\u76ee\u5f55\u4e0b\uff0c\u6267\u884cmake all\u8fdb\u884c\u7f16\u8bd1\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u7f16\u8bd1\u8fc7\u7a0b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0029.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u8fd0\u884csocket_recv_send"})}),"\n",(0,r.jsx)(e.p,{children:"\u6ce8\u610f\uff1a\u8fd0\u884c\u5728100ask_imx6\u5f00\u53d1\u677f\u4e0a\u8fd0\u884c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u6b64\u5904\u4f7f\u7528\u7684\u662fnfs\u6587\u4ef6\u8fdb\u884c\u8fd0\u884c\u3002"}),"\n",(0,r.jsx)(e.p,{children:"Nfs\u6302\u8f7d\uff0c\u8bf7\u53c2\u8003\u201c14.4,3.3 \u6848\u4f8b\u6d4b\u8bd5\u9a8c\u8bc1\u201d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5728100ask_imx6\u5f00\u53d1\u677f\u73af\u5883\u4e0b\uff0c\u6267\u884c\u201c./socket_recv_send\u201d,\u8fd0\u884c\u7a0b\u5e8f\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u901a\u8fc7Vhicle Spy3\u5411100ask_imx6\u5f00\u53d1\u677fCAN\u7aef\u53d1\u9001\u62a5\u6587ID\u672a0x201\u7684\u62a5\u6587\uff0c\u62a5\u6587trace\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0030.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u89c2\u5bdf100ask_imx6\u5f00\u53d1\u4e32\u53e3\u6253\u5370\u4fe1\u606f\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0028.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09\u6d4b\u8bd5\u603b\u7ed3"})}),"\n",(0,r.jsx)(e.p,{children:"\u5230\u6b64\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u8c03\u8bd5\u6210\u529f\u4e86CAN\u62a5\u6587\u63a5\u6536\u548c\u53d1\u9001\u7684\u529f\u80fd\u7f16\u7a0b\u3002"}),"\n",(0,r.jsxs)(e.h2,{id:"145-\u6c7d\u8f66\u884c\u4e1acan\u603b\u7ebf\u5e94\u7528",children:[(0,r.jsx)(e.strong,{children:"14.5"})," ",(0,r.jsx)(e.strong,{children:"\u6c7d\u8f66\u884c\u4e1aCAN\u603b\u7ebf\u5e94\u7528"})]}),"\n",(0,r.jsxs)(e.h3,{id:"1451-\u8f66\u5382can\u603b\u7ebf\u9700\u6c42",children:[(0,r.jsx)(e.strong,{children:"14.5.1"})," ",(0,r.jsx)(e.strong,{children:"\u8f66\u5382CAN\u603b\u7ebf\u9700\u6c42"})]}),"\n",(0,r.jsx)(e.p,{children:"CAN\u603b\u7ebf\u5e94\u7528\u6700\u5e7f\u6cdb\u7684\u5e94\u8be5\u662f\u6c7d\u8f66\u9886\u57df\uff0c\u51e0\u4e4e\u6240\u6709\u7684\u8f66\u5747\u652f\u6301CAN\u603b\u7ebf\uff0c\u5728\u8fd9\u91cc\u5c31\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e9b\u6c7d\u8f66\u76f8\u5173\u7684CAN\u603b\u7ebf\u9700\u6c42\u3002"}),"\n",(0,r.jsxs)(e.h4,{id:"14511-\u7f51\u7edc\u62d3\u6251\u7ed3\u6784",children:[(0,r.jsx)(e.strong,{children:"14.5.1.1"})," ",(0,r.jsx)(e.strong,{children:"\u7f51\u7edc\u62d3\u6251\u7ed3\u6784"})]}),"\n",(0,r.jsx)(e.p,{children:"\u4e0b\u9762\u8fd9\u5f20\u7f51\u7edc\u62d3\u6251\u56fe\u548c\u6211\u5f00\u53d1\u8fc7\u7684\u5927\u90e8\u5206\u5b9e\u9645\u8f66\u8f86\u62d3\u6251\u5927\u81f4\u4e00\u81f4\u3002\u4e00\u822c\u662f\u6c7d\u8f66\u5382\u5546\u63d0\u4f9b\u7ed9\u96f6\u90e8\u4ef6\u4f9b\u5e94\u5546\u7684\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0032.png",alt:"\u56fe14.5.1 \u6574\u8f66\u7f51\u7edc\u62d3\u6251"})}),"\n",(0,r.jsx)(e.p,{children:"\u4e00\u822c\u8f66\u8eab\u7f51\u7edc\u5206\u4e3a\u5982\u4e0b6\u4e2a\u5c40\u57dfCAN\u7f51\u7edc\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u8f66\u8f86\u62d3\u6251\u5206\u7ec4"}),(0,r.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"PT CAN (PowerTrain CAN )   \u52a8\u529b\u603b\u6210CAN\u603b\u7ebf"}),(0,r.jsx)(e.td,{children:"\u4e3b\u8981\u8d1f\u8d23\u8f66\u8f86\u52a8\u529b\u76f8\u5173\u7684ECU\u7ec4\u7f51\uff0c\u662f\u6574\u8f66\u8981\u6c42\u4f20\u8f93\u901f\u7387\u6700\u9ad8\u7684\u4e00\u8defCAN\u7f51\u7edc\uff1b  \u4e00\u822c\u5305\u62ec\u5982\u4e0b\u76f8\u5173ECU\u5355\u5143\uff1a  ECM(Engine Control  Module\uff09\u53d1\u52a8\u673a\u63a7\u5236\u6a21\u5757\uff1b  SRS (  SupplementalRestraintSystem) \u7535\u5b50\u5b89\u5168\u6c14\u56ca   BMS ( Battery Management System ) \u7535\u6c60\u7ba1\u7406\u7cfb\u7edf   EPB Electronic Park Brake, \u7535\u5b50\u9a7b\u8f66\u7cfb\u7edf"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"CH CAN   (Chassis CAN)   \u5e95\u76d8\u63a7\u5236CAN\u603b\u7ebf"}),(0,r.jsx)(e.td,{children:"CH CAN\u8d1f\u8d23\u6c7d\u8f66\u5e95\u76d8\u53ca4\u4e2a\u8f6e\u5b50\u7684\u5236\u52a8/\u7a33\u5b9a/\u8f6c\u5411\uff0c\u7531\u4e8e\u6d89\u53ca\u6574\u8f66\u5236\u52a8/\u52a9\u529b\u8f6c\u5411\u7b49, \u6240\u4ee5\u5176\u7f51\u7edc\u4fe1\u53f7\u4f18\u5148\u7ea7\u4e5f\u662f\u8f83\u9ad8\u7684\u3002  \u4e00\u822c\u5305\u62ec\u5982\u4e0b\u76f8\u5173ECU\u5355\u5143\uff1a  ABS ( Antilock Brake  System ) \u9632\u62b1\u6b7b\u5236\u52a8\u7cfb\u7edf  ESP(Electronic  Stability Program)\u8f66\u8eab\u7535\u5b50\u7a33\u5b9a\u7cfb\u7edf  EPS(Electric Power  Steering)\u7535\u5b50\u8f6c\u5411\u52a9\u529b"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Body CAN  \u8f66\u8eab\u63a7\u5236\u603b\u7ebf"}),(0,r.jsx)(e.td,{children:"Body CAN\u8d1f\u8d23\u8f66\u8eab\u4e0a\u7684\u4e00\u4e9b\u63d0\u9ad8\u8212\u9002\u6027/\u5b89\u5168\u6027\u7684\u667a\u80fd\u786c\u4ef6\u7684\u7ba1\u7406\u4e0e\u63a7\u5236\uff0c\u5176\u7f51\u7edc\u4fe1\u53f7\u4f18\u5148\u7ea7\u8f83\u4f4e, \u56e0\u4e3a\u4ee5\u4e0a\u8bbe\u5907\u90fd\u662f\u8f85\u52a9\u8bbe\u5907\u3002  \u4e00\u822c\u5305\u62ec\u5982\u4e0b\u76f8\u5173ECU\u5355\u5143\uff1a AC ( Air Condition ) \u7a7a\u8c03  AVM(Around View  Monitor) 360\u73af\u89c6  BCM(Body Control  Module) \u5929\u7a97, \u8f66\u7a97, \u96fe\u706f, \u8f6c\u5411\u706f, \u96e8\u522e\u2026  IMMO(Immobilizer) \u53d1\u52a8\u673a\u9632\u76d7\u7cfb\u7edf  TPMS(Tire Pressure  Monitoring System) \u80ce\u538b\u76d1\u63a7\u7cfb\u7edf"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Info CAN   ( Infomercial CAN )   \u5a31\u4e50\u7cfb\u7edf\u603b\u7ebf"}),(0,r.jsx)(e.td,{children:"Info CAN\u662f\u8f85\u52a9\u53ef\u9009\u8bbe\u5907, \u6240\u4ee5\u4f18\u5148\u7ea7\u4e5f\u662f\u8f83\u4f4e\u7684\uff0c\u4e3b\u8981\u8d1f\u8d23\u8f66\u8eab\u4e0a\u7684\u4e00\u4e9b\u63d0\u9ad8\u5a31\u4e50\u6027\u7684\u667a\u80fd\u786c\u4ef6\u7684\u7ba1\u7406\u4e0e\u63a7\u5236\u3002  \u4e00\u822c\u5305\u62ec\u5982\u4e0b\u76f8\u5173ECU\u5355\u5143\uff1a  VAES( Video Audio  Entertainment System) \u8f66\u8f7d\u5a31\u4e50\u7cfb\u7edf(\u4e2d\u63a7)  IP(Instrument Pack) \u7ec4\u5408\u4eea\u8868, \u5f53\u4eca\u7684\u6570\u5b57\u4eea\u8868, \u57fa\u672c\u6709\u97f3\u4e50, \u5730\u56fe, \u901a\u8bdd\u7b49\u5a31\u4e50\u529f\u80fd."})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"DiagCAN   ( Diagnose CAN )   \u8bca\u65ad\u63a7\u5236\u603b\u7ebf"}),(0,r.jsx)(e.td,{children:"DiagCAN\u603b\u7ebf\u4e3b\u8981\u63d0\u4f9b\u8fdc\u7a0b\u8bca\u65ad\u529f\u80fd\uff0c\u53ea\u6709\u4e00\u4e2aECU:   Tbox(Telematics BOX) \u8fdc\u7a0b\u63a7\u5236\u6a21\u5757"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"OBD CAN"}),(0,r.jsx)(e.td,{children:"OBD\u4e00\u822c\u662f\u63d0\u4f9b\u5916\u63a5\u8bca\u65ad\u4eea\uff0c\u57fa\u672c\u662f\u63a5\u5728\u6574\u8f66\u7f51\u5173ECU\u4e0a\u3002"})]})]})]}),"\n",(0,r.jsx)(e.h4,{id:"14512-can-\u62a5\u6587\u5206\u7c7b",children:(0,r.jsx)(e.strong,{children:"14.5.1.2 CAN \u62a5\u6587\u5206\u7c7b"})}),"\n",(0,r.jsx)(e.p,{children:"\u5728\u6c7d\u8f66CAN\u7f51\u7edc\u91cc\u9762\uff0cCAN\u62a5\u6587\u4e3b\u8981\u5206\u4e3a\u4e09\u79cd\uff1a\u5e94\u7528\u62a5\u6587\uff0c\u7f51\u7edc\u62a5\u6587\uff0c\u548c\u8bca\u65ad\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4e0d\u8bba\u662f\u7f51\u7edc\u62a5\u6587\uff0c\u8fd8\u662f\u8bca\u65ad\u62a5\u6587\uff0c\u5747\u662f\u6309\u7167\u4e0d\u540c\u7684\u529f\u80fd\u9700\u6c42\u5212\u5206\u7684\uff0c\u6839\u636e\u4e0d\u540c\u7684\u9700\u6c42\uff0c\u5236\u5b9aCAN\u62a5\u6587\u6570\u636e\u7684\u4e0d\u540c\u534f\u8bae\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09CAN\u5e94\u7528\u62a5\u6587"})}),"\n",(0,r.jsx)(e.p,{children:"CAN\u5e94\u7528\u62a5\u6587\uff0c\u4e3b\u8981\u7528\u4e8e\u8f66\u8eab\u7f51\u7edc\u4e2d\u4e0d\u540cECU\u8282\u70b9\u4e4b\u95f4\u7684\u6570\u636e\u4fe1\u606f\u7684\u53d1\u9001\u548c\u63a5\u6536\uff0c\u4e0e\u5177\u4f53\u5e94\u7528\u529f\u80fd\u76f8\u5173\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u6c7d\u8f66CAN\u5e94\u7528\u62a5\u6587\uff0c\u7531\u8f66\u5382\u8fdb\u884c\u5b9a\u4e49\u548c\u53d1\u5e03\u201c\u4fe1\u53f7\u77e9\u9635\u8868\uff08excel\u683c\u5f0f\uff09\u201d\u548c\u201c\u4fe1\u53f7\u77e9\u9635\uff08DBC\u683c\u5f0f\uff09\u201d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u8be6\u89c1\u201c14.5.2 CAN\u5e94\u7528\u62a5\u6587\u5e94\u7528\u5206\u6790\u53ca\u5b9e\u4f8b\u201d\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09CAN\u7f51\u7edc\u7ba1\u7406\u62a5\u6587"})}),"\n",(0,r.jsx)(e.p,{children:"\u6c7d\u8f66\u7535\u5b50\u7cfb\u7edf\u901a\u8fc7\u8f66\u8f7d\u7f51\u7edc\u5bf9\u6240\u6709\u7684ECU \u8fdb\u884c\u914d\u7f6e\u7ba1\u7406\u548c\u534f\u8c03\u5de5\u4f5c\u7684\u8fc7\u7a0b\u79f0\u4e4b\u4e3a\u7f51\u7edc\u7ba1\u7406\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u7f51\u7edc\u7ba1\u7406\u53ef\u4ee5\u901a\u8fc7\u5bf9\u4e8e\u7f51\u7edc\u4e0a\u7684\u5404\u4e2a ECU \u7684\u63a7\u5236\uff0c\u53d1\u51fa\u4e00\u4e9b\u547d\u4ee4\u89c4\u5219\uff0c\u5b9e\u73b0\u5404\u4e2a ECU \u7684\u534f\u540c\u7761\u7720\u548c\u5524\u9192\uff0c\u7528\u4e8e\u534f\u540c\u63a7\u5236\u7684CAN\u62a5\u6587\uff0c\u5c31\u662f\u7f51\u7edc\u7ba1\u7406\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u7f51\u7edc\u7ba1\u7406\u6709OSEK\u7f51\u7edc\u7ba1\u7406\u548cAUTOSAR\u7f51\u7edc\u7ba1\u7406\u4e24\u79cd\u3002\u4e00\u822c\u524d\u88c5\u8f66\u5382\u9879\u76ee\u624d\u4f1a\u8981\u6c42\u652f\u6301\u7f51\u7edc\u7ba1\u7406\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09CAN\u8bca\u65ad\u62a5\u6587"})}),"\n",(0,r.jsx)(e.p,{children:"CAN\u8bca\u65ad\u4e3b\u8981\u662f\u662f\u5b9e\u73b0\u8f66\u8f86\u7684\u529f\u80fd\u76d1\u63a7\uff0c\u6545\u969c\u68c0\u6d4b\uff0c\u8bb0\u5f55/\u5b58\u50a8\u6545\u969c\u4fe1\u606f\uff0c\u5b58\u50a8/\u8bfb\u53d6\u6570\u636e\uff0c\u8fd8\u6709EOL\u4e0b\u7ebf\u68c0\u6d4b\uff0cECU\u5347\u7ea7\u7b49\u529f\u80fd\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u57fa\u4e8eCAN\u7684\u901a\u4fe1\u5206\u5c42\u6a21\u578b\uff1a"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"OSI\u5206\u5c42"}),(0,r.jsx)(e.th,{children:"\u8f66\u5382\u8bca\u65ad\u6807\u51c6"}),(0,r.jsx)(e.th,{children:"OBD\u6807\u51c6"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u8bca\u65ad\u5e94\u7528"}),(0,r.jsx)(e.td,{children:"\u7528\u6237\u5b9a\u4e49"}),(0,r.jsx)(e.td,{children:"ISO15031-5"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5e94\u7528\u5c42"}),(0,r.jsx)(e.td,{children:"ISO15765-3 / ISO14229-1"}),(0,r.jsx)(e.td,{children:"ISO15031-5"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u8868\u793a\u5c42"}),(0,r.jsx)(e.td,{children:"\u65e0"}),(0,r.jsx)(e.td,{children:"\u65e0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u4f1a\u8bdd\u5c42"}),(0,r.jsx)(e.td,{children:"ISO15765-3"}),(0,r.jsx)(e.td,{children:"ISO15765-4"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u4f20\u8f93\u5c42"}),(0,r.jsx)(e.td,{children:"\u65e0"}),(0,r.jsx)(e.td,{children:"\u65e0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u7f51\u7edc\u5c42"}),(0,r.jsx)(e.td,{children:"ISO15765-2"}),(0,r.jsx)(e.td,{children:"ISO15765-4"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u6570\u636e\u94fe\u8def\u5c42"}),(0,r.jsx)(e.td,{children:"ISO11898-1"}),(0,r.jsx)(e.td,{children:"ISO15765-4"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u7269\u7406\u5c42"}),(0,r.jsx)(e.td,{children:"\u7528\u6237\u5b9a\u4e49"}),(0,r.jsx)(e.td,{children:"ISO15765-4"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0034.png",alt:"\u56fe CAN\u8bca\u65ad\u670d\u52a1OSI\u6a21\u578b"})}),"\n",(0,r.jsx)(e.h3,{id:"1452-can-\u5e94\u7528\u62a5\u6587\u5e94\u7528\u5206\u6790\u53ca\u5b9e\u4f8b",children:(0,r.jsx)(e.strong,{children:"14.5.2 CAN \u5e94\u7528\u62a5\u6587\u5e94\u7528\u5206\u6790\u53ca\u5b9e\u4f8b"})}),"\n",(0,r.jsx)(e.h4,{id:"14521-can-\u5e94\u7528\u62a5\u6587\u5b9a\u4e49",children:(0,r.jsx)(e.strong,{children:"14.5.2.1 CAN \u5e94\u7528\u62a5\u6587\u5b9a\u4e49"})}),"\n",(0,r.jsx)(e.p,{children:"\u5f53\u4e00\u4e2a\u8f66\u5382\u9879\u76ee\u542f\u52a8\u4e4b\u540e\uff0c\u6839\u636e\u9879\u76ee\u7684\u9700\u6c42\uff0c\u8f66\u5382\u4f1a\u63d0\u4f9bCAN\u4fe1\u53f7\u77e9\u9635\uff08excel\uff09\uff0c\u548cDBC\u4fe1\u53f7\u77e9\u9635\u6570\u636e\u5e93\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09CAN\u4fe1\u53f7\u77e9\u9635-excel\u683c\u5f0f"})}),"\n",(0,r.jsx)(e.p,{children:"\u8f66\u5382\u63d0\u4f9b\u7684\u4fe1\u53f7\u77e9\u9635\uff08excel\uff09\u7684\u6587\u4ef6\u683c\u5f0f\uff0c\u8be6\u89c1\u7b2c14\u7ae0\u4ee3\u7801\u76ee\u5f55\uff1aCAN_Signal_Matrix.xlsx\uff0c"}),"\n",(0,r.jsx)(e.p,{children:"\u4eceCAN_Signal_Matrix.xlsx\u4e2d\u622a\u53d6\u62a5\u6587\u5b9a\u4e49\uff0c\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"ECU_TX_MSG1: (\u5468\u671f\u53d1\u9001\u62a5\u6587\uff0cID\uff1a0x123\uff09"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0035.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"ECU_TX_MSG2: (\u4e8b\u4ef6\u53d1\u9001\u62a5\u6587\uff0cID\uff1a0x124\uff09"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0036.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"ECU_TX_MSG3: (\u5468\u671f&\u4e8b\u4ef6\u53d1\u9001\u62a5\u6587\uff0cID\uff1a0x125\uff09"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0037.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"ECU_RX_MSG1:(\u4e8b\u4ef6\u63a5\u6536\u62a5\u6587\uff0cID: 0X201)"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0038.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u4ece\u4e0a\u62a5\u6587\u5b9a\u4e49\u53ef\u4ee5\u770b\u51fa\uff0c\u8f66\u5382\u4f1a\u5b9a\u4e49\u62a5\u6587\u7684\u5f88\u591a\u5c5e\u6027\uff0c\u5982\u62a5\u6587\u540d\u79f0\uff0c\u62a5\u6587ID,\u62a5\u6587\u957f\u5ea6, \u62a5\u6587\u5468\u671f\uff0c\u62a5\u6587\u53d1\u9001\u7c7b\u578b\uff0c \u4ee5\u53ca\u62a5\u6587\u4e2d\u7684\u4fe1\u53f7\u540d\u79f0\uff0c\u4fe1\u53f7\u8d77\u59cb\u5b57\u8282\uff0c\u4fe1\u53f7\u957f\u5ea6\uff0c\u6392\u5217\u683c\u5f0f\uff08Intel\u6216Motorala\uff09\uff0c\u4fe1\u53f7\u7684\u53d6\u503c\u8303\u56f4\uff0c\u4fe1\u53f7\u7684\u53d1\u9001\u65b9\u5f0f\u7b49\u7b49\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\uff082\uff09CAN\u4fe1\u53f7\u77e9\u9635-DBC"}),"\n",(0,r.jsx)(e.p,{children:"\u672c\u7ae0\u63d0\u4f9b\u7684\u793a\u4f8bCAN\u77e9\u9635\u201cCAN_Signal_Matrix.xlsx\u201d\u5bf9\u5e94\u7684DBC\u6587\u4ef6\uff0c\u8be5DBC\u6587\u4ef6\u4f7f\u7528vector CANdb+ Editor\u7f16\u8f91\uff1b\u5982\u4e0b\u56fe\u6240\u793a\u4e3aDBC\u6587\u4ef6\u6240\u663e\u793a\u7684\u62a5\u6587\u4fe1\u606f\u5185\u5bb9\uff0c\u548cexcel\u8868\u683c\u6240\u5c55\u793a\u5185\u5bb9\u662f\u4e00\u81f4\u7684\uff0c\u6587\u4ef6\u683c\u5f0f\u4e0d\u662f\u6700\u5173\u952e\u7684\uff0c\u53ea\u8981\u7406\u89e3\u8f66\u5382\u5bf9CAN\u4fe1\u53f7\u7684\u8981\u6c42\u5373\u53ef\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0039.png",alt:"\u56fe CAN\u4fe1\u53f7\u77e9\u9635DBC"})}),"\n",(0,r.jsx)(e.h4,{id:"14522-can\u5e94\u7528\u62a5\u6587\u53d1\u9001\u89c4\u5219",children:"14.5.2.2 CAN\u5e94\u7528\u62a5\u6587\u53d1\u9001\u89c4\u5219"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u6211\u4eec\u63d0\u5230\u8f66\u5382\u4f1a\u63d0\u4f9bCAN\u4fe1\u53f7\u77e9\u9635\u8868\uff0c\u4f1a\u5b9a\u4e49\u5468\u671f\u62a5\u6587\uff0c\u4e8b\u4ef6\u62a5\u6587\uff0c\u5468\u671f\u4e8b\u4ef6\u6df7\u5408\u62a5\u6587\uff0c\u90a3\u4e48\u5b9a\u4e49\u8fd9\u4e9b\u4fe1\u53f7\u7684\u901a\u7528\u89c4\u5219\u5728\u54ea\u91cc\uff1f\u4e00\u822c\u8f66\u5382\u4f1a\u63d0\u4f9b\u5173\u4e8eCAN\u603b\u7ebf\u7684\u901a\u4fe1\u89c4\u8303\uff0c\u8f66\u5382\u6839\u636e\u901a\u4fe1\u89c4\u8303\u624d\u5b9a\u4e49\u51faCAN\u4fe1\u53f7\u77e9\u9635\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u4e0b\u9762\u662f\u67d0\u8f66\u5382\u7684\u901a\u4fe1\u89c4\u8303\u300aXXX Communication Requirement Specification.pdf\u300b\uff0c\u5176\u89c4\u8303\u76ee\u5f55\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u4ece\u76ee\u5f55\u53ef\u4ee5\u770b\u51fa\uff0c\u4e3b\u8981\u4ecb\u7ecdCAN\u7269\u7406\u5c42\uff0c\u6570\u636e\u94fe\u8def\u5c42\uff0c\u901a\u4fe1\u4ea4\u4e92\u5c42\u7b49\u76f8\u5173\u89c4\u5219\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u672c\u5c0f\u8282\uff0c\u6211\u4eec\u4e3b\u8981\u4ecb\u7ecd\u5e94\u7528\u62a5\u6587\u76f8\u5173\u7684\u901a\u4fe1\u4ea4\u4e92\u5c42\u201c4 Interaction Layer\u201d\u76f8\u5173\u7684\u5185\u5bb9\uff1aCAN\u62a5\u6587\u53d1\u9001\u7c7b\u578b\uff08Message Send Type\uff09\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0040.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"CAN\u62a5\u6587\u53d1\u9001\u7c7b\u578b\u6309\u7167\u4e4b\u524d\u77e9\u9635\u8868\u5c55\u793a\u7684\u9010\u4e00\u4ecb\u7ecd\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09\u5468\u671f\u578b\u62a5\u6587\uff08Cyclic Message\uff09"})}),"\n",(0,r.jsx)(e.p,{children:"\u5468\u671f\u62a5\u6587\uff0c\u5373\u4e3a\u5468\u671f\u5b9a\u65f6\u53d1\u9001\uff0c\u5468\u671f\u4e3aT\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0042.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u5f53\u7cfb\u7edf\u8fd0\u884c\u540e\uff0cECU\u5c31\u6309\u7167\u5468\u671fT\u5b9a\u65f6\u53d1\u9001CAN\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09\u4e8b\u4ef6\u578b\u62a5\u6587\uff08Event Message\uff09"})}),"\n",(0,r.jsx)(e.p,{children:"\u89e6\u53d1\u4e8b\u4ef6\u65f6\u53d1\u9001\u4e8b\u4ef6\u578b\u6d88\u606f\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0043.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u5f53\u7cfb\u7edf\u8fd0\u884c\u540e\uff0cECU\u5e76\u4e0d\u4e3b\u52a8\u53d1\u9001\u4e8b\u4ef6\u578b\u62a5\u6587\uff0c\u800c\u662f\u5f53ECU\u88ab\u67d0\u4e00\u6761\u4ef6\u89e6\u53d1\uff08Event\uff09\uff0c\u5219ECU\u4f1a\u8fde\u7eed\u53d1\u9001\u4e09\u5e27\u4e8b\u4ef6\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5f53\u7136\u8f66\u5382\u8981\u6c42\u4e0d\u4ec5\u4ec5\u5982\u6b64\uff0c\u8f66\u5382\u8fd8\u4f1a\u6709\u66f4\u591a\u5176\u4ed6\u8981\u6c42\uff0c"}),"\n",(0,r.jsx)(e.p,{children:"\u6bd4\u5982\uff0c"}),"\n",(0,r.jsx)(e.p,{children:"\u8981\u6c421,\uff1a\u89e6\u53d1\u53d1\u9001\u4e09\u5e27\u62a5\u6587\u540e\uff0c\u8981\u6c42\u4fe1\u53f7\u6062\u590d\u4e3a\u9ed8\u8ba4\u503c\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"\u8981\u6c422\uff1a\u89e6\u53d1\u53d1\u9001\u4e09\u5e27\uff0c\u5e27\u4e0e\u5e27\u95f4\u95f4\u9694\u8981\u6c4250ms;"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u5468\u671f\u4e8b\u4ef6\u578b\u62a5\u6587\uff08Cyclic And Event Message\uff09"})}),"\n",(0,r.jsx)(e.p,{children:"\u200b\t\t\u5468\u671f\u4e8b\u4ef6\u6df7\u5408\u578b\u62a5\u6587\uff08\u7b80\u79f0CE\uff09\uff0c\u5f53\u65e0\u4e8b\u4ef6\u89e6\u53d1\u7684\u60c5\u51b5\u4e0b\uff0c\u6309\u7167\u5468\u671fT\u5b9a\u65f6\u53d1\u9001\u62a5\u6587\uff0c\u5f53\u6709\u4e8b\u4ef6\u89e6\u53d1\u7684\u60c5\u51b5\u4e0b\uff0c\u6309\u7167event\u4e8b\u4ef6\u89e6\u53d1\u65b9\u5f0f\u53d1\u9001\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0044.png",alt:""})}),"\n",(0,r.jsx)(e.p,{children:"\u5b9e\u9645\u8f66\u5382\u5b9a\u4e49\u7684CAN\u62a5\u6587\u53d1\u9001\u7c7b\u578b\u5e76\u4e0d\u4ec5\u4ec5\u662f\u4e0a\u9762\u4e09\u79cd\uff0c\u4f46\u662f\u8fd9\u4e09\u79cd\u662f\u6700\u91cd\u8981\u7684\u53d1\u9001\u65b9\u5f0f\u3002"}),"\n",(0,r.jsx)(e.h4,{id:"14523-\u6c7d\u8f66can\u5e94\u7528\u62a5\u6587\u53d1\u9001\u5e94\u7528\u5b9e\u4f8b",children:"14.5.2.3 \u6c7d\u8f66CAN\u5e94\u7528\u62a5\u6587\u53d1\u9001\u5e94\u7528\u5b9e\u4f8b"}),"\n",(0,r.jsx)(e.p,{children:"\u901a\u8fc7\u4e0a\u4e00\u5c0f\u8282\u7684\u63cf\u8ff0\uff0c\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u4e86\u8f66\u5382\u89c4\u8303\u4e2d\u4e09\u4e2a\u5e94\u7528\u62a5\u6587\u53d1\u9001\u7c7b\u578b\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u5f00\u59cb\u5728100ask_imx6\u5f00\u53d1\u677f\u4e0a\u8fdb\u884c\u8bd5\u9a8c\uff0c\u5b9e\u73b0\u8f66\u5382\u5e94\u7528\u62a5\u6587\u7684\u9700\u6c42\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5173\u4e8elinux socketcan\u7684\u5e94\u7528\u7f16\u7a0b\u6846\u67b6\u6211\u4eec\u5df2\u7ecf\u5728\u201c14.4 linux socketcan\u57fa\u7840\u5e94\u7528\u7f16\u7a0b\u201d\u8be6\u7ec6\u8bb2\u89e3\u4e86\uff0c\u6211\u4eec\u73b0\u5728\u5c31\u57fa\u4e8e\u201c14.4.5 socketcan\u63a5\u6536\u548c\u53d1\u9001\u5b9e\u4f8b\u201d\u8fdb\u884c\u672c\u7ae0\u6848\u4f8b\u5e94\u7528\u7f16\u7a0b\uff0c\u91cd\u70b9\u4fa7\u91cd\u4e8eapp_can.c\u7f16\u7a0b\uff0ccan_controller.c\u53ef\u4ee5\u5b8c\u5168\u6cbf\u7528\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4ee5\u4e0b\u5e94\u7528\u7f16\u7a0b\uff0c\u6211\u4eec\u4f7f\u752814.5.2.1\u4e2d\u4ecb\u7ecd\u7684CAN\u62a5\u6587\u77e9\u9635\u4e2d\u7684CAN\u62a5\u6587\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff081\uff09linux can\u7f16\u7a0b\u6846\u67b6\u51c6\u5907"})}),"\n",(0,r.jsx)(e.p,{children:"\u4f7f\u7528\u6848\u4f8b\u201c04_socketcan_recv_send\u201d\u4ee3\u7801\uff0c\u590d\u5236\u6587\u4ef6\u5939\u6539\u540d\u4e3a\u201c06_socketcan_ecu_application\u201d\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u5728app_can.c\u6587\u4ef6\u4e2d\u5b9a\u4e49\u62a5\u6587ID:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"30 /**************\u5b8f\u5b9a\u4e49**************************************************/\n31 /* \u672c\u4f8b\u7a0b\u4e2d\u6d4b\u8bd5\u5468\u671f\u53d1\u9001\u7684CAN\u62a5\u6587ID */\n32 #define TX_CAN_CYCLIC_ID    0X123\n33 #define TX_CAN_EVENT_ID     0X124\n34 #define TX_CAN_CE_ID        0X125\n35 \n36 /* \u672c\u4f8b\u7a0b\u4e2d\u6d4b\u8bd5\u63a5\u6536\u7684CAN\u62a5\u6587ID */\n37 #define RX_CAN_ID           0x201   \n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff082\uff09\u5468\u671f\u578b\u62a5\u6587\u5b9e\u73b0"})}),"\n",(0,r.jsx)(e.p,{children:"\u5b9e\u73b0\u529f\u80fd\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"A.\u7f16\u7a0b\u5b9e\u73b0\u5468\u671f\u53d1\u9001\u62a5\u6587ID:0x123\uff0c \u5468\u671fT\u4e3a1000ms\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"136 /**********************************************************************\n137 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_cyclicmsg_test(void)\n138 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u6d4b\u8bd5\u53d1\u9001\u5468\u671f\u578b\u62a5\u6587(ID:0X123)\n139 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n140 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n141 * \u8fd4 \u56de \u503c\uff1a \u65e0\n142 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n143 * -----------------------------------------------\n144 * 2020/05/13         V1.0             bert            \u521b\u5efa\n145 ***********************************************************************/\n146 void app_can_cyclicmsg_test(void)\n147 {\n148     // \u4ee510ms\u4e3a\u57fa\u51c6\uff0c\u8fd0\u884cCAN\u6d4b\u8bd5\u7a0b\u5e8f\n149     \n150     unsigned char i=0;\n151     \n152     /* \u53d1\u9001\u62a5\u6587\u5b9a\u4e49 */\n153     CanTxMsg TxMessage;\n154     \n155     /* \u53d1\u9001\u62a5\u6587\u4e2d\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4f5c\u4e3a\u8ba1\u6570\u5668 */\n156     static unsigned char tx_counter = 0;\n157     \n158     /* \u4ee510ms\u4e3a\u57fa\u51c6\uff0c\u901a\u8fc7timer\u8ba1\u6570\u5668\u8bbe\u7f6e\u8be5\u5904\u7406\u51fd\u6570\u540e\u9762\u8fd0\u884c\u4ee3\u7801\u7684\u5468\u671f\u4e3a1\u79d2\u949f*/  \n159     static unsigned int timer =0;\n160     if(timer++>100)\n161     {\n162         timer = 0;\n163     }\n164     else\n165     {\n166         return ;\n167     }\n168     \n169     /* \u53d1\u9001\u62a5\u6587\u62a5\u6587\u6570\u636e\u586b\u5145\uff0c\u6b64\u62a5\u6587\u5468\u671f\u662f1\u79d2 */\n170     TxMessage.StdId = TX_CAN_CYCLIC_ID;\t  /* \u6807\u51c6\u6807\u8bc6\u7b26\u4e3a0x000~0x7FF */\n171     TxMessage.ExtId = 0x0000;             /* \u6269\u5c55\u6807\u8bc6\u7b260x0000 */\n172     TxMessage.IDE   = CAN_ID_STD;         /* \u4f7f\u7528\u6807\u51c6\u6807\u8bc6\u7b26 */\n173     TxMessage.RTR   = CAN_RTR_DATA;       /* \u8bbe\u7f6e\u4e3a\u6570\u636e\u5e27  */\n174     TxMessage.DLC   = 8;                  /* \u6570\u636e\u957f\u5ea6, can\u62a5\u6587\u89c4\u5b9a\u6700\u5927\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u5b57\u8282 */\n175     \n176     /* \u586b\u5145\u6570\u636e\uff0c\u6b64\u5904\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u5e94\u7528\u586b\u5145 */\n177     TxMessage.Data[0] = tx_counter++;       /* \u7528\u6765\u8bc6\u522b\u62a5\u6587\u53d1\u9001\u8ba1\u6570\u5668 */\n178     for(i=1; i<TxMessage.DLC; i++)\n179     {\n180         TxMessage.Data[i] = i;            \n181     }\n182     \n183     /*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587 */\n184     gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n185     \n186 }\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff083\uff09\u4e8b\u4ef6\u578b\u62a5\u6587\u5b9e\u73b0"})}),"\n",(0,r.jsx)(e.p,{children:"\u5b9e\u73b0\u529f\u80fd\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"A.   \u7f16\u7a0b\u5b9e\u73b0\u5f53\u63a5\u6536\u5230\u4e00\u5e27\u62a5\u6587\uff08ID\uff1a0x201\uff09\u7684\u4fe1\u53f7ECU_RX_MSG1_signal1=1\u65f6\uff0c\u89e6\u53d1\u53d1\u9001\u4e8b\u4ef6\u578b\u62a5\u6587\uff08ID:0x124\uff09\uff0c\u8ba9ECU_MSG2_signal2\uff08Byte1\u5b57\u8282\uff09=2 \u4e14\u4e24\u5e27\u62a5\u6587\u95f4\u65f6\u95f4\u95f4\u9694\u4e3a50ms\u3002"}),"\n",(0,r.jsx)(e.p,{children:"B.   \u4e8b\u4ef6\u89e6\u53d1\u6761\u4ef6\uff1a\u63a5\u6536\u5230\u62a5\u6587(ID:0x201)\uff0c\u4e14ECU_RX_MSG1_signal1\uff08Byte0\u5b57\u8282bit0\uff09\u4e3a1"}),"\n",(0,r.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'188 /**********************************************************************\n189 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_eventmsg_test(void)\n190 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u6d4b\u8bd5\u53d1\u9001\u4e8b\u4ef6\u578b\u62a5\u6587(ID:0X124)\n191 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n192 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n193 * \u8fd4 \u56de \u503c\uff1a \u65e0\n194 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n195 * -----------------------------------------------\n196 * 2020/05/13         V1.0             bert            \u521b\u5efa\n197 ***********************************************************************/\n198 void app_can_eventmsg_test(void)\n199 {\n200     unsigned char i=0;\n201 \n202     /* \u53d1\u9001\u62a5\u6587\u4e2d\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4f5c\u4e3a\u4e8b\u4ef6\u89e6\u53d1\u8ba1\u6570\u5668 */\n203     static unsigned char tx_counter = 0;\n204 \n205     /* \u53d1\u9001\u62a5\u6587\u5b9a\u4e49 */\n206     CanTxMsg TxMessage;\n207 \n208     if( g_CAN1_Rx_Event_Flag == 1 )\n209     {\n210 \tg_CAN1_Rx_Event_Flag = 0;\n211 \tprintf("Message:0x124 is Triggered!\\n");\n212 \n213         /* \u53d1\u9001\u62a5\u6587\u62a5\u6587\u6570\u636e\u586b\u5145\uff0c\u6b64\u62a5\u6587\u5468\u671f\u662f1\u79d2 */\n214         TxMessage.StdId = TX_CAN_EVENT_ID;\t  /* \u6807\u51c6\u6807\u8bc6\u7b26\u4e3a0x000~0x7FF */\n215         TxMessage.ExtId = 0x0000;             /* \u6269\u5c55\u6807\u8bc6\u7b260x0000 */\n216         TxMessage.IDE   = CAN_ID_STD;         /* \u4f7f\u7528\u6807\u51c6\u6807\u8bc6\u7b26 */\n217         TxMessage.RTR   = CAN_RTR_DATA;       /* \u8bbe\u7f6e\u4e3a\u6570\u636e\u5e27  */\n218         TxMessage.DLC   = 8;                  /* \u6570\u636e\u957f\u5ea6, can\u62a5\u6587\u89c4\u5b9a\u6700\u5927\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u5b57\u8282 */\n219         \n220         /* \u586b\u5145\u6570\u636e\uff0c\u6b64\u5904\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u5e94\u7528\u586b\u5145 */\n221         for(i=0; i<TxMessage.DLC; i++)\n222         {\n223             TxMessage.Data[i] = 0x00;            \n224         }\n225         /* \u586b\u5145\u6570\u636e\uff0c\u6b64\u5904\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u5e94\u7528\u586b\u5145 */\n226 \ttx_counter = 0;\n227 \t\n228 \t/*\u66f4\u65b0\u7b2c1\u5e27\u6570\u636e*/\n229 \tTxMessage.Data[1] = 0x02;\n230 \tTxMessage.Data[7] = (++tx_counter);\n231         /*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587\uff0c\u7b2c1\u5e27 */\n232         gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n233 \t/*\u5ef6\u65f650ms,\u4f5c\u4e3a\u4e8b\u4ef6\u62a5\u6587\u95f4\u9694*/\n234 \tusleep(50000);\n235 \n236 \t/*\u66f4\u65b0\u7b2c2\u5e27\u6570\u636e*/\n237 \tTxMessage.Data[1] = 0x02;\n238 \tTxMessage.Data[7] = (++tx_counter);\n239 \t/*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587\uff0c\u7b2c2\u5e27 */\n240         gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n241 \t/*\u5ef6\u65f650ms,\u4f5c\u4e3a\u4e8b\u4ef6\u62a5\u6587\u95f4\u9694*/\n242 \tusleep(50000);\n243 \n244 \t/*\u66f4\u65b0\u7b2c3\u5e27\u6570\u636e*/\n245 \tTxMessage.Data[1] = 0x02;\n246 \tTxMessage.Data[7] = (++tx_counter);\n247 \t/*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587\uff0c\u7b2c3\u5e27 */\n248         gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n249 \t/*\u5ef6\u65f650ms,\u4f5c\u4e3a\u4e8b\u4ef6\u62a5\u6587\u95f4\u9694*/\n250 \tusleep(50000);\n251     }\n252 }\n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09\u5468\u671f\u4e8b\u4ef6\u578b\u62a5\u6587\u5b9e\u73b0"})}),"\n",(0,r.jsx)(e.p,{children:"\u5b9e\u73b0\u529f\u80fd\uff1a"}),"\n",(0,r.jsx)(e.p,{children:"A.   \u7f16\u7a0b\u5b9e\u73b0\u5468\u671f\u53d1\u9001\u62a5\u6587\uff08ID\uff1a0x125\uff09\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"B.   \u800c\u5f53\u63a5\u6536\u5230\u4e00\u5e27\u62a5\u6587\uff08ID\uff1a0x201\uff09\u7684\u4fe1\u53f7ECU_RX_MSG1_signal2=1\u65f6\uff0c\u89e6\u53d1\u53d1\u9001\u5468\u671f\u4e8b\u4ef6\u578b\u62a5\u6587\uff08ID:0x125\uff09\uff0c \u8ba9ECU_MSG3_signal9\uff08Byte1\u5b57\u8282bit0\uff09=1\uff0c\u4e14\u8fde\u7eed\u53d1\u9001\u4e09\u5e27\uff0c\u4e14\u4e24\u5e27\u62a5\u6587\u95f4\u65f6\u95f4\u95f4\u9694\u4e3a50ms\uff0c\u4e09\u5e27\u53d1\u9001\u5b8c\u6210\u540e\u6062\u590d\u6210ECU_MSG3_signal5=0\uff1b"}),"\n",(0,r.jsx)(e.p,{children:"A.   \u4e8b\u4ef6\u89e6\u53d1\u6761\u4ef6\uff1a\u63a5\u6536\u5230\u62a5\u6587(ID:0x201)\uff0c\u4e14ECU_RX_MSG1_signal2\uff08Byte0\u5b57\u8282bit1\uff09\u4e3a1"}),"\n",(0,r.jsx)(e.p,{children:"\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:'255 /**********************************************************************\n256 * \u51fd\u6570\u540d\u79f0\uff1a void app_can_cycliceventmsg_test(void)\n257 * \u529f\u80fd\u63cf\u8ff0\uff1a CAN\u5e94\u7528\u5c42\u6d4b\u8bd5\u53d1\u9001\u5468\u671f\u4e8b\u4ef6\u6df7\u5408\u62a5\u6587(ID:0X125)\n258 * \u8f93\u5165\u53c2\u6570\uff1a \u65e0\n259 * \u8f93\u51fa\u53c2\u6570\uff1a \u65e0\n260 * \u8fd4 \u56de \u503c\uff1a \u65e0\n261 * \u4fee\u6539\u65e5\u671f             \u7248\u672c\u53f7        \u4fee\u6539\u4eba           \u4fee\u6539\u5185\u5bb9\n262 * -----------------------------------------------\n263 * 2020/05/13         V1.0             bert            \u521b\u5efa\n264 ***********************************************************************/\n265 void app_can_cycliceventmsg_test(void)\n266 {\n267     unsigned char i=0;\n268     \n269     /* \u53d1\u9001\u62a5\u6587\u5b9a\u4e49 */\n270     CanTxMsg TxMessage;\n271     \n272     /* \u53d1\u9001\u62a5\u6587\u4e2d\u7528\u4e00\u4e2a\u5b57\u8282\u6765\u4f5c\u4e3a\u4e8b\u4ef6\u89e6\u53d1\u8ba1\u6570\u5668 */\n273     static unsigned char tx_counter = 0;\n274 \n275     /* \u4ee510ms\u4e3a\u57fa\u51c6\uff0c\u901a\u8fc7timer\u8ba1\u6570\u5668\u8bbe\u7f6e\u8be5\u5904\u7406\u51fd\u6570\u540e\u9762\u8fd0\u884c\u4ee3\u7801\u7684\u5468\u671f\u4e3a1\u79d2\u949f*/  \n276     static unsigned int timer =0;\n277 \n278     if( g_CAN1_Rx_CE_Flag == 1)\n279     {\n280 \tg_CAN1_Rx_CE_Flag = 0;\n281 \tprintf("Message:0x125 is Triggered!\\n");\n282 \n283 \t/* \u53d1\u9001\u62a5\u6587\u62a5\u6587\u6570\u636e\u586b\u5145\uff0c\u6b64\u62a5\u6587\u5468\u671f\u662f1\u79d2 */\n284         TxMessage.StdId = TX_CAN_CE_ID;\t     /* \u6807\u51c6\u6807\u8bc6\u7b26\u4e3a0x000~0x7FF */\n285         TxMessage.ExtId = 0x0000;             /* \u6269\u5c55\u6807\u8bc6\u7b260x0000 */\n286         TxMessage.IDE   = CAN_ID_STD;         /* \u4f7f\u7528\u6807\u51c6\u6807\u8bc6\u7b26 */\n287         TxMessage.RTR   = CAN_RTR_DATA;       /* \u8bbe\u7f6e\u4e3a\u6570\u636e\u5e27  */\n288         TxMessage.DLC   = 8;                  /* \u6570\u636e\u957f\u5ea6, can\u62a5\u6587\u89c4\u5b9a\u6700\u5927\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u5b57\u8282 */\n289         \n290         /* \u6e05\u96f6\u6570\u636e\u533a */\n291         for(i=0; i<TxMessage.DLC; i++)\n292         {\n293             TxMessage.Data[i] = 0x00;            \n294         }\n295 \t/* \u586b\u5145\u6570\u636e\uff0c\u6b64\u5904\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u5e94\u7528\u586b\u5145 */\n296 \ttx_counter = 0;\n297 \n298         /*\u66f4\u65b0\u7b2c1\u5e27\u6570\u636e*/\n299 \tTxMessage.Data[1] = 0x01;\n300 \tTxMessage.Data[7] = (++tx_counter);\n301         /*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587\uff0c\u7b2c1\u5e27 */\n302         gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n303 \t/*\u5ef6\u65f650ms,\u4f5c\u4e3a\u4e8b\u4ef6\u62a5\u6587\u95f4\u9694*/\n304 \tusleep(50000);\n305 \n306 \t/*\u66f4\u65b0\u7b2c2\u5e27\u6570\u636e*/\n307 \tTxMessage.Data[1] = 0x01;\n308 \tTxMessage.Data[7] = (++tx_counter);\n309 \t/*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587\uff0c\u7b2c2\u5e27 */\n310         gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n311 \t/*\u5ef6\u65f650ms,\u4f5c\u4e3a\u4e8b\u4ef6\u62a5\u6587\u95f4\u9694*/\n312 \tusleep(50000);\n313 \n314 \t/*\u66f4\u65b0\u7b2c3\u5e27\u6570\u636e*/\n315 \tTxMessage.Data[1] = 0x01;\n316 \tTxMessage.Data[7] = (++tx_counter);\n317 \t/*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587\uff0c\u7b2c3\u5e27 */\n318         gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n319 \t/*\u5ef6\u65f650ms,\u4f5c\u4e3a\u4e8b\u4ef6\u62a5\u6587\u95f4\u9694*/\n320 \tusleep(50000);\n321     }\n322 \n323     /* \u4ee510ms\u4e3a\u57fa\u51c6\uff0c\u901a\u8fc7timer\u8ba1\u6570\u5668\u8bbe\u7f6e\u8be5\u5904\u7406\u51fd\u6570\u540e\u9762\u8fd0\u884c\u4ee3\u7801\u7684\u5468\u671f\u4e3a1\u79d2\u949f*/  \n324     if(timer++>100)\n325     {\n326         timer = 0;\n327     }\n328     else\n329     {\n330         return ;\n331     }\n332 \n333     /* \u53d1\u9001\u62a5\u6587\u62a5\u6587\u6570\u636e\u586b\u5145\uff0c\u6b64\u62a5\u6587\u5468\u671f\u662f1\u79d2 */\n334     TxMessage.StdId = TX_CAN_CE_ID;\t  /* \u6807\u51c6\u6807\u8bc6\u7b26\u4e3a0x000~0x7FF */\n335     TxMessage.ExtId = 0x0000;             /* \u6269\u5c55\u6807\u8bc6\u7b260x0000 */\n336     TxMessage.IDE   = CAN_ID_STD;         /* \u4f7f\u7528\u6807\u51c6\u6807\u8bc6\u7b26 */\n337     TxMessage.RTR   = CAN_RTR_DATA;       /* \u8bbe\u7f6e\u4e3a\u6570\u636e\u5e27  */\n338     TxMessage.DLC   = 8;                  /* \u6570\u636e\u957f\u5ea6, can\u62a5\u6587\u89c4\u5b9a\u6700\u5927\u7684\u6570\u636e\u957f\u5ea6\u4e3a8\u5b57\u8282 */\n339         \n340     /* \u586b\u5145\u6570\u636e\uff0c\u6b64\u5904\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u5e94\u7528\u586b\u5145 */\n341     for(i=1; i<TxMessage.DLC; i++)\n342     {\n343 \tTxMessage.Data[i] = 0x00;            \n344     }\n345      \n346     /*  \u8c03\u7528can_write\u53d1\u9001CAN\u62a5\u6587 */\n347     gCAN_COMM_STRUCT.can_write(gCAN_COMM_STRUCT.can_port, TxMessage);\n348 }\n'})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uff084\uff09\u6848\u4f8b\u6d4b\u8bd5"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u7b2c\u4e00\u6b65\uff1a\u6d4b\u8bd5\u5468\u671f\u62a5\u6587"})}),"\n",(0,r.jsxs)(e.p,{children:["\u8fd0\u884csocket_ecu_test\uff0c\u4e32\u53e3\u6253\u5370\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff1a\n",(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0031.png",alt:""})]}),"\n",(0,r.jsx)(e.p,{children:"\u7136\u540e\u89c2\u5bdfVehicle Spy3\u8f6f\u4ef6\u83b7\u53d6\u7684\u62a5\u6587trace\uff0c\u5982\u4e0b\u6240\u793a\uff1a\n\u62a5\u6587ID:0x123,0x125\u4e24\u4e2a\u62a5\u6587\u5747\u4ee51000ms\u7684\u5468\u671f\u53d1\u9001\u62a5\u6587\uff1b"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0046.png",alt:""})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u7b2c\u4e8c\u6b65\uff1a\u6d4b\u8bd5\u4e8b\u4ef6\u578b\u62a5\u6587"}),"\n\u5728Vehicle Spy3\u8f6f\u4ef6\u4e0aMessages\u91cc\u9762\u8fc7\u6ee4\u51fa\u62a5\u6587ID:0X201,0X124.\n\u7136\u540e\u624b\u52a8\u70b9\u51fb\u53f3\u4fa7\u7684Tx Panel\u4e0a\u7684ID:0X201\u7684\u62a5\u6587\uff0c\u5de6\u4fa7Messages\u7684\u8bb0\u5f55\u4e3a100ask_imx6\u5f00\u53d1\u677f\u53d1\u51fa3\u5e27ID:0x124\u7684\u62a5\u6587\u3002\n\u901a\u8fc7\u5f00\u53d1\u677f\u4e32\u53e3\u6253\u5370\u4fe1\u606f\u770b\u51fa\uff1a\u201cMessage:0x124 is Triggered!\u201d,\u5728\u8fd9\u6761\u6253\u5370\u4fe1\u606f\u4e4b\u540e\uff0c\u5b58\u5728\u4e09\u5e27ID:0x124\u7684\u62a5\u6587\u3002\n",(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0047.png",alt:""}),"\n\u89c2\u5bdf\u51fa\u5de6\u4fa7\u7684Messages\u7684trace\u5982\u4e0b\u56fe\u6240\u793a\uff1a\n",(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0048.png",alt:""}),"\n",(0,r.jsx)(e.strong,{children:"\u7b2c\u4e09\u6b65\uff1a\u6d4b\u8bd5\u5468\u671f\u4e8b\u4ef6\u578b\u62a5\u6587"}),"\n\u5728Vehicle Spy3\u8f6f\u4ef6\u4e0aMessages\u91cc\u9762\u8fc7\u6ee4\u51fa\u62a5\u6587ID:0X201,0X125.\n\u7136\u540e\u624b\u52a8\u70b9\u51fb\u53f3\u4fa7\u7684Tx Panel\u4e0a\u7684ID:0X201\u7684\u62a5\u6587\uff0c\u5de6\u4fa7Messages\u7684\u8bb0\u5f55\u4e3a100ask_imx6\u5f00\u53d1\u677f\u53d1\u51fa3\u5e27ID:0x125\u7684\u62a5\u6587\uff0c\u4f46\u662f\u62a5\u6587\u6570\u636e\u4e0e\u9ed8\u8ba4\u6570\u636e\u4e0d\u540c\uff0c\u6570\u636e\u5185\u5bb9Byte7\u4f9d\u6b21\u4e3a0x01,0x02,0x03\u3002\n\u901a\u8fc7\u5f00\u53d1\u677f\u4e32\u53e3\u6253\u5370\u4fe1\u606f\u770b\u51fa\uff1a\u201cMessage:0x125 is Triggered!\u201d,\u5728\u8fd9\u6761\u6253\u5370\u4fe1\u606f\u4e4b\u540e\uff0c\u5b58\u5728\u4e09\u5e27ID:0x124\u7684\u62a5\u6587\u3002\n",(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0049.png",alt:""}),"\n\u89c2\u5bdf\u51fa\u5de6\u4fa7\u7684Messages\u7684trace\u5982\u4e0b\u56fe\u6240\u793a\uff1a\nID:0X125\u6b63\u5e38\u60c5\u51b5\u4e0b\u4ee51000ms\u7684\u5468\u671f\u53d1\u9001\u9ed8\u8ba4\u62a5\u6587\uff0c\u5f53ID:201\u7684\u62a5\u6587\u89e6\u53d1\u4e8b\u4ef6\uff0c\u5f15\u8d77ID:0X125\u53d1\u9001\u4e8b\u4ef6\u62a5\u6587\u3002\n",(0,r.jsx)(e.strong,{children:"\uff085\uff09\u4e8b\u4ef6\u62a5\u6587\u53d1\u9001\u6539\u8fdb"}),"\n\u901a\u8fc7\u524d\u9762\u6b65\u9aa4\uff0c\u6211\u4eec\u5df2\u7ecf\u4e86\u89e3\u5e94\u7528\u62a5\u6587\u7684\u53d1\u9001\u7c7b\u578b\u548c\u5b9e\u73b0\u4e0d\u540c\u53d1\u9001\u7c7b\u578b\u7684\u65b9\u5f0f\uff0c\u4f46\u662f\u4e0a\u9762\u4e8b\u4ef6\u5904\u7406\u6709\u4e00\u4e2a\u7f3a\u9677\uff0c\u5c31\u662f\u5f53\u4e8b\u4ef6\u89e6\u53d1\u65f6\uff0c\u53d1\u9001\u65f6\u901a\u8fc7ucsleep()\u51fd\u6570\u5b9e\u73b0\u7684\u62a5\u6587\u95f4\u9694\uff0c\u8fd9\u4e2a\u5ef6\u65f6\u4f1a\u4f7f\u5f97\u5468\u671f\u62a5\u6587\u7684\u5468\u671f\u53d8\u957f\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u901a\u8fc7\u89c2\u5bdfCAN\u62a5\u6587trace\u67e5\u627e\u5230\u3002\n\u8fd9\u91cc\u5bf9\u6848\u4f8b\u201c06_socketcan_ecu_application\u201d\u505a\u4e86\u4e00\u4e2a\u5c0f\u5c0f\u7684\u6539\u8fdb\uff0c\u5bf9\u89e6\u53d1\u4e8b\u4ef6\u7684\u5904\u7406\u91c7\u7528\u5468\u671f\u8ba1\u6570\u6765\u5b9e\u73b0\uff0c\u5177\u4f53\u8bf7\u67e5\u770b\u6848\u4f8b\u4ee3\u7801\u201c07_socketcan_ecu_application_new\u201d\u3002\n",(0,r.jsx)(e.img,{src:"http://photos.100ask.net/NewHomeSite/LinuxCan_Image0050.png",alt:""})]})]})}function _(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(x,{...n})}):x(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>d});var r=s(6540);const t={},c=r.createContext(t);function i(n){const e=r.useContext(c);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:i(n.components),r.createElement(c.Provider,{value:e},n.children)}}}]);