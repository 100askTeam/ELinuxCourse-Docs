"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5197],{8453:(e,n,d)=>{d.d(n,{R:()=>i,x:()=>l});var s=d(6540);const t={},r=s.createContext(t);function i(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(r.Provider,{value:n},e.children)}},9350:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>j,frontMatter:()=>r,metadata:()=>l,toc:()=>h});var s=d(4848),t=d(8453);const r={},i="16 MQTT\u534f\u8bae\u5206\u6790",l={id:"Study-Notes/yuxuan/MQTT",title:"16 MQTT\u534f\u8bae\u5206\u6790",description:"16.1 mqtt\u534f\u8bae\u4ecb\u7ecd",source:"@site/docs/Study-Notes/yuxuan/16_MQTT.md",sourceDirName:"Study-Notes/yuxuan",slug:"/Study-Notes/yuxuan/MQTT",permalink:"/en/docs/Study-Notes/yuxuan/MQTT",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/linux-docs/tree/main/docs/Study-Notes/yuxuan/16_MQTT.md",tags:[],version:"current",sidebarPosition:16,frontMatter:{},sidebar:"StudyNotes",previous:{title:"\u7389\u8f69\u7b14\u8bb0",permalink:"/en/docs/category/\u7389\u8f69\u7b14\u8bb0"}},c={},h=[{value:"16.1 mqtt\u534f\u8bae\u4ecb\u7ecd",id:"161-mqtt\u534f\u8bae\u4ecb\u7ecd",level:2},{value:"16.1.1 \u6982\u8ff0",id:"1611-\u6982\u8ff0",level:3},{value:"16.1.2 \u7279\u70b9",id:"1612-\u7279\u70b9",level:3},{value:"16.1.3 \u5e94\u7528",id:"1613-\u5e94\u7528",level:3},{value:"16.2 mqtt\u534f\u8bae\u62a5\u6587\u683c\u5f0f\u7ec4\u6210",id:"162-mqtt\u534f\u8bae\u62a5\u6587\u683c\u5f0f\u7ec4\u6210",level:2},{value:"16.2.1 mqtt\u63a7\u5236\u62a5\u6587\u7ed3\u6784",id:"1621-mqtt\u63a7\u5236\u62a5\u6587\u7ed3\u6784",level:3},{value:"16.2.2 mqtt\u56fa\u5b9a\u62a5\u5934",id:"1622-mqtt\u56fa\u5b9a\u62a5\u5934",level:3},{value:"16.2.3 mqtt\u63a7\u5236\u62a5\u6587\u7c7b\u578b",id:"1623-mqtt\u63a7\u5236\u62a5\u6587\u7c7b\u578b",level:3},{value:"16.2.4 \u6807\u8bb0",id:"1624-\u6807\u8bb0",level:3},{value:"16.2.5 \u5269\u4f59\u957f\u5ea6",id:"1625-\u5269\u4f59\u957f\u5ea6",level:3},{value:"16.2.5.1 \u793a\u4f8b",id:"16251-\u793a\u4f8b",level:4},{value:"16.2.6 \u53ef\u53d8\u62a5\u5934",id:"1626-\u53ef\u53d8\u62a5\u5934",level:3},{value:"16.2.7 \u6709\u6548\u8f7d\u8377",id:"1627-\u6709\u6548\u8f7d\u8377",level:3},{value:"16.3 \u62a5\u6587\u5206\u6790",id:"163-\u62a5\u6587\u5206\u6790",level:2},{value:"16.3.1 CONNECT-\u8fde\u63a5\u670d\u52a1\u7aef",id:"1631-connect-\u8fde\u63a5\u670d\u52a1\u7aef",level:3},{value:"16.3.1.1 connect\u56fa\u5b9a\u62a5\u5934",id:"16311-connect\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.1.2 \u534f\u8bae\u540d\u5b57\u8282\u7ec4\u6210",id:"16312-\u534f\u8bae\u540d\u5b57\u8282\u7ec4\u6210",level:4},{value:"16.3.1.3 \u534f\u8bae\u7ea7\u522b",id:"16313-\u534f\u8bae\u7ea7\u522b",level:4},{value:"16.3.1.4 \u8fde\u63a5\u6807\u8bb0",id:"16314-\u8fde\u63a5\u6807\u8bb0",level:4},{value:"16.3.1.5 \u4fdd\u6301\u8fde\u63a5",id:"16315-\u4fdd\u6301\u8fde\u63a5",level:4},{value:"16.3.1.6 \u5ba2\u6237\u7aef\u6807\u8bc6\u7b26",id:"16316-\u5ba2\u6237\u7aef\u6807\u8bc6\u7b26",level:4},{value:"16.3.1.7 \u9057\u5631\u4e3b\u9898",id:"16317-\u9057\u5631\u4e3b\u9898",level:4},{value:"16.3.1.8 \u9057\u5631\u6d88\u606f",id:"16318-\u9057\u5631\u6d88\u606f",level:4},{value:"16.3.1.9 \u7528\u6237\u540d\u548c\u5bc6\u7801",id:"16319-\u7528\u6237\u540d\u548c\u5bc6\u7801",level:4},{value:"16.3.10.1 wirshark\u6293\u5305\u5206\u6790connect\u62a5\u6587",id:"163101-wirshark\u6293\u5305\u5206\u6790connect\u62a5\u6587",level:4},{value:"16.3.10.2 c\u8bed\u8a00\u6784\u9020mqtt connect\u62a5\u6587",id:"163102-c\u8bed\u8a00\u6784\u9020mqtt-connect\u62a5\u6587",level:4},{value:"16.3.2 CONNACK-\u786e\u8ba4\u8fde\u63a5\u8bf7\u6c42",id:"1632-connack-\u786e\u8ba4\u8fde\u63a5\u8bf7\u6c42",level:3},{value:"16.3.2.1 \u56fa\u5b9a\u62a5\u5934",id:"16321-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.2.2 \u53ef\u53d8\u62a5\u5934",id:"16322-\u53ef\u53d8\u62a5\u5934",level:4},{value:"16.3.2.3 CONNACK\u62a5\u6587wireshark\u6293\u5305\u5206\u6790",id:"16323-connack\u62a5\u6587wireshark\u6293\u5305\u5206\u6790",level:4},{value:"16.3.2.4 c\u8bed\u8a00\u6784\u9020connect ack\u62a5\u6587",id:"16324-c\u8bed\u8a00\u6784\u9020connect-ack\u62a5\u6587",level:4},{value:"16.3.3 PUBLISH-\u53d1\u5e03\u6d88\u606f",id:"1633-publish-\u53d1\u5e03\u6d88\u606f",level:3},{value:"16.3.3.1 \u56fa\u5b9a\u62a5\u5934",id:"16331-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.3.2 \u6293\u5305\u5206\u6790PUBLISH\u62a5\u6587",id:"16332-\u6293\u5305\u5206\u6790publish\u62a5\u6587",level:4},{value:"16.3.3.3 \u6784\u9020publish \u62a5\u6587",id:"16333-\u6784\u9020publish-\u62a5\u6587",level:4},{value:"16.3.4 PUBREC-\u53d1\u5e03\u6536\u5230",id:"1634-pubrec-\u53d1\u5e03\u6536\u5230",level:3},{value:"16.3.4.1 \u56fa\u5b9a\u62a5\u5934",id:"16341-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.4.2 PUBREC\u6293\u5305\u62a5\u6587",id:"16342-pubrec\u6293\u5305\u62a5\u6587",level:4},{value:"16.3.4.3 c\u8bed\u8a00\u6784\u9020pubrec\u62a5\u6587",id:"16343-c\u8bed\u8a00\u6784\u9020pubrec\u62a5\u6587",level:4},{value:"16.3.5 PUBREL-\u53d1\u5e03\u91ca\u653e",id:"1635-pubrel-\u53d1\u5e03\u91ca\u653e",level:3},{value:"16.3.5.1 \u56fa\u5b9a\u62a5\u5934",id:"16351-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.5.2 PUBREL\u6293\u5305\u62a5\u6587",id:"16352-pubrel\u6293\u5305\u62a5\u6587",level:4},{value:"16.3.5.3 c\u8bed\u8a00\u6784\u9020pubrel\u62a5\u6587",id:"16353-c\u8bed\u8a00\u6784\u9020pubrel\u62a5\u6587",level:4},{value:"16.3.6 PUBCOMP-\u53d1\u5e03\u5b8c\u6210",id:"1636-pubcomp-\u53d1\u5e03\u5b8c\u6210",level:3},{value:"16.3.6.1 \u56fa\u5b9a\u62a5\u5934",id:"16361-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.6.2 PUBCOMP\u6293\u5305\u62a5\u6587",id:"16362-pubcomp\u6293\u5305\u62a5\u6587",level:4},{value:"16.3.6.3 c\u8bed\u8a00\u6784\u9020pubcom\u62a5\u6587",id:"16363-c\u8bed\u8a00\u6784\u9020pubcom\u62a5\u6587",level:4},{value:"16.3.7 PINGREQ-\u5fc3\u8df3\u8bf7\u6c42",id:"1637-pingreq-\u5fc3\u8df3\u8bf7\u6c42",level:3},{value:"16.3.7.1 \u56fa\u5b9a\u62a5\u5934",id:"16371-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.7.2 PINGREQ \u6293\u5305\u62a5\u6587",id:"16372-pingreq-\u6293\u5305\u62a5\u6587",level:4},{value:"16.3.7.3 c\u8bed\u8a00\u6784\u9020pingreq\u62a5\u6587",id:"16373-c\u8bed\u8a00\u6784\u9020pingreq\u62a5\u6587",level:4},{value:"16.3.8 PINGRESP \u2013 \u5fc3\u8df3\u54cd\u5e94",id:"1638-pingresp--\u5fc3\u8df3\u54cd\u5e94",level:3},{value:"16.3.8.1 \u56fa\u5b9a\u62a5\u5934",id:"16381-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.8.2 PINGRESP \u6293\u5305\u62a5\u6587",id:"16382-pingresp-\u6293\u5305\u62a5\u6587",level:4},{value:"16.3.8.3 c\u8bed\u8a00\u6784\u9020pinpresp\u62a5\u6587",id:"16383-c\u8bed\u8a00\u6784\u9020pinpresp\u62a5\u6587",level:4},{value:"16.3.9 DISCONNECT \u2013\u65ad\u5f00\u8fde\u63a5",id:"1639-disconnect-\u65ad\u5f00\u8fde\u63a5",level:3},{value:"16.3.9.1 \u56fa\u5b9a\u62a5\u5934",id:"16391-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.9.2 DISCONNECT \u6293\u5305\u62a5\u6587",id:"16392-disconnect-\u6293\u5305\u62a5\u6587",level:4},{value:"16.3.9.3 c\u8bed\u8a00\u6784\u9020disconnect\u62a5\u6587",id:"16393-c\u8bed\u8a00\u6784\u9020disconnect\u62a5\u6587",level:4},{value:"16.3.10 SUBSCRIBE-\u8ba2\u9605\u4e3b\u9898",id:"16310-subscribe-\u8ba2\u9605\u4e3b\u9898",level:3},{value:"16.3.10.1 \u56fa\u5b9a\u62a5\u5934",id:"163101-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.10.2 SUBSCRIBE\u62a5\u6587\u6293\u5305",id:"163102-subscribe\u62a5\u6587\u6293\u5305",level:4},{value:"16.3.10.3 c\u8bed\u8a00\u6784\u9020subscribe\u62a5\u6587",id:"163103-c\u8bed\u8a00\u6784\u9020subscribe\u62a5\u6587",level:4},{value:"16.3.11 SUBACK \u2013\u8ba2\u9605\u786e\u8ba4",id:"16311-suback-\u8ba2\u9605\u786e\u8ba4",level:3},{value:"16.3.11.1 \u56fa\u5b9a\u62a5\u5934",id:"163111-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"3.11.2 SUBACK\u6293\u5305\u62a5\u6587",id:"3112-suback\u6293\u5305\u62a5\u6587",level:3},{value:"16.3.11.3 c\u8bed\u8a00\u6784\u9020suback\u62a5\u6587",id:"163113-c\u8bed\u8a00\u6784\u9020suback\u62a5\u6587",level:4},{value:"16.3.12 UNSUBSCRIBE \u2013\u53d6\u6d88\u8ba2\u9605",id:"16312-unsubscribe-\u53d6\u6d88\u8ba2\u9605",level:3},{value:"16.3.12.1 \u56fa\u5b9a\u62a5\u5934",id:"163121-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.12.2 UNSUBSCRIBE\u6293\u5305\u62a5\u6587",id:"163122-unsubscribe\u6293\u5305\u62a5\u6587",level:4},{value:"16.3.12.3 c\u8bed\u8a00\u6784\u9020unsubscribe\u62a5\u6587",id:"163123-c\u8bed\u8a00\u6784\u9020unsubscribe\u62a5\u6587",level:4},{value:"16.3.13 UNSUBACK \u2013\u53d6\u6d88\u8ba2\u9605\u786e\u8ba4",id:"16313-unsuback-\u53d6\u6d88\u8ba2\u9605\u786e\u8ba4",level:3},{value:"16.3.13.1 \u56fa\u5b9a\u62a5\u5934",id:"163131-\u56fa\u5b9a\u62a5\u5934",level:4},{value:"16.3.12.2 UNSUBSCRIBE ACK\u6293\u5305\u62a5\u6587",id:"163122-unsubscribe-ack\u6293\u5305\u62a5\u6587",level:4},{value:"16.3.12.3 c\u8bed\u8a00\u6784\u9020unsubscribe\u62a5\u6587",id:"163123-c\u8bed\u8a00\u6784\u9020unsubscribe\u62a5\u6587-1",level:4},{value:"16.3.14 \u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u4ea4\u4e92\u64cd\u4f5c\u8fc7\u7a0b",id:"16314-\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u4ea4\u4e92\u64cd\u4f5c\u8fc7\u7a0b",level:3},{value:"16.3.14.1 \u7f16\u8bd1",id:"163141-\u7f16\u8bd1",level:4},{value:"16.3.14.2 \u6267\u884c",id:"163142-\u6267\u884c",level:4}];function x(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"16-mqtt\u534f\u8bae\u5206\u6790",children:"16 MQTT\u534f\u8bae\u5206\u6790"}),"\n",(0,s.jsx)(n.h2,{id:"161-mqtt\u534f\u8bae\u4ecb\u7ecd",children:"16.1 mqtt\u534f\u8bae\u4ecb\u7ecd"}),"\n",(0,s.jsx)(n.h3,{id:"1611-\u6982\u8ff0",children:"16.1.1 \u6982\u8ff0"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\tMQTT\u662f\u4e00\u4e2a\u5ba2\u6237\u7aef\u670d\u52a1\u7aef\u67b6\u6784\u7684\u53d1\u5e03/\u8ba2\u9605\u6a21\u5f0f\u7684\u6d88\u606f\u4f20\u8f93\u534f\u8bae\u3002\u5b83\u7684\u8bbe\u8ba1\u601d\u60f3\u662f\u8f7b\u5de7\u3001\u5f00\u653e\u3001\u7b80\u5355\u3001\u89c4\u8303\uff0c\u6613\u4e8e\u5b9e\u73b0\u3002\u8fd9\u4e9b\u7279\u70b9\u4f7f\u5f97\u5b83\u5bf9\u5f88\u591a\u573a\u666f\u6765\u8bf4\u90fd\u662f\u5f88\u597d\u7684\u9009\u62e9\uff0c\u7279\u522b\u662f\u5bf9\u4e8e\u53d7\u9650\u7684\u73af\u5883\u5982\u673a\u5668\u4e0e\u673a\u5668\u7684\u901a\u4fe1\uff08M2M\uff09\u4ee5\u53ca\u7269\u8054\u7f51\u73af\u5883\uff08IoT\uff09\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"1612-\u7279\u70b9",children:"16.1.2 \u7279\u70b9"}),"\n",(0,s.jsx)(n.p,{children:"a)   \u5f00\u653e\u6d88\u606f\u534f\u8bae\uff0c\u7b80\u5355\u6613\u5b9e\u73b0"}),"\n",(0,s.jsx)(n.p,{children:"b)   \u53d1\u5e03\u8ba2\u9605\u6a21\u5f0f\uff0c\u4e00\u5bf9\u591a\u6d88\u606f\u53d1\u5e03"}),"\n",(0,s.jsx)(n.p,{children:"c)   \u57fa\u4e8eTCP/IP\u7f51\u7edc\u8fde\u63a5"}),"\n",(0,s.jsx)(n.p,{children:"d)   1\u5b57\u8282\u56fa\u5b9a\u62a5\u5934\uff0c2\u5b57\u8282\u5fc3\u8df3\u62a5\u6587\uff0c\u62a5\u6587\u7ed3\u6784\u7d27\u51d1"}),"\n",(0,s.jsx)(n.p,{children:"e)   \u6d88\u606fQoS\u652f\u6301\uff0c\u53ef\u9760\u4f20\u8f93\u4fdd\u8bc1"}),"\n",(0,s.jsx)(n.h3,{id:"1613-\u5e94\u7528",children:"16.1.3 \u5e94\u7528"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\tMQTT\u534f\u8bae\u5e7f\u6cdb\u5e94\u7528\u4e8e\u7269\u8054\u7f51\u3001\u79fb\u52a8\u4e92\u8054\u7f51\u3001\u667a\u80fd\u786c\u4ef6\u3001\u8f66\u8054\u7f51\u3001\u7535\u529b\u80fd\u6e90\u7b49\u9886\u57df\u3002"}),"\n",(0,s.jsx)(n.p,{children:"a)   \u7269\u8054\u7f51M2M\u901a\u4fe1\uff0c\u7269\u8054\u7f51\u5927\u6570\u636e\u91c7\u96c6"}),"\n",(0,s.jsx)(n.p,{children:"b)   Android\u6d88\u606f\u63a8\u9001\uff0cWEB\u6d88\u606f\u63a8\u9001"}),"\n",(0,s.jsx)(n.p,{children:"c)   \u79fb\u52a8\u5373\u65f6\u6d88\u606f\uff0c\u4f8b\u5982Facebook Messenger"}),"\n",(0,s.jsx)(n.p,{children:"d)   \u667a\u80fd\u786c\u4ef6\u3001\u667a\u80fd\u5bb6\u5177\u3001\u667a\u80fd\u7535\u5668"}),"\n",(0,s.jsx)(n.p,{children:"e)   \u8f66\u8054\u7f51\u901a\u4fe1\uff0c\u7535\u52a8\u8f66\u7ad9\u6869\u91c7\u96c6"}),"\n",(0,s.jsx)(n.p,{children:"f)    \u667a\u6167\u57ce\u5e02\u3001\u8fdc\u7a0b\u533b\u7597\u3001\u8fdc\u7a0b\u6559\u80b2"}),"\n",(0,s.jsx)(n.p,{children:"g)   \u7535\u529b\u3001\u77f3\u6cb9\u4e0e\u80fd\u6e90\u7b49\u884c\u4e1a\u5e02\u573a"}),"\n",(0,s.jsx)(n.h2,{id:"162-mqtt\u534f\u8bae\u62a5\u6587\u683c\u5f0f\u7ec4\u6210",children:"16.2 mqtt\u534f\u8bae\u62a5\u6587\u683c\u5f0f\u7ec4\u6210"}),"\n",(0,s.jsx)(n.h3,{id:"1621-mqtt\u63a7\u5236\u62a5\u6587\u7ed3\u6784",children:"16.2.1 mqtt\u63a7\u5236\u62a5\u6587\u7ed3\u6784"}),"\n",(0,s.jsx)(n.p,{children:"MQTT \u534f\u8bae\u901a\u8fc7\u4ea4\u6362\u9884\u5b9a\u4e49\u7684 MQTT \u63a7\u5236\u62a5\u6587\u6765\u901a\u4fe1\u3002 \u8fd9\u4e00\u8282\u63cf\u8ff0\u8fd9\u4e9b\u62a5\u6587\u7684\u683c\u5f0f\u3002MQTT \u63a7\u5236\u62a5\u6587\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff0c\u5982\u4e0b\u56fe:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0002.png",alt:"\u56fe2.1 mqtt\u62a5\u6587\u7ec4\u6210"})}),"\n",(0,s.jsx)(n.h3,{id:"1622-mqtt\u56fa\u5b9a\u62a5\u5934",children:"16.2.2 mqtt\u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u6bcf\u4e2a MQTT \u63a7\u5236\u62a5\u6587\u90fd\u5305\u542b\u4e00\u4e2a\u56fa\u5b9a\u62a5\u5934\uff0c \u56fa\u5b9a\u62a5\u5934\u7684\u683c\u5f0f\u5982\u4e0b\u56fe:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0003.png",alt:"\u56fe2.2 mqtt\u56fa\u5b9a\u62a5\u5934"})}),"\n",(0,s.jsx)(n.h3,{id:"1623-mqtt\u63a7\u5236\u62a5\u6587\u7c7b\u578b",children:"16.2.3 mqtt\u63a7\u5236\u62a5\u6587\u7c7b\u578b"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u4f4d\u7f6e\uff1a \u7b2c 1 \u4e2a\u5b57\u8282\uff0c \u4e8c\u8fdb\u5236\u4f4d 7-4,\u8868\u793a\u4e3a 4 \u4f4d\u65e0\u7b26\u53f7\u503c\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\tMQTT \u63a7\u5236\u62a5\u6587\u7684\u7c7b\u578b\uff1a\u5982\u4e0b\u8868:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u540d\u5b57"}),(0,s.jsx)(n.th,{children:"\u503c"}),(0,s.jsx)(n.th,{children:"\u62a5\u6587\u6d41\u52a8\u65b9\u5411"}),(0,s.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Reserved"})}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"\u7981\u6b62"}),(0,s.jsx)(n.td,{children:"\u4fdd\u7559"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CONNECT"})}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u8bf7\u6c42\u8fde\u63a5\u670d\u52a1\u7aef"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CONNACK"})}),(0,s.jsx)(n.td,{children:"2"}),(0,s.jsx)(n.td,{children:"\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef"}),(0,s.jsx)(n.td,{children:"\u8fde\u63a5\u62a5\u6587\u786e\u8ba4"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBLISH"})}),(0,s.jsx)(n.td,{children:"3"}),(0,s.jsx)(n.td,{children:"\u4e24\u4e2a\u65b9\u5411\u90fd\u5141\u8bb8"}),(0,s.jsx)(n.td,{children:"\u53d1\u5e03\u6d88\u606f"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBACK"})}),(0,s.jsx)(n.td,{children:"4"}),(0,s.jsx)(n.td,{children:"\u4e24\u4e2a\u65b9\u5411\u90fd\u5141\u8bb8"}),(0,s.jsx)(n.td,{children:"QoS 1\u6d88\u606f\u53d1\u5e03\u6536\u5230\u786e\u8ba4"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBREC"})}),(0,s.jsx)(n.td,{children:"5"}),(0,s.jsx)(n.td,{children:"\u4e24\u4e2a\u65b9\u5411\u90fd\u5141\u8bb8"}),(0,s.jsx)(n.td,{children:"\u53d1\u5e03\u6536\u5230\uff08\u4fdd\u8bc1\u4ea4\u4ed8\u7b2c\u4e00\u6b65\uff09"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBREL"})}),(0,s.jsx)(n.td,{children:"6"}),(0,s.jsx)(n.td,{children:"\u4e24\u4e2a\u65b9\u5411\u90fd\u5141\u8bb8"}),(0,s.jsx)(n.td,{children:"\u53d1\u5e03\u91ca\u653e\uff08\u4fdd\u8bc1\u4ea4\u4ed8\u7b2c\u4e8c\u6b65\uff09"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBCOMP"})}),(0,s.jsx)(n.td,{children:"7"}),(0,s.jsx)(n.td,{children:"\u4e24\u4e2a\u65b9\u5411\u90fd\u5141\u8bb8"}),(0,s.jsx)(n.td,{children:"QoS 2\u6d88\u606f\u53d1\u5e03\u5b8c\u6210\uff08\u4fdd\u8bc1\u4ea4\u4e92\u7b2c\u4e09\u6b65\uff09"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SUBSCRIBE"})}),(0,s.jsx)(n.td,{children:"8"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u8ba2\u9605\u8bf7\u6c42"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SUBACK"})}),(0,s.jsx)(n.td,{children:"9"}),(0,s.jsx)(n.td,{children:"\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef"}),(0,s.jsx)(n.td,{children:"\u8ba2\u9605\u8bf7\u6c42\u62a5\u6587\u786e\u8ba4"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"UNSUBSCRIBE"})}),(0,s.jsx)(n.td,{children:"10"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u53d6\u6d88\u8ba2\u9605\u8bf7\u6c42"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"UNSUBACK"})}),(0,s.jsx)(n.td,{children:"11"}),(0,s.jsx)(n.td,{children:"\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef"}),(0,s.jsx)(n.td,{children:"\u53d6\u6d88\u8ba2\u9605\u62a5\u6587\u786e\u8ba4"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PINGREQ"})}),(0,s.jsx)(n.td,{children:"12"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef"}),(0,s.jsx)(n.td,{children:"\u5fc3\u8df3\u8bf7\u6c42"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PINGRESP"})}),(0,s.jsx)(n.td,{children:"13"}),(0,s.jsx)(n.td,{children:"\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef"}),(0,s.jsx)(n.td,{children:"\u5fc3\u8df3\u54cd\u5e94"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"DISCONNECT"})}),(0,s.jsx)(n.td,{children:"14"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u65ad\u5f00\u8fde\u63a5"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Reserved"})}),(0,s.jsx)(n.td,{children:"15"}),(0,s.jsx)(n.td,{children:"\u7981\u6b62"}),(0,s.jsx)(n.td,{children:"\u4fdd\u7559"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"1624-\u6807\u8bb0",children:"16.2.4 \u6807\u8bb0"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u56fa\u5b9a\u62a5\u5934\u7b2c 1 \u4e2a\u5b57\u8282\u7684\u5269\u4f59\u7684 4 \u4f4d [3-0]\u5305\u542b\u6bcf\u4e2a MQTT \u63a7\u5236\u62a5\u6587\u7c7b\u578b\u7279\u5b9a\u7684\u6807\u5fd7 \u3002\u6807\u8bb0\u4f4d\u8bf4\u660e\u5982\u4e0b\u8868\u6240\u793a:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u63a7\u5236\u62a5\u6587"}),(0,s.jsx)(n.th,{children:"\u56fa\u5b9a\u62a5\u5934\u6807\u5fd7"}),(0,s.jsx)(n.th,{children:"Bit 3"}),(0,s.jsx)(n.th,{children:"Bit 2"}),(0,s.jsx)(n.th,{children:"Bit 1"}),(0,s.jsx)(n.th,{children:"Bit 0"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CONNECT"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CONNACK"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBLISH"})}),(0,s.jsx)(n.td,{children:"Used  in MQTT 3.1.1"}),(0,s.jsx)(n.td,{children:"DUP1"}),(0,s.jsx)(n.td,{children:"QoS2"}),(0,s.jsx)(n.td,{children:"QoS2"}),(0,s.jsx)(n.td,{children:"RETAIN3"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBACK"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBREC"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBREL"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBCOMP"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SUBSCRIBE"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SUBACK"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"UNSUBSCRIBE"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"UNSUBACK"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PINGREQ"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PINGRESP"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"DISCONNECT"})}),(0,s.jsx)(n.td,{children:"Reserved"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"0"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"DUP1 =\u63a7\u5236\u62a5\u6587\u7684\u91cd\u590d\u5206\u53d1\u6807\u5fd7\nQoS2 = PUBLISH \u62a5\u6587\u7684\u670d\u52a1\u8d28\u91cf\u7b49\u7ea7\nRETAIN3 = PUBLISH \u62a5\u6587\u7684\u4fdd\u7559\u6807\u5fd7"}),"\n",(0,s.jsx)(n.h3,{id:"1625-\u5269\u4f59\u957f\u5ea6",children:"16.2.5 \u5269\u4f59\u957f\u5ea6"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u4f4d\u7f6e\uff1a\u4ece\u7b2c\u4e8c\u4e2a\u5b57\u8282\u5f00\u59cb\u3002\u5269\u4f59\u957f\u5ea6\uff08 Remaining Length\uff09 \u8868\u793a\u5f53\u524d\u62a5\u6587\u5269\u4f59\u90e8\u5206\u7684\u5b57\u8282\u6570\uff0c \u5305\u62ec\u53ef\u53d8\u62a5\u5934\u548c\u8d1f\u8f7d\u7684\u6570\u636e\u3002 \u5269\u4f59\u957f\u5ea6\u4e0d\u5305\u62ec\u7528\u4e8e\u7f16\u7801\u5269\u4f59\u957f\u5ea6\u5b57\u6bb5\u672c\u8eab\u7684\u5b57\u8282\u6570\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0004.png",alt:"\u56fe2.3 \u5269\u4f59\u957f\u5ea6\u5305\u542b\u7684\u62a5\u6587\u8303\u56f4"})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5269\u4f59\u957f\u5ea6\u5b57\u6bb5\u4f7f\u7528\u4e00\u4e2a\u53d8\u957f\u5ea6\u7f16\u7801\u65b9\u6848\uff0c \u5bf9\u5c0f\u4e8e 128 \u7684\u503c\u5b83\u4f7f\u7528\u5355\u5b57\u8282\u7f16\u7801\u3002 \u66f4\u5927\u7684\u503c\u6309\u4e0b\u9762\u7684\u65b9\u5f0f\u5904\u7406\u3002\u4f4e 7 \u4f4d\u6709\u6548\u4f4d\u7528\u4e8e\u7f16\u7801\u6570\u636e\uff0c\u6700\u9ad8\u6709\u6548\u4f4d\u7528\u4e8e\u6307\u793a\u662f\u5426\u6709\u66f4\u591a\u7684\u5b57\u8282\u3002 \u56e0\u6b64\u6bcf\u4e2a\u5b57\u8282\u53ef\u4ee5\u7f16\u7801 128 \u4e2a\u6570\u503c\u548c\u4e00\u4e2a\u5ef6\u7eed\u4f4d\uff08 continuation bit\uff09 \u3002 \u5269\u4f59\u957f\u5ea6\u5b57\u6bb5\u6700\u5927 4 \u4e2a\u5b57\u8282\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u4f8b\u5982\uff0c \u5341\u8fdb\u5236\u6570 64 \u4f1a\u88ab\u7f16\u7801\u4e3a\u4e00\u4e2a\u5b57\u8282\uff0c \u6570\u503c\u662f 64\uff0c \u5341\u516d\u8fdb\u5236\u8868\u793a\u4e3a 0x40,\u3002\u5341\u8fdb\u5236\u6570\u5b57321(=65+2*128)\u88ab\u7f16\u7801\u4e3a\u4e24\u4e2a\u5b57\u8282\uff0c \u6700\u4f4e\u6709\u6548\u4f4d\u5728\u524d\u3002 \u7b2c\u4e00\u4e2a\u5b57\u8282\u662f 65+128=193\u3002 \u6ce8\u610f\u6700\u9ad8\u4f4d\u4e3a\n1 \u8868\u793a\u540e\u9762\u81f3\u5c11\u8fd8\u6709\u4e00\u4e2a\u5b57\u8282\u3002 \u7b2c\u4e8c\u4e2a\u5b57\u8282\u662f 2\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16251-\u793a\u4f8b",children:"16.2.5.1 \u793a\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"123456  = 964 x 128 + 64 \n\n964 = 7x128 + 68\n\n7 < 128\n\n\u4e5f\u5c31\u662f123456 = (7 x 128 + 68)x128 + 64\n\n\u5c55\u5f00:64 + 68 x128 + 7x128x128 \n\n\u7b2c\u4e00\u5b57\u8282:64 | 0x80 = x (0x80=0x1000 0000\u6216\u4e0a\u6700\u9ad8\u4f4d\u8868\u793a\u662f\u5426\u8fd8\u6709\u66f4\u591a\u7684\u5b57\u8282)\n\n\u7b2c\u4e8c\u5b57\u8282:68 | 0x80 = y (0x80=0x1000 0000\u6216\u4e0a\u6700\u9ad8\u4f4d\u8868\u793a\u662f\u5426\u8fd8\u6709\u66f4\u591a\u7684\u5b57\u8282)\n\n\u7b2c\u4e09\u5b57\u8282:7=z\n\nc\u8bed\u8a00\u8868\u793a:unsigned char len_byte[4] = { 64 | 128 , 68 | 128,  7  , 0 }\n\n\u53cd\u8fc7\u6765\uff0c\u5982\u679c\u8981\u7b97\u51fa123456\n\nx-128 + (y-128)*128 + z x 128 x 128 \n"})}),"\n",(0,s.jsx)(n.p,{children:"\u628a\u5269\u4f59\u957f\u5ea6\u8f6c\u6362\u6210\u5b57\u8282\u8868\u793a\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0005.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u628a\u5b57\u8282\u8f6c\u6362\u6210\u5269\u4f59\u957f\u5ea6\u8868\u793a\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0006.png",alt:""})}),"\n",(0,s.jsx)(n.h3,{id:"1626-\u53ef\u53d8\u62a5\u5934",children:"16.2.6 \u53ef\u53d8\u62a5\u5934"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u67d0\u4e9b MQTT \u63a7\u5236\u62a5\u6587\u5305\u542b\u4e00\u4e2a\u53ef\u53d8\u62a5\u5934\u90e8\u5206\u3002 \u5b83\u5728\u56fa\u5b9a\u62a5\u5934\u548c\u8d1f\u8f7d\u4e4b\u95f4\u3002\u53ef\u53d8\u62a5\u5934\u7684\u5185\u5bb9\u6839\u636e\u62a5\u6587\u7c7b\u578b\u7684\u4e0d\u540c\u800c\u4e0d\u540c\u3002\u62a5\u6587\u6807\u8bc6\u7b26\u662f\u53ef\u53d8\u62a5\u5934\u4e00\u79cd\uff0c\u53ef\u53d8\u62a5\u5934\u7684\u62a5\u6587\u6807\u8bc6\u7b26\uff08 Packet Identifier\uff09 \u5b57\u6bb5\u5b58\u5728\u4e8e\u5728\u591a\u4e2a\u7c7b\u578b\u7684\u62a5\u6587\u91cc\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u62a5\u6587\u6807\u8bc6\u7b26\u7c7b\u578b\u5982\u4e0b\u56fe:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0007.png",alt:"\u56fe2.4 \u62a5\u6587\u6807\u8bc6\u7b26"})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5f88\u591a\u63a7\u5236\u62a5\u6587\u7684\u53ef\u53d8\u62a5\u5934\u90e8\u5206\u5305\u542b\u4e00\u4e2a\u4e24\u5b57\u8282\u7684\u62a5\u6587\u6807\u8bc6\u7b26\u5b57\u6bb5\u3002 \u8fd9\u4e9b\u62a5\u6587\u662f PUBLISH\uff08 QoS>0 \u65f6\uff09 \uff0cPUBACK\uff0c PUBREC\uff0c PUBREL\uff0c PUBCOMP\uff0c SUBSCRIBE, SUBACK\uff0c UNSUBSCIBE\uff0cUNSUBACK\uff0c\u5982\u4e0b\u8868\u6240\u793a\uff1a"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"\u63a7\u5236\u62a5\u6587"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"\u62a5\u6587\u6807\u8bc6\u7b26\u5b57\u6bb5"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CONNECT"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CONNACK"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBLISH"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981\uff08\u5982\u679cQoS > 0\uff09"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBACK"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBREC"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBREL"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBCOMP"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SUBSCRIBE"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SUBACK"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"UNSUBSCRIBE"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"UNSUBACK"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PINGREQ"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PINGRESP"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"DISCONNECT"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5f7c\u6b64\u72ec\u7acb\u5730\u5206\u914d\u62a5\u6587\u6807\u8bc6\u7b26\u3002 \u56e0\u6b64\uff0c\u5ba2\u6237\u7aef\u670d\u52a1\u7aef\u7ec4\u5408\u4f7f\u7528\u76f8\u540c\u7684\u62a5\u6587\u6807\u8bc6\u7b26\u53ef\u4ee5\u5b9e\u73b0\u5e76\u53d1\u7684\u6d88\u606f\u4ea4\u6362\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u4f8b\u5982\uff0c\u5f53client\u53d1\u9001\u4e00\u4e2apacket Identifier =0x1234\u7684\u62a5\u6587\u7ed9server\u65f6\uff0cserver\u7684\u56de\u590d\u62a5\u6587packet identifier \u5fc5\u987b\u662f0x1234,Packet identifier \u4ece1\u5f00\u59cb\u9012\u589e\uff0c\u5230\u8fbe65535\u65f6\uff0c\u53c8\u4ece1\u5f00\u59cb\u8ba1\u7b97\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0008.png",alt:"\u56fe2.5 \u9700\u8981 Packet Identifier  \u7684\u62a5\u6587\u7c7b\u578b\u4ea4\u4e92\u793a\u610f\u56fe"})}),"\n",(0,s.jsx)(n.h3,{id:"1627-\u6709\u6548\u8f7d\u8377",children:"16.2.7 \u6709\u6548\u8f7d\u8377"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u67d0\u4e9b MQTT \u63a7\u5236\u62a5\u6587\u5728\u62a5\u6587\u7684\u6700\u540e\u90e8\u5206\u5305\u542b\u4e00\u4e2a\u6709\u6548\u8f7d\u8377\uff0c\u5e26\u6709\u6709\u6548\u8f7d\u8377\u62a5\u6587\u7c7b\u578b\u5982\u4e0b\u8868\u6240\u793a\uff1a"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"\u63a7\u5236\u62a5\u6587"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"\u6709\u6548\u8f7d\u8377"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CONNECT"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CONNACK"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBLISH"})}),(0,s.jsx)(n.td,{children:"\u53ef\u9009"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBACK"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBREC"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBREL"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PUBCOMP"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SUBSCRIBE"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SUBACK"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"UNSUBSCRIBE"})}),(0,s.jsx)(n.td,{children:"\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"UNSUBACK"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PINGREQ"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PINGRESP"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"DISCONNECT"})}),(0,s.jsx)(n.td,{children:"\u4e0d\u9700\u8981"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"163-\u62a5\u6587\u5206\u6790",children:"16.3 \u62a5\u6587\u5206\u6790"}),"\n",(0,s.jsx)(n.h3,{id:"1631-connect-\u8fde\u63a5\u670d\u52a1\u7aef",children:"16.3.1 CONNECT-\u8fde\u63a5\u670d\u52a1\u7aef"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u7f51\u7edc\u8fde\u63a5\u5efa\u7acb\uff08\u5b8c\u6210\u4e09\u6b21\u63e1\u624b\uff09\u540e\uff0c\u5ba2\u6237\u7aef\u53d1\u9001\u7ed9\u670d\u52a1\u7aef\u7684\u7b2c\u4e00\u4e2a\u62a5\u6587\u5fc5\u987b\u662f CONNECT \u62a5\u6587\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0009.png",alt:"\u56fe3.1 \u4e09\u6b21\u63e1\u624b\u4e0emqtt connect\u4ea4\u4e92\u8fc7\u7a0b"})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5728\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u4e0a\uff0c\u5ba2\u6237\u7aef\u53ea\u80fd\u53d1\u9001\u4e00\u6b21 CONNECT \u62a5\u6587\u3002\u670d\u52a1\u7aef\u5fc5\u987b\u5c06\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u7b2c\u4e8c\u4e2a CONNECT\u62a5\u6587\u5f53\u4f5c\u534f\u8bae\u8fdd\u89c4\u5904\u7406\u5e76\u65ad\u5f00\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u6709\u6548\u8f7d\u8377\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u7f16\u7801\u7684\u5b57\u6bb5\u3002 \u5305\u62ec\u5ba2\u6237\u7aef\u7684\u552f\u4e00\u6807\u8bc6\u7b26\uff0c Will \u4e3b\u9898\uff0c Will \u6d88\u606f\uff0c \u7528\u6237\u540d\u548c\u5bc6\u7801\u3002 \u9664\u4e86\u5ba2\u6237\u7aef\u6807\u8bc6\u4e4b\u5916\uff0c \u5176\u5b83\u7684\u5b57\u6bb5\u90fd\u662f\u53ef\u9009\u7684\uff0c \u57fa\u4e8e\u6807\u5fd7\u4f4d\u6765\u51b3\u5b9a\u53ef\u53d8\u62a5\u5934\u4e2d\u662f\u5426\u9700\u8981\u5305\u542b\u8fd9\u4e9b\u5b57\u6bb5\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0010.png",alt:"\u56fe3.2 connect\u62a5\u6587\u7ec4\u6210"})}),"\n",(0,s.jsx)(n.h4,{id:"16311-connect\u56fa\u5b9a\u62a5\u5934",children:"16.3.1.1 connect\u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"    bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"    Byte1"}),(0,s.jsx)("td",{colspan:"4",children:"Mqtt\u62a5\u6587\u7c7b\u578b(1)"}),(0,s.jsx)("td",{colspan:"4",children:"  Reserved(\u4fdd\u7559\u4f4d)"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"   Byte2~n"}),(0,s.jsx)("td",{children:"\u5269\u4f59\u957f\u5ea6"}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u8868\u683c3.1"}),"\n",(0,s.jsx)(n.h4,{id:"16312-\u534f\u8bae\u540d\u5b57\u8282\u7ec4\u6210",children:"16.3.1.2 \u534f\u8bae\u540d\u5b57\u8282\u7ec4\u6210"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"\u8bf4\u660e"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colspan:"10",children:"\u534f\u8bae\u540d"})}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{children:"\u534f\u8bae\u540d\u957f\u5ea6MSB(0)"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{children:"\u534f\u8bae\u540d\u957f\u5ea6LSB(4)"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte3"}),(0,s.jsx)("td",{children:"\u2018M\u2019"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte4"}),(0,s.jsx)("td",{children:"\u2018Q\u2019"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte5"}),(0,s.jsx)("td",{children:"\u2018T\u2019"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte6"}),(0,s.jsx)("td",{children:"\u2018T\u2019"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u6570\u636e\u5305\u68c0\u6d4b\u5de5\u5177\uff0c \u4f8b\u5982\u9632\u706b\u5899\uff0c \u53ef\u4ee5\u4f7f\u7528\u534f\u8bae\u540d\u6765\u8bc6\u522b MQTT \u6d41\u91cf\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16313-\u534f\u8bae\u7ea7\u522b",children:"16.3.1.3 \u534f\u8bae\u7ea7\u522b"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"\u8bf4\u660e"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colspan:"10",children:"\u534f\u8bae\u7ea7\u522b"})}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte7"}),(0,s.jsx)("td",{children:"Level(4)"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5ba2\u6237\u7aef\u7528 8 \u4f4d\u7684\u65e0\u7b26\u53f7\u503c\u8868\u793a\u534f\u8bae\u7684\u4fee\u8ba2\u7248\u672c\u3002\u5bf9\u4e8e 3.1.1 \u7248\u534f\u8bae\uff0c\u534f\u8bae\u7ea7\u522b\u5b57\u6bb5\u7684\u503c\u662f 4(0x04)\u3002\u5982\u679c\u53d1\u73b0\u4e0d\u652f\u6301\u7684\u534f\u8bae\u7ea7\u522b\uff0c\u670d\u52a1\u7aef\u5fc5\u987b\u7ed9\u53d1\u9001\u4e00\u4e2a\u8fd4\u56de\u7801\u4e3a 0x01\uff08\u4e0d\u652f\u6301\u7684\u534f\u8bae\u7ea7\u522b\uff09\u7684CONNACK \u62a5\u6587\u54cd\u5e94CONNECT \u62a5\u6587\uff0c \u7136\u540e\u65ad\u5f00\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16314-\u8fde\u63a5\u6807\u8bb0",children:"16.3.1.4 \u8fde\u63a5\u6807\u8bb0"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"bit"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"7"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"6"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"5"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"4"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"3"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"2"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"1"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"0"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"\u7528\u6237\u540d\u6807\u8bb0"}),(0,s.jsx)(n.td,{children:"\u7528\u6237\u5bc6\u7801\u6807\u8bb0"}),(0,s.jsx)(n.td,{children:"Will  retain"}),(0,s.jsx)(n.td,{children:"Will qos"}),(0,s.jsx)(n.td,{children:"Will flag"}),(0,s.jsx)(n.td,{children:"\u6e05\u9664\u4f1a\u8bdd"}),(0,s.jsx)(n.td,{children:"reserved"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Byte 8"})}),(0,s.jsx)(n.td,{children:"x"}),(0,s.jsx)(n.td,{children:"x"}),(0,s.jsx)(n.td,{children:"x"}),(0,s.jsx)(n.td,{children:"x"}),(0,s.jsx)(n.td,{children:"x"}),(0,s.jsx)(n.td,{children:"x"}),(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{})]})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"bit1\u6e05\u9664\u4f1a\u8bdd"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u822c\u6765\u8bf4\uff0c \u5ba2\u6237\u7aef\u8fde\u63a5\u65f6\u603b\u662f\u5c06\u6e05\u7406\u4f1a\u8bdd\u6807\u5fd7\u8bbe\u7f6e\u4e3a 0 \u6216 1\uff0c \u5e76\u4e14\u4e0d\u4ea4\u66ff\u4f7f\u7528\u4e24\u79cd\u503c\u3002 \u8fd9\u4e2a\u9009\u62e9\u53d6\u51b3\u4e8e\u5177\u4f53\u7684\u5e94\u7528\u3002 \u6e05\u7406\u4f1a\u8bdd\u6807\u5fd7\u8bbe\u7f6e\u4e3a 1 \u7684\u5ba2\u6237\u7aef\u4e0d\u4f1a\u6536\u5230\u65e7\u7684\u5e94\u7528\u6d88\u606f\uff0c \u800c\u4e14\u5728\u6bcf\u6b21\u8fde\u63a5\u6210\u529f\u540e\u90fd\u9700\u8981\u91cd\u65b0\u8ba2\u9605\u4efb\u4f55\u76f8\u5173\u7684\u4e3b\u9898\u3002\u6e05\u7406\u4f1a\u8bdd\u6807\u5fd7\u8bbe\u7f6e\u4e3a 0 \u7684\u5ba2\u6237\u7aef\u4f1a\u6536\u5230\u6240\u6709\u5728\u5b83\u8fde\u63a5\u65ad\u5f00\u671f\u95f4\u53d1\u5e03\u7684 QoS 1 \u548c QoS 2 \u7ea7\u522b\u7684\u6d88\u606f\u3002\u56e0\u6b64\uff0c \u8981\u786e\u4fdd\u4e0d\u4e22\u5931\u8fde\u63a5\u65ad\u5f00\u671f\u95f4\u7684\u6d88\u606f\uff0c \u9700\u8981\u4f7f\u7528 QoS 1 \u6216QoS 2 \u7ea7\u522b\uff0c\u540c\u65f6\u5c06\u6e05\u7406\u4f1a\u8bdd\u6807\u5fd7\u8bbe\u7f6e\u4e3a 0\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Bit2\u9057\u5631\u6807\u5fd7"})}),"\n",(0,s.jsx)(n.p,{children:"\u9057\u5631\u6807\u5fd7\uff08Will Flag\uff09 \u88ab\u8bbe\u7f6e\u4e3a 1\uff0c\u8868\u793a\u5982\u679c\u8fde\u63a5\u8bf7\u6c42\u88ab\u63a5\u53d7\u4e86\uff0c \u9057\u5631\uff08Will Message\uff09 \u6d88\u606f\u5fc5\u987b\u88ab\u5b58\u50a8\u5728\u670d\u52a1\u7aef\u5e76\u4e14\u4e0e\u8fd9\u4e2a\u7f51\u7edc\u8fde\u63a5\u5173\u8054\u3002\u4e4b\u540e\u7f51\u7edc\u8fde\u63a5\u5173\u95ed\u65f6\uff0c\u670d\u52a1\u7aef\u5fc5\u987b\u53d1\u5e03\u8fd9\u4e2a\u9057\u5631\u6d88\u606f\uff0c \u9664\u975e\u670d\u52a1\u7aef\u6536\u5230DISCONNECT \u62a5\u6587\u65f6\u5220\u9664\u4e86\u8fd9\u4e2a\u9057\u5631\u6d88\u606f\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Bit3\u548c bit4\u9057\u5631 QoS"})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u4e24\u4f4d\u7528\u4e8e\u6307\u5b9a\u53d1\u5e03\u9057\u5631\u6d88\u606f\u65f6\u4f7f\u7528\u7684\u670d\u52a1\u8d28\u91cf\u7b49\u7ea7, \u5982\u679c\u9057\u5631\u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 0\uff0c \u9057\u5631 QoS \u4e5f\u5fc5\u987b\u8bbe\u7f6e\u4e3a 0(0x00)\uff0c\u5982\u679c\u9057\u5631\u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c \u9057\u5631 QoS \u7684\u503c\u53ef\u4ee5\u7b49\u4e8e 0(0x00)\uff0c 1(0x01)\uff0c 2(0x02)\uff0c \u5b83\u7684\u503c\u4e0d\u80fd\u7b49\u4e8e 3\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Bit5\u9057\u5631\u4fdd\u7559"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u9057\u5631\u6d88\u606f\u88ab\u53d1\u5e03\u65f6\u9700\u8981\u4fdd\u7559\uff0c\u9700\u8981\u6307\u5b9a\u8fd9\u4e00\u4f4d\u7684\u503c, \u5982\u679c\u9057\u5631\u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 0\uff0c \u9057\u5631\u4fdd\u7559\uff08Will Retain\uff09 \u6807\u5fd7\u4e5f\u5fc5\u987b\u8bbe\u7f6e\u4e3a 0 \u3002\n\u5982\u679c\u9057\u5631\u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1\uff1a\n\xb7 \u5982\u679c\u9057\u5631\u4fdd\u7559\u88ab\u8bbe\u7f6e\u4e3a 0\uff0c \u670d\u52a1\u7aef\u5fc5\u987b\u5c06\u9057\u5631\u6d88\u606f\u5f53\u4f5c\u975e\u4fdd\u7559\u6d88\u606f\u53d1\u5e03 \u3002\n\xb7 \u5982\u679c\u9057\u5631\u4fdd\u7559\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c \u670d\u52a1\u7aef\u5fc5\u987b\u5c06\u9057\u5631\u6d88\u606f\u5f53\u4f5c\u4fdd\u7559\u6d88\u606f\u53d1\u5e03\u3002"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Bit7"})," ",(0,s.jsx)(n.strong,{children:"\u7528\u6237\u540d\u6807\u5fd7"})]}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u7528\u6237\u540d\uff08User Name\uff09 \u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 0\uff0c \u6709\u6548\u8f7d\u8377\u4e2d\u4e0d\u80fd\u5305\u542b\u7528\u6237\u540d\u5b57\u6bb5\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u7528\u6237\u540d\uff08User Name\uff09 \u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c \u6709\u6548\u8f7d\u8377\u4e2d\u5fc5\u987b\u5305\u542b\u7528\u6237\u540d\u5b57\u6bb5\u3002"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Bit6"})," ",(0,s.jsx)(n.strong,{children:"\u7528\u6237\u540d\u5bc6\u7801\u6807\u8bb0"})]}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u5bc6\u7801\uff08Password\uff09 \u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 0\uff0c \u6709\u6548\u8f7d\u8377\u4e2d\u4e0d\u80fd\u5305\u542b\u5bc6\u7801\u5b57\u6bb5 \u3002\n\u5982\u679c\u5bc6\u7801\uff08Password\uff09 \u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c \u6709\u6548\u8f7d\u8377\u4e2d\u5fc5\u987b\u5305\u542b\u5bc6\u7801\u5b57\u6bb5 \u3002\n\u5982\u679c\u7528\u6237\u540d\u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 0\uff0c \u5bc6\u7801\u6807\u5fd7\u4e5f\u5fc5\u987b\u8bbe\u7f6e\u4e3a 0 \u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16315-\u4fdd\u6301\u8fde\u63a5",children:"16.3.1.5 \u4fdd\u6301\u8fde\u63a5"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte9"}),(0,s.jsx)("td",{colspan:"8",children:"\u4fdd\u6301\u8fde\u63a5 Keep Alive MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte10"}),(0,s.jsx)("td",{colspan:"8",children:"\u4fdd\u6301\u8fde\u63a5 Keep Alive LSB"})]})]}),"\n",(0,s.jsx)(n.p,{children:"a)   \u4fdd\u6301\u8fde\u63a5\uff08Keep Alive\uff09 \u662f\u4e00\u4e2a\u4ee5\u79d2\u4e3a\u5355\u4f4d\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u8868\u793a\u4e3a\u4e00\u4e2a 16 \u4f4d\u7684\u5b57\uff0c\u5b83\u662f\u6307\u5728\u5ba2\u6237\u7aef\u4f20\u8f93\u5b8c\u6210\u3002"}),"\n",(0,s.jsx)(n.p,{children:"b)   \u4e00\u4e2a\u63a7\u5236\u62a5\u6587\u7684\u65f6\u523b\u5230\u53d1\u9001\u4e0b\u4e00\u4e2a\u62a5\u6587\u7684\u65f6\u523b\uff0c \u4e24\u8005\u4e4b\u95f4\u5141\u8bb8\u7a7a\u95f2\u7684\u6700\u5927\u65f6\u95f4\u95f4\u9694\u3002 \u5ba2\u6237\u7aef\u8d1f\u8d23\u4fdd\u8bc1\u63a7\u5236\u3002"}),"\n",(0,s.jsx)(n.p,{children:"c)   \u62a5\u6587\u53d1\u9001\u7684\u65f6\u95f4\u95f4\u9694\u4e0d\u8d85\u8fc7\u4fdd\u6301\u8fde\u63a5\u7684\u503c\u3002 \u5982\u679c\u6ca1\u6709\u4efb\u4f55\u5176\u5b83\u7684\u63a7\u5236\u62a5\u6587\u53ef\u4ee5\u53d1\u9001\uff0c \u5ba2\u6237\u7aef\u5fc5\u987b\u53d1\u9001\u4e00\u4e2aPINGREQ \u62a5\u6587\u3002"}),"\n",(0,s.jsx)(n.p,{children:"d)   \u4e0d\u7ba1\u4fdd\u6301\u8fde\u63a5\u7684\u503c\u662f\u591a\u5c11\uff0c\u5ba2\u6237\u7aef\u4efb\u4f55\u65f6\u5019\u90fd\u53ef\u4ee5\u53d1\u9001 PINGREQ \u62a5\u6587\uff0c\u5e76\u4e14\u4f7f\u7528 PINGRESP \u62a5\u6587\u5224\u65ad\u7f51\u7edc\u548c\u670d\u52a1\u7aef\u7684\u6d3b\u52a8\u72b6\u6001\u3002"}),"\n",(0,s.jsx)(n.p,{children:"e)   \u5982\u679c\u4fdd\u6301\u8fde\u63a5\u7684\u503c\u975e\u96f6\uff0c\u5e76\u4e14\u670d\u52a1\u7aef\u5728\u4e00\u70b9\u4e94\u500d\u7684\u4fdd\u6301\u8fde\u63a5\u65f6\u95f4\u5185\u6ca1\u6709\u6536\u5230\u5ba2\u6237\u7aef\u7684\u63a7\u5236\u62a5\u6587\uff0c \u5b83\u5fc5\u987b\u65ad\u5f00\u5ba2\u6237\u7aef\u7684\u7f51\u7edc\u8fde\u63a5\uff0c \u8ba4\u4e3a\u7f51\u7edc\u8fde\u63a5\u5df2\u65ad\u5f00\u3002"}),"\n",(0,s.jsx)(n.p,{children:"f)    \u5ba2\u6237\u7aef\u53d1\u9001\u4e86 PINGREQ \u62a5\u6587\u4e4b\u540e\uff0c \u5982\u679c\u5728\u5408\u7406\u7684\u65f6\u95f4\u5185\u4ecd\u6ca1\u6709\u6536\u5230 PINGRESP \u62a5\u6587\uff0c \u5b83\u5e94\u8be5\u5173\u95ed\u5230\u670d\u52a1\u7aef\u7684\u7f51\u7edc\u8fde\u63a5\u3002"}),"\n",(0,s.jsx)(n.p,{children:"g)   \u4fdd\u6301\u8fde\u63a5\u7684\u503c\u4e3a\u96f6\u8868\u793a\u5173\u95ed\u4fdd\u6301\u8fde\u63a5\u529f\u80fd\u3002 \u8fd9\u610f\u5473\u7740\uff0c\u670d\u52a1\u7aef\u4e0d\u9700\u8981\u56e0\u4e3a\u5ba2\u6237\u7aef\u4e0d\u6d3b\u8dc3\u800c\u65ad\u5f00\u8fde\u63a5\u3002 \u6ce8\u610f\uff1a\u4e0d\u7ba1\u4fdd\u6301\u8fde\u63a5\u7684\u503c\u662f\u591a\u5c11\uff0c \u4efb\u4f55\u65f6\u5019\uff0c\u53ea\u8981\u670d\u52a1\u7aef\u8ba4\u4e3a\u5ba2\u6237\u7aef\u662f\u4e0d\u6d3b\u8dc3\u6216\u65e0\u54cd\u5e94\u7684\uff0c \u53ef\u4ee5\u65ad\u5f00\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16316-\u5ba2\u6237\u7aef\u6807\u8bc6\u7b26",children:"16.3.1.6 \u5ba2\u6237\u7aef\u6807\u8bc6\u7b26"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u670d\u52a1\u7aef\u4f7f\u7528\u5ba2\u6237\u7aef\u6807\u8bc6\u7b26 (ClientId) \u8bc6\u522b\u5ba2\u6237\u7aef\u3002 \u8fde\u63a5\u670d\u52a1\u7aef\u7684\u6bcf\u4e2a\u5ba2\u6237\u7aef\u90fd\u6709\u552f\u4e00\u7684\u5ba2\u6237\u7aef\u6807\u8bc6\u7b26\uff08ClientId\uff09 \u3002\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u5fc5\u987b\u4f7f\u7528 ClientId \u8bc6\u522b\u4e24\u8005\u4e4b\u95f4\u7684 MQTT \u4f1a\u8bdd\u76f8\u5173\u7684\u72b6\u6001, \u5ba2\u6237\u7aef\u6807\u8bc6\u7b26 (ClientId) \u5fc5\u987b\u5b58\u5728\u800c\u4e14\u5fc5\u987b\u662f CONNECT \u62a5\u6587\u6709\u6548\u8f7d\u8377\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bb5,\u5ba2\u6237\u7aef\u6807\u8bc6\u7b26\u5fc5\u987b\u662fUTF-8 \u7f16\u7801\u5b57\u7b26\u4e32\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16317-\u9057\u5631\u4e3b\u9898",children:"16.3.1.7 \u9057\u5631\u4e3b\u9898"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5982\u679c\u9057\u5631\u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c \u6709\u6548\u8f7d\u8377\u7684\u4e0b\u4e00\u4e2a\u5b57\u6bb5\u662f\u9057\u5631\u4e3b\u9898\uff08Will Topic\uff09 \u3002 \u9057\u5631\u4e3b\u9898\u5fc5\u987b\u662f UTF-8 \u7f16\u7801\u5b57\u7b26\u4e32\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16318-\u9057\u5631\u6d88\u606f",children:"16.3.1.8 \u9057\u5631\u6d88\u606f"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5982\u679c\u9057\u5631\u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c \u6709\u6548\u8f7d\u8377\u7684\u4e0b\u4e00\u4e2a\u5b57\u6bb5\u662f\u9057\u5631\u6d88\u606f\u3002 \u9057\u5631\u6d88\u606f\u5b9a\u4e49\u4e86\u5c06\u88ab\u53d1\u5e03\u5230\u9057\u5631\u4e3b\u9898\u7684\u5e94\u7528\u6d88\u606f\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16319-\u7528\u6237\u540d\u548c\u5bc6\u7801",children:"16.3.1.9 \u7528\u6237\u540d\u548c\u5bc6\u7801"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5982\u679c\u7528\u6237\u540d\uff08 User Name\uff09 \u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c \u6709\u6548\u8f7d\u8377\u7684\u4e0b\u4e00\u4e2a\u5b57\u6bb5\u5c31\u662f\u5b83\u3002 \u7528\u6237\u540d\u5fc5\u987b\u662f\u5b9a\u4e49\u7684UTF-8 \u7f16\u7801\u5b57\u7b26\u4e32\u3002\u670d\u52a1\u7aef\u53ef\u4ee5\u5c06\u5b83\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5982\u679c\u5bc6\u7801\uff08 Password\uff09 \u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c \u6709\u6548\u8f7d\u8377\u7684\u4e0b\u4e00\u4e2a\u5b57\u6bb5\u5c31\u662f\u5b83\u3002\u5bc6\u7801\u5b57\u6bb5\u5305\u542b\u4e00\u4e2a\u4e24\u5b57\u8282\u7684\u957f\u5ea6\u5b57\u6bb5\uff0c \u957f\u5ea6\u8868\u793a\u4e8c\u8fdb\u5236\u6570\u636e\u7684\u5b57\u8282\u6570\uff08 \u4e0d\u5305\u542b\u957f\u5ea6\u5b57\u6bb5\u672c\u8eab\u5360\u7528\u7684\u4e24\u4e2a\u5b57\u8282\uff09\uff0c\u540e\u9762\u8ddf\u7740 0 \u5230 65535 \u5b57\u8282\u7684\u4e8c\u8fdb\u5236\u6570\u636e\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0011.png",alt:"\u56fe3.2 \u7528\u6237\u540d\u548c\u5bc6\u7801\u5728connect\u62a5\u6587\u4e2d\u7684\u7ec4\u6210"})}),"\n",(0,s.jsx)(n.h4,{id:"163101-wirshark\u6293\u5305\u5206\u6790connect\u62a5\u6587",children:"16.3.10.1 wirshark\u6293\u5305\u5206\u6790connect\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u4ece\u6293\u5305\u53ef\u77e5\uff0c\u4ece\u4e0a\u5230\u4e0b\u5206\u522b\u662f\u56fa\u5b9a\u62a5\u5934\uff0c\u53ef\u53d8\u62a5\u5934\uff0c\u8fde\u63a5\u6807\u8bb0\uff0c\u4fdd\u6301\u8fde\u63a5\uff0c\u7528\u6237\u540d\uff0c\u7528\u540d\u5bc6\u7801\uff0c\u5176\u4e2d\u6ca1\u6709\u9057\u5631\u76f8\u5173\u6d88\u606f\u5b57\u6bb5\uff0c\u4e0e3.1.1\u8282\u5206\u6790\u7684\u56fa\u5b9a\u62a5\u5934\u7ec4\u6210\u5206\u6790\u4e00\u81f4\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0012.png",alt:"\u56fe 3.3\u4f7f\u7528wireshark\u6293\u5305\u5206\u6790connect\u62a5\u6587\u7ec4\u6210\u683c\u5f0f"})}),"\n",(0,s.jsx)(n.h4,{id:"163102-c\u8bed\u8a00\u6784\u9020mqtt-connect\u62a5\u6587",children:"16.3.10.2 c\u8bed\u8a00\u6784\u9020mqtt connect\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-C",children:'static uint8_t client_id[512] = {"mqtt_client"};\nstatic uint8_t user_name[512] = {"mqtt"};\nstatic uint8_t passwd[512] = {"12345678"};\n#define KEEP_ALIVE 20\nint mqtt_connect(int sockfd)\n{\n    uint8 flags = 0x00;\n\tuint8 *packet = NULL;\n\tuint16 packet_length = 0;\t\n\tuint16 clientidlen = strlen(client_id);\n\tuint16 usernamelen = strlen(user_name);\n\tuint16 passwordlen = strlen(passwd);\n\tuint16 payload_len = clientidlen + 2;\n\t// Variable header\n\tuint8 var_header[10] = {\n\t\t0x00,0x04,/*len*/\n        0x4d,0x51,0x54,0x54,/*mqtt*/\n\t\t0x04,/*\u534f\u8bae\u7248\u672c*/};\n\t\n\tuint8 fixedHeaderSize = 2;    // Default size = one byte Message Type + one byte Remaining Length\n\tuint8 remainLen = 0;\n\tuint8 *fixed_header = NULL;\n\tuint16 offset = 0;\n    \n\t// Preparing the flags\n\tif(usernamelen) { /*\u7528\u6237\u540d\u957f\u5ea6(\u53ef\u9009)*/\n\t\tpayload_len += usernamelen + 2;\n\t\tflags |= MQTT_USERNAME_FLAG;/*\u6216\u4e0a\u7528\u6237\u540d\u6807\u8bb0*/\n\t}\n\tif(passwordlen) { /*\u7528\u6237\u5bc6\u7801(\u53ef\u9009)*/\n\t\tpayload_len += passwordlen + 2;\n\t\tflags |= MQTT_PASSWORD_FLAG;/*\u7528\u6237\u5bc6\u7801\u6807\u8bb0\u4f4d*/\n\t}\n\tflags |= MQTT_CLEAN_SESSION;\n\tvar_header[7] = flags;/*\u8fde\u63a5\u6807\u8bb0*/\n\tvar_header[8] = KEEP_ALIVE>>8;/*\u4fdd\u6301\u8fde\u63a5\u5b57\u6bb5\uff0c\u5360\u7528\u4e24\u4e2a\u5b57\u8282*/\n\tvar_header[9] = KEEP_ALIVE&0xFF;\n\n\tremainLen = sizeof(var_header)+payload_len; /*\u5269\u4f59\u957f\u5ea6\uff0c\u4e5f\u5c31\u662f\u53ef\u53d8\u62a5\u5934\u52a0\u4e0a\u8d1f\u8f7d\u7684\u957f\u5ea6*/\n\n\tif (remainLen > 127) {\n\t    fixedHeaderSize++;// add an additional byte for Remaining Length          \n\t}\n   \n\tfixed_header = (uint8 *)malloc(fixedHeaderSize); /*\u56fa\u5b9a\u62a5\u5934*/\n\t// Message Type\n\t*fixed_header = MQTT_MSG_CONNECT;/*\u62a5\u6587\u7c7b\u578b,connect*/\n\n\t\n\tif (remainLen <= 127) {// Remaining Length,\u5269\u4f59\u957f\u5ea6\u8ba1\u7b97\uff0c\u53ef\u53d8\u957f\u7f16\u7801\n\t    *(fixed_header+1) = remainLen;\n\t} else {\n\t    // first byte is remainder (mod) of 128, then set the MSB to indicate more bytes\n\t    *(fixed_header+1) = remainLen % 128;\n\t    *(fixed_header+1) = *(fixed_header+1) | 0x80;\n\t    // second byte is number of 128s\n\t    *(fixed_header+2) = remainLen / 128;\n\t}\n\n\tpacket_length = fixedHeaderSize+sizeof(var_header)+payload_len;/*\u56fa\u5b9a\u62a5\u5934+\u53ef\u53d8\u62a5\u5934+\u8d1f\u8f7d\u957f\u5ea6*/\n\tpacket = (uint8 *)malloc(packet_length);/*\u5206\u914d\u5185\u5b58*/\n\tmemset(packet, 0, packet_length);\n\tmemcpy(packet, fixed_header, fixedHeaderSize);/*\u586b\u5145\u56fa\u5b9a\u62a5\u5934*/\n\tfree(fixed_header);\t\n\toffset += fixedHeaderSize;\n\tmemcpy(packet+offset, var_header, sizeof(var_header));/*\u586b\u5145\u53ef\u53d8\u62a5\u5934*/\n\toffset += sizeof(var_header);\n\t\n\tpacket[offset++] = clientidlen>>8;// Client ID - UTF encoded,\u586b\u5145clientid\u957f\u5ea6+clientid\n\tpacket[offset++] = clientidlen&0xFF;\n\tmemcpy(packet+offset, client_id, clientidlen);\n\toffset += clientidlen;\n\n\tif(usernamelen) {// Username - UTF encoded,\u586b\u5145\u7528\u6237\u540d+\u7528\u6237\u540d\u957f\u5ea6\n\t\tpacket[offset++] = usernamelen>>8;\n\t\tpacket[offset++] = usernamelen&0xFF;\n\t\tmemcpy(packet+offset, user_name, usernamelen);\n\t\toffset += usernamelen;\n\t}\n\n\tif(passwordlen) {// Password - UTF encoded,\u586b\u5145\u7528\u6237\u5bc6\u7801+\u7528\u6237\u540d\u5bc6\u7801\u957f\u5ea6\n\t\tpacket[offset++] = passwordlen>>8;\n\t\tpacket[offset++] = passwordlen&0xFF;\n\t\tmemcpy(packet+offset, passwd, passwordlen);\n\t\toffset += passwordlen;\n\t}\n\t// Send the packet\n    if (client_send(sockfd,packet, packet_length) < 0){\n         free(packet);\n        return -1;\n    }\n    free(packet);\n\treturn 1;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"1632-connack-\u786e\u8ba4\u8fde\u63a5\u8bf7\u6c42",children:"16.3.2 CONNACK-\u786e\u8ba4\u8fde\u63a5\u8bf7\u6c42"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u670d\u52a1\u7aef\u53d1\u9001 CONNACK \u62a5\u6587\u54cd\u5e94\u4ece\u5ba2\u6237\u7aef\u6536\u5230\u7684 CONNECT \u62a5\u6587\u3002\u670d\u52a1\u7aef\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u7684\u7b2c\u4e00\u4e2a\u62a5\u6587\u5fc5\u987b\u662f CONNACK\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16321-\u56fa\u5b9a\u62a5\u5934",children:"16.3.2.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT \u63a7\u5236\u62a5\u6587\u7c7b\u578b (2)"}),(0,s.jsx)("td",{colspan:"4",children:"Reserved \u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5269\u4f59\u957f\u5ea6\u5b57\u6bb5\u8868\u793a\u53ef\u53d8\u62a5\u5934\u7684\u957f\u5ea6\u3002 \u5bf9\u4e8e CONNACK \u62a5\u6587\u8fd9\u4e2a\u503c\u7b49\u4e8e 2\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16322-\u53ef\u53d8\u62a5\u5934",children:"16.3.2.2 \u53ef\u53d8\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"\u63cf\u8ff0"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{colspan:"2",children:"\u8fde\u63a5\u786e\u8ba4\u6807\u8bb0"}),(0,s.jsx)("td",{colspan:"7",children:"\u4fdd\u7559\u4f4d"}),(0,s.jsx)("td",{children:"SP1"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"X"})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colspan:"10",children:"\u8fde\u63a5\u8fd4\u56de\u7801"})}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Byte1,Bit0\u8fde\u63a5\u786e\u8ba4\u6807\u5fd7"})}),"\n",(0,s.jsx)(n.p,{children:"\u4f4d 7-1 \u662f\u4fdd\u7559\u4f4d\u4e14\u5fc5\u987b\u8bbe\u7f6e\u4e3a 0,"}),"\n",(0,s.jsx)(n.p,{children:"\u5bf9\u4e8ebit0,\u5982\u679c\u670d\u52a1\u7aef\u6536\u5230\u4e00\u4e2a CleanSession \u4e3a 0 \u7684\u8fde\u63a5\uff0c \u5f53\u524d\u4f1a\u8bdd\u6807\u5fd7\u7684\u503c\u53d6\u51b3\u4e8e\u670d\u52a1\u7aef\u662f\u5426\u5df2\u7ecf\u4fdd\u5b58\u4e86 ClientId\u5bf9\u5e94\u5ba2\u6237\u7aef\u7684\u4f1a\u8bdd\u72b6\u6001\u3002 \u5982\u679c\u670d\u52a1\u7aef\u5df2\u7ecf\u4fdd\u5b58\u4e86\u4f1a\u8bdd\u72b6\u6001\uff0c \u5b83\u5fc5\u987b\u5c06 CONNACK \u62a5\u6587\u4e2d\u7684\u5f53\u524d\u4f1a\u8bdd\u6807\u5fd7\u8bbe\u7f6e\u4e3a 1 \u3002 \u5982\u679c\u670d\u52a1\u7aef\u6ca1\u6709\u5df2\u4fdd\u5b58\u7684\u4f1a\u8bdd\u72b6\u6001\uff0c \u5b83\u5fc5\u987b\u5c06 CONNACK \u62a5\u6587\u4e2d\u7684\u5f53\u524d\u4f1a\u8bdd\u8bbe\u7f6e\u4e3a 0\u3002 \u8fd8\u9700\u8981\u5c06 CONNACK \u62a5\u6587\u4e2d\u7684\u8fd4\u56de\u7801\u8bbe\u7f6e\u4e3a 0\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u8fde\u63a5\u8fd4\u56de\u7801"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c\u670d\u52a1\u7aef\u53d1\u9001\u4e86\u4e00\u4e2a\u5305\u542b\u975e\u96f6\u8fd4\u56de\u7801\u7684 CONNACK \u62a5\u6587\uff0c \u90a3\u4e48\u5b83\u5fc5\u987b\u5173\n\u95ed\u7f51\u7edc\u8fde\u63a5\u3002"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"\u503c"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"\u8fd4\u56de\u7801\u54cd\u5e94"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"\u63cf\u8ff0"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"0"})}),(0,s.jsx)(n.td,{children:"0x00"}),(0,s.jsx)(n.td,{children:"\u8fde\u63a5\u5df2\u88ab\u670d\u52a1\u7aef\u63a5\u53d7"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"1"})}),(0,s.jsx)(n.td,{children:"0x01"}),(0,s.jsx)(n.td,{children:"\u670d\u52a1\u7aef\u4e0d\u652f\u6301\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u534f\u8bae\u7248\u672c"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"2"})}),(0,s.jsx)(n.td,{children:"0x02"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u6807\u8bc6\u7b26\u662f\u6b63\u786e\u7684  UTF-8 \u7f16\u7801\uff0c \u4f46\u670d\u52a1   \u7aef\u4e0d\u5141\u8bb8\u4f7f\u7528"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"3"})}),(0,s.jsx)(n.td,{children:"0x03"}),(0,s.jsx)(n.td,{children:"\u7f51\u7edc\u8fde\u63a5\u5df2\u5efa\u7acb\uff0c \u4f46 MQTT \u670d\u52a1\u4e0d\u53ef\u7528"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"4"})}),(0,s.jsx)(n.td,{children:"0x04"}),(0,s.jsx)(n.td,{children:"\u7528\u6237\u540d\u6216\u5bc6\u7801\u7684\u6570\u636e\u683c\u5f0f\u65e0\u6548"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"5"})}),(0,s.jsx)(n.td,{children:"0x05"}),(0,s.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u672a\u88ab\u6388\u6743\u8fde\u63a5\u5230\u6b64\u670d\u52a1\u5668"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"6-255"})}),(0,s.jsx)(n.td,{}),(0,s.jsx)(n.td,{children:"\u4fdd\u7559"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"CONNACK\u6ca1\u6709\u6709\u6548\u8f7d\u8377\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16323-connack\u62a5\u6587wireshark\u6293\u5305\u5206\u6790",children:"16.3.2.3 CONNACK\u62a5\u6587wireshark\u6293\u5305\u5206\u6790"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0013.png",alt:"\u56fe3.4 CONNACK \u6293\u5305\u62a5\u6587"})}),"\n",(0,s.jsx)(n.h4,{id:"16324-c\u8bed\u8a00\u6784\u9020connect-ack\u62a5\u6587",children:"16.3.2.4 c\u8bed\u8a00\u6784\u9020connect ack\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void mqtt_connect_ack(int sockfd)\n{\n\tuint8_t cmd[]={ 0x20/*\u62a5\u6587\u7c7b\u578b*/, 0x02/*\u5269\u4f59\u957f\u5ea6*/ ,0x00,0x00/*\u6700\u540e\u4e24\u4e2a\u5b57\u8282\u53ef\u53d8\u62a5\u5934\u8868\u793a\u8fd4\u56de\u72b6\u6001\u7801*/ };\n\tsend_msg(sockfd,cmd,sizeof(cmd));\n\tsocket_record_t *socket_record = look_up_by_sokfd(sockfd);\n\tif(socket_record==NULL){\n\t\treturn;\n\t}\n\tsocket_record->is_connect=0x01;\t\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"1633-publish-\u53d1\u5e03\u6d88\u606f",children:"16.3.3 PUBLISH-\u53d1\u5e03\u6d88\u606f"}),"\n",(0,s.jsx)(n.p,{children:"PUBLISH \u63a7\u5236\u62a5\u6587\u662f\u6307\u4ece\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u6216\u8005\u670d\u52a1\u7aef\u5411\u5ba2\u6237\u7aef\u4f20\u8f93\u4e00\u4e2a\u5e94\u7528\u6d88\u606f\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0014.png",alt:"\u56fe 3.5 publish\u62a5\u6587\u7ec4\u6210\u683c\u5f0f"})}),"\n",(0,s.jsx)(n.h4,{id:"16331-\u56fa\u5b9a\u62a5\u5934",children:"16.3.3.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff083\uff09"}),(0,s.jsx)("td",{children:"dup"}),(0,s.jsx)("td",{colspan:"2",children:"Qos\u7b49\u7ea7"}),(0,s.jsx)("td",{children:"RETAIN"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Bit3 dup"})}),"\n",(0,s.jsx)(n.p,{children:"\u5982\u679c DUP \u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 0\uff0c \u8868\u793a\u8fd9\u662f\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u7aef\u7b2c\u4e00\u6b21\u8bf7\u6c42\u53d1\u9001\u8fd9\u4e2a PUBLISH \u62a5\u6587\u3002 \u5982\u679c DUP \u6807\u5fd7\u88ab\u8bbe\u7f6e\u4e3a 1\uff0c\u8868\u793a\u8fd9\u53ef\u80fd\u662f\u4e00\u4e2a\u65e9\u524d\u62a5\u6587\u8bf7\u6c42\u7684\u91cd\u53d1\u3002\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u7aef\u8bf7\u6c42\u91cd\u53d1\u4e00\u4e2a PUBLISH \u62a5\u6587\u65f6\uff0c \u5fc5\u987b\u5c06 DUP \u6807\u5fd7\u8bbe\u7f6e\u4e3a 1.\u3002 \u5bf9\u4e8e QoS0 \u7684\u6d88\u606f\uff0c DUP \u6807\u5fd7\u5fc5\u987b\u8bbe\u7f6e\u4e3a 0\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Bit1\u548cbit2 qos\u7b49\u7ea7"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Qos\u503c"}),(0,s.jsx)(n.th,{children:"bit2"}),(0,s.jsx)(n.th,{children:"bit1"}),(0,s.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"0"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"0"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"\u6700\u591a\u5206\u53d1\u4e00\u6b21"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"0"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"1"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"\u81f3\u5c11\u5206\u53d1\u4e00\u6b21"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"2"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"1"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"0"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"\u53ea\u5206\u53d1\u4e00\u6b21"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"-"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"1"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"1"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"\u4fdd\u7559\u4e0d\u4f7f\u7528"})})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"qos\u7531\u53d1\u9001\u7aef\u51b3\u5b9a\uff0c\u53d1\u9001\u7aef\u53d1\u9001\u4ec0\u4e48qos\u7684\u6d88\u606f\uff0c\u63a5\u6536\u7aef\u5c31\u56de\u590d\u4ec0\u4e48qos\u7684\u6d88\u606f\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0015.png",alt:"\u4e0d\u540cqos\u7b49\u7ea7mqtt\u62a5\u6587\u4ea4\u4e92\u6d41\u7a0b"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Bit0"})," ",(0,s.jsx)(n.strong,{children:"\u4fdd\u7559\u6807\u8bb0\u4f4d"})]}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u822c\u8bbe\u7f6e\u4e3a0\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u5269\u4f59\u957f\u5ea6"})}),"\n",(0,s.jsx)(n.p,{children:"\u7b49\u4e8e\u53ef\u53d8\u62a5\u5934\u7684\u957f\u5ea6\u52a0\u4e0a\u6709\u6548\u8f7d\u8377\u7684\u957f\u5ea6\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u53d8\u62a5\u5934\u6309\u987a\u5e8f\u5305\u542b\u4e3b\u9898\u540d\u548c\u6807\u8bc6\u7b26\u3002\u4e3b\u9898\uff0c\u7528\u4e8e\u8bc6\u522b\u6709\u6548\u8f7d\u8377\u6570\u636e\u5e94\u8be5\u88ab\u53d1\u5e03\u5230\u54ea\u4e00\u4e2a\u4fe1\u606f\u901a\u9053\uff0c\u6807\u8bc6\u7b26\uff0c\u53ea\u6709\u5f53 QoS \u7b49\u7ea7\u662f 1 \u6216 2 \u65f6\uff0c\u62a5\u6587\u6807\u8bc6\u7b26\uff08 Packet Identifier\uff09 \u5b57\u6bb5\u624d\u80fd\u51fa\u73b0\u5728 PUBLISH \u62a5\u6587\u4e2d\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16332-\u6293\u5305\u5206\u6790publish\u62a5\u6587",children:"16.3.3.2 \u6293\u5305\u5206\u6790PUBLISH\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0016.png",alt:"\u56fe 3.6 PUBLISH \u6293\u5305\u62a5\u6587"})}),"\n",(0,s.jsx)(n.h4,{id:"16333-\u6784\u9020publish-\u62a5\u6587",children:"16.3.3.3 \u6784\u9020publish \u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'int mqtt_publish_with_qos(int sockfd,const char* topic, const char* msg, uint16 msgl, uint8 retain, uint8 qos, uint16* message_id) \n{\n    socket_record_t *socket_record = look_up_by_sokfd(sockfd);\n    if(NULL == socket_record){\n        return -1;\n    }\n    DEBUG_INFO("sockfd:%d",socket_record->sockfd);\n\tuint16 topiclen = strlen(topic);\n\tuint16 msglen = msgl;\n\tuint8 *var_header = NULL; // Topic size (2 bytes), utf-encoded topic\n\tuint8 *fixed_header = NULL;\n\tuint8 fixedHeaderSize = 0,var_headerSize = 0; // Default size = one byte Message Type + one byte Remaining Length\n\tuint16 remainLen = 0;\n\tuint8 *packet = NULL;\n\tuint16 packet_length = 0;\n\n\tuint8 qos_flag = MQTT_QOS0_FLAG; /*qos\u6807\u8bb0*/\n\tuint8 qos_size = 0; // No QoS included\n\tif(qos == 1) {\n\t\tqos_size = 2; // 2 bytes for QoS\n\t\tqos_flag = MQTT_QOS1_FLAG;\n\t}\n\telse if(qos == 2) {\n\t\tqos_size = 2; // 2 bytes for QoS\n\t\tqos_flag = MQTT_QOS2_FLAG;\n\t}\n\n\t// Variable header\n\tvar_headerSize = topiclen/*\u4e3b\u9898\u5185\u5bb9*/+2/*\u4e3b\u9898\u957f\u5ea6\u5360\u7528\u4e24\u5b57\u8282*/+qos_size/*\u6807\u8bc6\u7b26*/;\n\tvar_header = (uint8 *)malloc(var_headerSize);\n\tmemset(var_header, 0, var_headerSize);\n\t*var_header = topiclen>>8;\n\t*(var_header+1) = topiclen&0xFF;\n\tmemcpy(var_header+2, topic, topiclen);\n\tif(qos_size) {//qos1\u548cqos2\u7684\u62a5\u6587\u9700\u8981\u586b\u5145\u6807\u8bc6\u7b26,\u6709\u70b9\u50cftcp\u7684seq\n        socket_record->publish_seq++;\n        if(socket_record->publish_seq == 0){\n            //unsigned short \u8868\u793a\u8303\u56f40~65535,\u6807\u8bc6\u7b26\u5fc5\u987b\u662f\u975e\u96f6\u6574\u6570\n            socket_record->publish_seq = 1;\n        }\n\t\tvar_header[topiclen+2] = (socket_record->publish_seq & 0xff00)>>8;\n\t\tvar_header[topiclen+3] = socket_record->publish_seq & 0x00ff;\n\t\tif(message_id) { \n\t\t\t*message_id = socket_record->publish_seq;\n\t\t}\n\t}\n\n\tfixedHeaderSize = 2;    // Default size = one byte Message Type + one byte Remaining Length\n\tremainLen = var_headerSize+msglen;\n\tif (remainLen > 127) {/*\u5269\u4f59\u957f\u5ea6*/\n\t\tfixedHeaderSize++;          // add an additional byte for Remaining Length\n\t}\n\tfixed_header = (uint8 *)malloc(fixedHeaderSize);/*\u56fa\u5b9a\u62a5\u5934+\u5269\u4f59\u957f\u5ea6*/\n    \n\t// Message Type, DUP flag, QoS level, Retain\n\t*fixed_header = MQTT_MSG_PUBLISH | qos_flag;/*\u62a5\u6587\u7c7b\u578b\u548cqos\u6807\u8bb0*/\n\tif(retain) {\n\t\t*fixed_header  |= MQTT_RETAIN_FLAG;/*\u662f\u5426\u4fdd\u7559*/\n\t}\n\t// Remaining Length\uff0c\u5269\u4f59\u957f\u5ea6\n\tif (remainLen <= 127) {\n\t   *(fixed_header+1) = remainLen;\n\t} else {\n\t   // first byte is remainder (mod) of 128, then set the MSB to indicate more bytes\n\t   *(fixed_header+1) = remainLen % 128;\n\t   *(fixed_header+1) = *(fixed_header+1) | 0x80;\n\t   // second byte is number of 128s\n\t   *(fixed_header+2) = remainLen / 128;\n\t}\n\n\tpacket_length = fixedHeaderSize+var_headerSize+msglen;/*\u56fa\u5b9a\u62a5\u5934+\u53ef\u53d8\u62a5\u5934+\u8d1f\u8f7d\u957f\u5ea6*/\n\tpacket = (uint8 *)malloc(packet_length);\n\tmemset(packet, 0, packet_length);\n\tmemcpy(packet, fixed_header, fixedHeaderSize);/*\u586b\u5145\u56fa\u5b9a\u62a5\u5934*/\n\tmemcpy(packet+fixedHeaderSize, var_header, var_headerSize);/*\u586b\u5145\u53ef\u53d8\u62a5\u5934*/\n\tmemcpy(packet+fixedHeaderSize+var_headerSize, msg, msglen);/*\u8d1f\u8f7d*/\n\tfree(var_header);\n\tfree(fixed_header);\n    send_msg(sockfd,packet , packet_length);\n\tfree(packet);\n\treturn 1;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"1634-pubrec-\u53d1\u5e03\u6536\u5230",children:"16.3.4 PUBREC-\u53d1\u5e03\u6536\u5230"}),"\n",(0,s.jsx)(n.p,{children:"PUBREC \u62a5\u6587\u662f\u5bf9 QoS \u7b49\u7ea7 2 \u7684 PUBLISH \u62a5\u6587\u7684\u54cd\u5e94\u3002\u5b83\u662f QoS 2 \u7b49\u7ea7\u534f\u8bae\u4ea4\u6362\u7684\u7b2c\u4e8c\u4e2a\u62a5\u6587\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16341-\u56fa\u5b9a\u62a5\u5934",children:"16.3.4.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff085\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u5269\u4f59\u957f\u5ea6"})}),"\n",(0,s.jsx)(n.p,{children:"\u8868\u793a\u53ef\u53d8\u62a5\u5934\u7684\u957f\u5ea6\u3002 \u5bf9 PUBREC \u62a5\u6587\u5b83\u7684\u503c\u7b49\u4e8e 2\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26LSB"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6709\u6548\u8f7d\u8377"})}),"\n",(0,s.jsx)(n.p,{children:"PUBREC \u62a5\u6587\u6ca1\u6709\u6709\u6548\u8f7d\u8377\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16342-pubrec\u6293\u5305\u62a5\u6587",children:"16.3.4.2 PUBREC\u6293\u5305\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0017.png",alt:"\u56fe 3.7 PUBREC\u6293\u5305\u62a5\u6587\u56fe\u793a"})}),"\n",(0,s.jsx)(n.h4,{id:"16343-c\u8bed\u8a00\u6784\u9020pubrec\u62a5\u6587",children:"16.3.4.3 c\u8bed\u8a00\u6784\u9020pubrec\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"//\u5982\u679c\u662fPUBREC\u62a5\u6587\uff0chead_type=0x50\nvoid mqtt_qos2_pubrec(int  sockfd , unsigned char *data,unsigned char head_type)\n{\n    uint16 msg_id = mqtt_parse_msg_id(data);/*\u62a5\u6587\u6807\u8bc6\u7b26,\u56de\u590d\u62a5\u6587\u548c\u63a5\u53d7\u62a5\u6587\u7684\u6807\u8bc6\u7b26\u5fc5\u987b\u4e00\u6837*/\n\tunsigned char qos2_pubrec_respon[]={head_type/*\u56fa\u5b9a\u62a5\u5934*/,0x02/*\u5269\u4f59\u957f\u5ea6*/, (msg_id&0xff00)>>8 , msg_id&0x00ff/*\u6700\u540e\u4e24\u4e2a\u5b57\u8282\u662f\u62a5\u6587\u6807\u8bc6\u7b26*/};\n\tsend_msg(sockfd,qos2_pubrec_respon,sizeof(qos2_pubrec_respon));\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"1635-pubrel-\u53d1\u5e03\u91ca\u653e",children:"16.3.5 PUBREL-\u53d1\u5e03\u91ca\u653e"}),"\n",(0,s.jsx)(n.p,{children:"PUBREL \u62a5\u6587\u662f\u5bf9 PUBREC \u62a5\u6587\u7684\u54cd\u5e94\u3002 \u5b83\u662f QoS 2 \u7b49\u7ea7\u534f\u8bae\u4ea4\u6362\u7684\u7b2c\u4e09\u4e2a\u62a5\u6587\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16351-\u56fa\u5b9a\u62a5\u5934",children:"16.3.5.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff086\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u5269\u4f59\u957f\u5ea6"})}),"\n",(0,s.jsx)(n.p,{children:"\u8868\u793a\u53ef\u53d8\u62a5\u5934\u7684\u957f\u5ea6\u3002 \u5bf9 PUBREL \u62a5\u6587\u5b83\u7684\u503c\u7b49\u4e8e 2\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26LSB"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6709\u6548\u8f7d\u8377"})}),"\n",(0,s.jsx)(n.p,{children:"PUBREL \u62a5\u6587\u6ca1\u6709\u6709\u6548\u8f7d\u8377\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16352-pubrel\u6293\u5305\u62a5\u6587",children:"16.3.5.2 PUBREL\u6293\u5305\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0018.png",alt:"\u56fe 3.8 PUBREL\u6293\u5305\u62a5\u6587\u56fe\u793a"})}),"\n",(0,s.jsx)(n.h4,{id:"16353-c\u8bed\u8a00\u6784\u9020pubrel\u62a5\u6587",children:"16.3.5.3 c\u8bed\u8a00\u6784\u9020pubrel\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"//head_type=0x62\nvoid mqtt_qos2_pubrel(int sockfd , unsigned char *data,unsigned char head_type)\n{\n    uint16 msg_id = mqtt_parse_msg_id(data);\n\tunsigned char qos2_pubrel_respon[]={head_type/*\u62a5\u6587\u7c7b\u578b*/,0x02/*\u5269\u4f59\u957f\u5ea6*/, (msg_id & 0xff00)>>8 , msg_id & 0x00ff/*\u6700\u540e\u4e24\u4e2a\u5b57\u8282\u662f\u62a5\u6587\u6807\u8bc6\u7b26*/};\n\tsend_msg(sockfd,qos2_pubrel_respon,sizeof(qos2_pubrel_respon));\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"1636-pubcomp-\u53d1\u5e03\u5b8c\u6210",children:"16.3.6 PUBCOMP-\u53d1\u5e03\u5b8c\u6210"}),"\n",(0,s.jsx)(n.p,{children:"PUBCOMP \u62a5\u6587\u662f\u5bf9 PUBREL \u62a5\u6587\u7684\u54cd\u5e94\u3002 \u5b83\u662f QoS 2 \u7b49\u7ea7\u534f\u8bae\u4ea4\u6362\u7684\u7b2c\u56db\u4e2a\u4e5f\u662f\u6700\u540e\u4e00\u4e2a\u62a5\u6587\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16361-\u56fa\u5b9a\u62a5\u5934",children:"16.3.6.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff087\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u5269\u4f59\u957f\u5ea6"})}),"\n",(0,s.jsx)(n.p,{children:"\u8868\u793a\u53ef\u53d8\u62a5\u5934\u7684\u957f\u5ea6\u3002 \u5bf9 PUBCOMP \u62a5\u6587\u5b83\u7684\u503c\u7b49\u4e8e 2\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26LSB"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6709\u6548\u8f7d\u8377"})}),"\n",(0,s.jsx)(n.p,{children:"PUBCOMP \u62a5\u6587\u6ca1\u6709\u6709\u6548\u8f7d\u8377\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16362-pubcomp\u6293\u5305\u62a5\u6587",children:"16.3.6.2 PUBCOMP\u6293\u5305\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0019.png",alt:"\u56fe 3.9 PUBCOMP\u6293\u5305\u62a5\u6587\u56fe\u793a"})}),"\n",(0,s.jsx)(n.h4,{id:"16363-c\u8bed\u8a00\u6784\u9020pubcom\u62a5\u6587",children:"16.3.6.3 c\u8bed\u8a00\u6784\u9020pubcom\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"//head_type=0x70\nvoid mqtt_qos2_pubcomp(int   sockfd , unsigned char *data,unsigned char head_type)\n{\n    uint16 msg_id = mqtt_parse_msg_id(data);/*\u62a5\u6587\u6807\u8bc6\u7b26*/\n\tunsigned char qos2_pubcomp_respon[]={head_type/*\u62a5\u6587\u7c7b\u578b*/,0x02/*\u5269\u4f59\u957f\u5ea6*/, (msg_id & 0xff00)>>8 , msg_id & 0x00ff/*\u6700\u540e\u4e24\u4e2a\u5b57\u8282\u62a5\u6587\u6807\u8bc6\u7b26*/};\n\tsend_msg(sockfd,qos2_pubcomp_respon,sizeof(qos2_pubcomp_respon));\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"1637-pingreq-\u5fc3\u8df3\u8bf7\u6c42",children:"16.3.7 PINGREQ-\u5fc3\u8df3\u8bf7\u6c42"}),"\n",(0,s.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u53d1\u9001 PINGREQ \u62a5\u6587\u7ed9\u670d\u52a1\u7aef\u7684\u3002\u7528\u4e8e\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"a)   \u5728\u6ca1\u6709\u4efb\u4f55\u5176\u5b83\u63a7\u5236\u62a5\u6587\u4ece\u5ba2\u6237\u7aef\u53d1\u7ed9\u670d\u52a1\u7684\u65f6\uff0c\u544a\u77e5\u670d\u52a1\u7aef\u5ba2\u6237\u7aef\u8fd8\u6d3b\u7740\u3002"}),"\n",(0,s.jsx)(n.p,{children:"b)   \u8bf7\u6c42\u670d\u52a1\u7aef\u53d1\u9001 \u54cd\u5e94\u786e\u8ba4\u5b83\u8fd8\u6d3b\u7740\u3002"}),"\n",(0,s.jsx)(n.p,{children:"c)   \u4f7f\u7528\u7f51\u7edc\u4ee5\u786e\u8ba4\u7f51\u7edc\u8fde\u63a5\u6ca1\u6709\u65ad\u5f00\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16371-\u56fa\u5b9a\u62a5\u5934",children:"16.3.7.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff0812\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6 0"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsx)(n.p,{children:"\u62a5\u6587\u6ca1\u6709\u53ef\u53d8\u62a5\u5934\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6709\u6548\u8f7d\u8377"})}),"\n",(0,s.jsx)(n.p,{children:"PINGREQ \u62a5\u6587\u6ca1\u6709\u6709\u6548\u8f7d\u8377\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16372-pingreq-\u6293\u5305\u62a5\u6587",children:"16.3.7.2 PINGREQ \u6293\u5305\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0020.png",alt:"\u56fe 3.10 PINGREQ\u6293\u5305\u62a5\u6587\u56fe\u793a"})}),"\n",(0,s.jsx)(n.h4,{id:"16373-c\u8bed\u8a00\u6784\u9020pingreq\u62a5\u6587",children:"16.3.7.3 c\u8bed\u8a00\u6784\u9020pingreq\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"int mqtt_ping(int sockfd)\n{\n\tuint8 packet[] = {MQTT_MSG_PINGREQ/*\u62a5\u6587\u7c7b\u578b*/,0x00/*\u5269\u4f59\u957f\u5ea6*/};\n\tint ret = send_msg(sockfd,packet, sizeof(packet));\n\treturn ret;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"1638-pingresp--\u5fc3\u8df3\u54cd\u5e94",children:"16.3.8 PINGRESP \u2013 \u5fc3\u8df3\u54cd\u5e94"}),"\n",(0,s.jsx)(n.p,{children:"\u670d\u52a1\u7aef\u53d1\u9001 PINGRESP \u62a5\u6587\u54cd\u5e94\u5ba2\u6237\u7aef\u7684 PINGREQ \u62a5\u6587\u3002 \u8868\u793a\u670d\u52a1\u7aef\u8fd8\u6d3b\u7740\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16381-\u56fa\u5b9a\u62a5\u5934",children:"16.3.8.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff0813\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6 0"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsx)(n.p,{children:"\u62a5\u6587\u6ca1\u6709\u53ef\u53d8\u62a5\u5934\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6709\u6548\u8f7d\u8377"})}),"\n",(0,s.jsx)(n.p,{children:"PINGRESP \u62a5\u6587\u6ca1\u6709\u6709\u6548\u8f7d\u8377\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16382-pingresp-\u6293\u5305\u62a5\u6587",children:"16.3.8.2 PINGRESP \u6293\u5305\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0021.png",alt:"\u56fe 3.11 PINGRESP\u6293\u5305\u62a5\u6587\u56fe\u793a"})}),"\n",(0,s.jsx)(n.h4,{id:"16383-c\u8bed\u8a00\u6784\u9020pinpresp\u62a5\u6587",children:"16.3.8.3 c\u8bed\u8a00\u6784\u9020pinpresp\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void mqtt_ping_req_reply(int sockfd)\n{\n    uint8_t cmd[]={0xd0/*\u62a5\u6587\u7c7b\u578b*/, 0x00/*\u5269\u4f59\u957f\u5ea6*/};\n    send_msg(sockfd,cmd,sizeof(cmd));\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"1639-disconnect-\u65ad\u5f00\u8fde\u63a5",children:"16.3.9 DISCONNECT \u2013\u65ad\u5f00\u8fde\u63a5"}),"\n",(0,s.jsx)(n.p,{children:"DISCONNECT \u62a5\u6587\u662f\u5ba2\u6237\u7aef\u53d1\u7ed9\u670d\u52a1\u7aef\u7684\u6700\u540e\u4e00\u4e2a\u63a7\u5236\u62a5\u6587\u3002\u8868\u793a\u5ba2\u6237\u7aef\u6b63\u5e38\u65ad\u5f00\u8fde\u63a5\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16391-\u56fa\u5b9a\u62a5\u5934",children:"16.3.9.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff0814\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6 0"})]})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsx)(n.p,{children:"DISCONNECT\u62a5\u6587\u6ca1\u6709\u53ef\u53d8\u62a5\u5934\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6709\u6548\u8f7d\u8377"})}),"\n",(0,s.jsx)(n.p,{children:"DISCONNECT \u62a5\u6587\u6ca1\u6709\u6709\u6548\u8f7d\u8377\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"16392-disconnect-\u6293\u5305\u62a5\u6587",children:"16.3.9.2 DISCONNECT \u6293\u5305\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0022.png",alt:"\u56fe 3.12 DISCONNECT\u6293\u5305\u62a5\u6587\u56fe\u793a"})}),"\n",(0,s.jsx)(n.h4,{id:"16393-c\u8bed\u8a00\u6784\u9020disconnect\u62a5\u6587",children:"16.3.9.3 c\u8bed\u8a00\u6784\u9020disconnect\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'int mqtt_disconnect(int sockfd) \n{\n\tuint8 packet[] = {MQTT_MSG_DISCONNECT/*\u62a5\u6587\u7c7b\u578b*/,0x00/*\u5269\u4f59\u957f\u5ea6*/}; \n\tint ret = client_send(sockfd,packet, sizeof(packet));\n    DEBUG_INFO("ret=%d",ret);\n\treturn ret;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"16310-subscribe-\u8ba2\u9605\u4e3b\u9898",children:"16.3.10 SUBSCRIBE-\u8ba2\u9605\u4e3b\u9898"}),"\n",(0,s.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001 SUBSCRIBE \u62a5\u6587\u7528\u4e8e\u521b\u5efa\u4e00\u4e2a\u6216\u591a\u4e2a\u8ba2\u9605\u3002 \u6bcf\u4e2a\u8ba2\u9605\u6ce8\u518c\u5ba2\u6237\u7aef\u5173\u5fc3\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u4e3b\u9898\u3002 \u4e3a\u4e86\u5c06\u5e94\u7528\u6d88\u606f\u8f6c\u53d1\u7ed9\u4e0e\u90a3\u4e9b\u8ba2\u9605\u5339\u914d\u7684\u4e3b\u9898\uff0c \u670d\u52a1\u7aef\u53d1\u9001 PUBLISH \u62a5\u6587\u7ed9\u5ba2\u6237\u7aef\u3002 SUBSCRIBE\u62a5\u6587\u4e5f\uff08\u4e3a\u6bcf\u4e2a\u8ba2\u9605\uff09\u6307\u5b9a\u4e86\u6700\u5927\u7684 QoS \u7b49\u7ea7\uff0c \u670d\u52a1\u7aef\u6839\u636e\u8fd9\u4e2a\u53d1\u9001\u5e94\u7528\u6d88\u606f\u7ed9\u5ba2\u6237\u7aef\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0023.png",alt:"\u56fe 3.13 \u8ba2\u9605\u4e3b\u9898\u62a5\u6587\u7ec4\u6210\u683c\u5f0f"})}),"\n",(0,s.jsx)(n.h4,{id:"163101-\u56fa\u5b9a\u62a5\u5934",children:"16.3.10.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff088\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6 0"})]})]}),"\n",(0,s.jsx)(n.p,{children:"SUBSCRIBE \u63a7\u5236\u62a5\u56fa\u5b9a\u62a5\u5934\u7684\u7b2c 3,2,1,0 \u4f4d\u662f\u4fdd\u7559\u4f4d\uff0c \u5fc5\u987b\u5206\u522b\u8bbe\u7f6e\u4e3a 0,0,1,0,\u670d\u52a1\u7aef\u5fc5\u987b\u5c06\u5176\u5b83\u7684\u4efb\u4f55\u503c\u90fd\u5f53\u505a\u662f\u4e0d\u5408\u6cd5\u7684\u5e76\u5173\u95ed\u7f51\u7edc\u8fde\u63a5\u3002"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5269\u4f59\u957f\u5ea6\u5b57\u6bb5"}),"\n\u7b49\u4e8e\u53ef\u53d8\u62a5\u5934\u7684\u957f\u5ea6\uff08 2 \u5b57\u8282\uff09 \u52a0\u4e0a\u6709\u6548\u8f7d\u8377\u7684\u957f\u5ea6\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26LSB"})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u670d\u52a1\u7aef\u6536\u5230\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u4e00\u4e2a SUBSCRIBE \u62a5\u6587\u65f6\uff0c \u5fc5\u987b\u4f7f\u7528 SUBACK \u62a5\u6587\u54cd\u5e94\u3002SUBACK \u62a5\u6587\u5fc5\u987b\u548c\u7b49\u5f85\u786e\u8ba4\u7684 SUBSCRIBE \u62a5\u6587\u6709\u76f8\u540c\u7684\u62a5\u6587\u6807\u8bc6\u7b26\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6709\u6548\u8f7d\u8377"})}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colspan:"9",children:"\u4e3b\u9898"})}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"8",children:"\u4e3b\u9898\u957f\u5ea6MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u4e3b\u9898\u957f\u5ea6LSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte3~n"}),(0,s.jsx)("td",{colspan:"8",children:"\u4e3b\u9898"})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colspan:"9",children:"\u670d\u52a1\u8d28\u91cf"})}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{colspan:"8",children:"\u4fdd\u7559"}),(0,s.jsx)("td",{children:"qos\u7b49\u7ea7"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"ByteN+1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"x"}),(0,s.jsx)("td",{children:"x"})]})]}),"\n",(0,s.jsx)(n.p,{children:"QoS \u4e0d\u7b49\u4e8e 0,1 \u6216 2\uff0c \u670d\u52a1\u7aef\u5fc5\u987b\u8ba4\u4e3a SUBSCRIBE \u62a5\u6587\u662f\u4e0d\u5408\u6cd5\u7684\u5e76\u5173\u95ed\u7f51\u7edc\u8fde\u63a5\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"163102-subscribe\u62a5\u6587\u6293\u5305",children:"16.3.10.2 SUBSCRIBE\u62a5\u6587\u6293\u5305"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0024.png",alt:"\u56fe 3.14 \u8ba2\u9605\u4e3b\u9898\u6293\u5305\u62a5\u6587"})}),"\n",(0,s.jsx)(n.h4,{id:"163103-c\u8bed\u8a00\u6784\u9020subscribe\u62a5\u6587",children:"16.3.10.3 c\u8bed\u8a00\u6784\u9020subscribe\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"static uint16 su_seq = 1;\nint mqtt_subscribe_theme(int sockfd,char *Theme , uint8_t Qos)\n{\n\tsu_seq++;//\u62a5\u6587\u6807\u8bc6\u7b26\n\tif(su_seq == 0){\n\t\tsu_seq = 1;\n\t}\n\tuint16_t MessageId = su_seq;\n\tuint8_t cmd[1024]={0};\n    //\u62a5\u6587\u6807\u793a\u7b26\u957f\u5ea62 + \u4e3b\u9898\u957f\u5ea6\u4f4d\u5360\u75282\u5b57\u8282+\u4e3b\u9898\u5185\u5bb9+qos\u6807\u8bc6\n\tint data_length = 2+2+strlen(Theme)+1; \n\tint playload_len = strlen(Theme);\n\tuint8_t len_byte[4] ={0x00 , 0x00 ,0x00 ,0x00};\n\tuint8_t byte_num = length_trans_byte_form(data_length , len_byte);/*\u628a\u5269\u4f59\u957f\u5ea6\u8f6c\u6362\u6210\u53d8\u957f\u7f16\u7801*/\n\tcmd[0] = 0x82;\n\tmemcpy(&cmd[1] , len_byte , byte_num);\n\n\tcmd[1+byte_num]=(MessageId & 0xff00) >> 8 ;\n\tcmd[1+byte_num+1] = MessageId & 0x00ff;\t\t\n\tcmd[1+byte_num+1+1] = (playload_len & 0xff00) >> 8;\n\tcmd[1+byte_num+1+1+1] = playload_len & 0x00ff;\n\tmemcpy(&cmd[1+byte_num+1+1+1+1] , Theme , playload_len);\n\tcmd[1+byte_num+1+1+1+1+playload_len] = Qos;\n\tclient_send(sockfd,cmd, 1+byte_num+1+1+1+1+playload_len+1);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"16311-suback-\u8ba2\u9605\u786e\u8ba4",children:"16.3.11 SUBACK \u2013\u8ba2\u9605\u786e\u8ba4"}),"\n",(0,s.jsx)(n.p,{children:"\u670d\u52a1\u7aef\u53d1\u9001 SUBACK \u62a5\u6587\u7ed9\u5ba2\u6237\u7aef\uff0c\u7528\u4e8e\u786e\u8ba4\u5b83\u5df2\u6536\u5230\u5e76\u4e14\u6b63\u5728\u5904\u7406 SUBSCRIBE \u62a5\u6587\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"163111-\u56fa\u5b9a\u62a5\u5934",children:"16.3.11.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff089\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6 0"})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5269\u4f59\u957f\u5ea6\u5b57\u6bb5"}),"\n\u7b49\u4e8e\u53ef\u53d8\u62a5\u5934\u7684\u957f\u5ea6\u52a0\u4e0a\u6709\u6548\u8f7d\u8377\u7684\u957f\u5ea6\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26LSB"})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u53d8\u62a5\u5934\u5305\u542b\u7b49\u5f85\u786e\u8ba4\u7684 SUBSCRIBE \u62a5\u6587\u7684\u62a5\u6587\u6807\u8bc6\u7b26\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"3112-suback\u6293\u5305\u62a5\u6587",children:"3.11.2 SUBACK\u6293\u5305\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0025.png",alt:"\u56fe 3.15\u8ba2\u9605\u4e3b\u9898ack\u6293\u5305\u62a5\u6587"})}),"\n",(0,s.jsx)(n.h4,{id:"163113-c\u8bed\u8a00\u6784\u9020suback\u62a5\u6587",children:"16.3.11.3 c\u8bed\u8a00\u6784\u9020suback\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void mqtt_subscribe_ack(int sockfd,const uint8 *buf)\n{\n    uint16 msg_id = mqtt_parse_msg_id(buf);/*\u63d0\u53d6\u62a5\u6587\u6807\u8bc6\u7b26*/\n    uint8 qos = MQTTParseMessageQos(buf);/*\u63d0\u53d6\u62a5\u6587qos*/\n    uint8 cmd[]={0x90,0x03/*\u5269\u4f59\u957f\u5ea6*/, (msg_id & 0xff00) >> 8, msg_id & 0x00ff,qos};\n    send_msg(sockfd,cmd,sizeof(cmd));\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"16312-unsubscribe-\u53d6\u6d88\u8ba2\u9605",children:"16.3.12 UNSUBSCRIBE \u2013\u53d6\u6d88\u8ba2\u9605"}),"\n",(0,s.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u53d1\u9001 UNSUBSCRIBE \u62a5\u6587\u7ed9\u670d\u52a1\u7aef\uff0c \u7528\u4e8e\u53d6\u6d88\u8ba2\u9605\u4e3b\u9898\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0026.png",alt:"\u56fe 3.16\u53d6\u6d88\u8ba2\u9605\u4e3b\u9898\u62a5\u6587\u7ed3\u6784"})}),"\n",(0,s.jsx)(n.h4,{id:"163121-\u56fa\u5b9a\u62a5\u5934",children:"16.3.12.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff0810\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6 0"})]})]}),"\n",(0,s.jsx)(n.p,{children:"UNSUBSCRIBE \u62a5\u6587\u56fa\u5b9a\u62a5\u5934\u7684\u7b2c 3,2,1,0 \u4f4d\u662f\u4fdd\u7559\u4f4d\u4e14\u5fc5\u987b\u5206\u522b\u8bbe\u7f6e\u4e3a 0,0,1,0\u3002 \u670d\u52a1\u7aef\u5fc5\u987b\u8ba4\u4e3a\u4efb\u4f55\u5176\u5b83\u7684\u503c\u90fd\u662f\u4e0d\u5408\u6cd5\u7684\u5e76\u5173\u95ed\u7f51\u7edc\u8fde\u63a5\u3002"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5269\u4f59\u957f\u5ea6\u5b57\u6bb5"}),"\n\u7b49\u4e8e\u53ef\u53d8\u62a5\u5934\u7684\u957f\u5ea6\uff0c\u52a0\u4e0a\u6709\u6548\u8f7d\u8377\u7684\u957f\u5ea6\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26LSB"})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u53d8\u62a5\u5934\u5305\u542b\u4e00\u4e2a\u62a5\u6587\u6807\u8bc6\u7b26\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6709\u6548\u8f7d\u8377"})}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colspan:"9",children:"\u4e3b\u98981"})}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"8",children:"\u4e3b\u9898\u957f\u5ea6MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u4e3b\u9898\u957f\u5ea6LSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte3~n"}),(0,s.jsx)("td",{colspan:"8",children:"\u4e3b\u9898"})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colspan:"9",children:"\u4e3b\u98982"})})]}),"\n",(0,s.jsx)(n.p,{children:"UNSUBSCRIBE \u62a5\u6587\u7684\u6709\u6548\u8f7d\u8377\u5fc5\u987b\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u6d88\u606f\u8fc7\u6ee4\u5668\u3002 \u6ca1\u6709\u6709\u6548\u8f7d\u8377\u7684 UNSUBSCRIBE \u62a5\u6587\u662f\u8fdd\u53cd\u534f\u8bae\u7684\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"163122-unsubscribe\u6293\u5305\u62a5\u6587",children:"16.3.12.2 UNSUBSCRIBE\u6293\u5305\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0027.png",alt:"\u56fe 3.17\u53d6\u6d88\u8ba2\u9605\u4e3b\u9898\u6293\u5305\u62a5\u6587"})}),"\n",(0,s.jsx)(n.h4,{id:"163123-c\u8bed\u8a00\u6784\u9020unsubscribe\u62a5\u6587",children:"16.3.12.3 c\u8bed\u8a00\u6784\u9020unsubscribe\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"static uint16 un_seq = 1;\nint mqtt_unsubscribe_theme(int sockfd,const char* topic)\n{\n\tun_seq++;\n\tif(un_seq == 0){\n\t\tun_seq = 1;\n\t}\n    uint16_t MessageId = un_seq;\n\tuint8_t cmd[1024]={0};\n    //\u62a5\u6587\u6807\u793a\u7b26\u957f\u5ea62 + \u4e3b\u9898\u957f\u5ea6\u4f4d\u5360\u75282\u5b57\u8282+\u4e3b\u9898\u5185\u5bb9+qos\u6807\u8bc6\n\tint data_length = 2+2+strlen(topic)+1; \n\tint playload_len = strlen(topic);\n\tuint8_t len_byte[4] ={0x00 , 0x00 ,0x00 ,0x00};\n\tuint8_t byte_num = length_trans_byte_form(data_length , len_byte);/*\u5269\u4f59\u957f\u5ea6\u8f6c\u6362\u6210\u53d8\u957f\u7f16\u7801*/\n\tcmd[0] = 0xa2;\n\tmemcpy(&cmd[1] , len_byte , byte_num);\n    \n\tcmd[1+byte_num]=(MessageId & 0xff00) >> 8 ;\n\tcmd[1+byte_num+1] = MessageId & 0x00ff;\t\t\n\tcmd[1+byte_num+1+1] = (playload_len & 0xff00) >> 8;\n\tcmd[1+byte_num+1+1+1] = playload_len & 0x00ff;\n\tmemcpy(&cmd[1+byte_num+1+1+1+1] , topic , playload_len);\n\tclient_send(sockfd,cmd,1+byte_num+1+1+1+1+playload_len+1);\n\treturn 1;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"16313-unsuback-\u53d6\u6d88\u8ba2\u9605\u786e\u8ba4",children:"16.3.13 UNSUBACK \u2013\u53d6\u6d88\u8ba2\u9605\u786e\u8ba4"}),"\n",(0,s.jsx)(n.p,{children:"\u670d\u52a1\u7aef\u53d1\u9001 UNSUBACK \u62a5\u6587\u7ed9\u5ba2\u6237\u7aef\u7528\u4e8e\u786e\u8ba4\u6536\u5230 UNSUBSCRIBE \u62a5\u6587\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0028.png",alt:"\u56fe 3.18\u53d6\u6d88\u8ba2\u9605\u4e3b\u9898ack\u62a5\u6587\u7ec4\u6210"})}),"\n",(0,s.jsx)(n.h4,{id:"163131-\u56fa\u5b9a\u62a5\u5934",children:"16.3.13.1 \u56fa\u5b9a\u62a5\u5934"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte 1"}),(0,s.jsx)("td",{colspan:"4",children:"MQTT\u62a5\u6587\u7c7b\u578b\uff0811\uff09"}),(0,s.jsx)("td",{colspan:"4",children:"\u4fdd\u7559\u4f4d"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u5269\u4f59\u957f\u5ea6 0"})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5269\u4f59\u957f\u5ea6\u5b57\u6bb5"}),"\n\u8868\u793a\u53ef\u53d8\u62a5\u5934\u7684\u957f\u5ea6\uff0c \u5bf9 UNSUBACK \u62a5\u6587\u8fd9\u4e2a\u503c\u7b49\u4e8e 2\u3002"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u53ef\u53d8\u62a5\u5934"})}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"bit"}),(0,s.jsx)("td",{children:"7"}),(0,s.jsx)("td",{children:"6"}),(0,s.jsx)("td",{children:"5"}),(0,s.jsx)("td",{children:"4"}),(0,s.jsx)("td",{children:"3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte1"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26MSB"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Byte2"}),(0,s.jsx)("td",{colspan:"8",children:"\u62a5\u6587\u6807\u8bc6\u7b26LSB"})]})]}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u53d8\u62a5\u5934\u5305\u542b\u7b49\u5f85\u786e\u8ba4\u7684 UNSUBSCRIBE \u62a5\u6587\u7684\u62a5\u6587\u6807\u8bc6\u7b26\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"163122-unsubscribe-ack\u6293\u5305\u62a5\u6587",children:"16.3.12.2 UNSUBSCRIBE ACK\u6293\u5305\u62a5\u6587"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0029.png",alt:"\u56fe 3.19\u53d6\u6d88\u8ba2\u9605\u4e3b\u9898ACK\u6293\u5305\u62a5\u6587"})}),"\n",(0,s.jsx)(n.h4,{id:"163123-c\u8bed\u8a00\u6784\u9020unsubscribe\u62a5\u6587-1",children:"16.3.12.3 c\u8bed\u8a00\u6784\u9020unsubscribe\u62a5\u6587"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"void mqtt_unsubscribe_ack(int sockfd,const uint8 *buf)\n{\n    uint16 msg_id = mqtt_parse_msg_id(buf);\n    uint8 cmd[]={0xb0,0x02/*\u5269\u4f59\u957f\u5ea6*/,(msg_id & 0xff00) >> 8, msg_id & 0x00ff/*\u6700\u540e\u4e24\u4e2a\u5b57\u8282\u662f\u62a5\u6587\u6807\u8bc6\u7b26*/};\n    send_msg(sockfd,cmd,sizeof(cmd));\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"16314-\u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u4ea4\u4e92\u64cd\u4f5c\u8fc7\u7a0b",children:"16.3.14 \u670d\u52a1\u7aef\u4e0e\u5ba2\u6237\u7aef\u4ea4\u4e92\u64cd\u4f5c\u8fc7\u7a0b"}),"\n",(0,s.jsx)(n.h4,{id:"163141-\u7f16\u8bd1",children:"16.3.14.1 \u7f16\u8bd1"}),"\n",(0,s.jsx)(n.p,{children:"\u7f16\u8bd1client\u4e4b\u524d\u5148\u5728\u4ee3\u7801\u4e2d\u6307\u5b9aserver ip"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0030.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u8fdb\u5165client\u76ee\u5f55\uff0c\u76f4\u63a5make\u5373\u53ef"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0031.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u8fdb\u5165server\u76ee\u5f55\uff0c\u76f4\u63a5make\u5373\u53ef"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0032.png",alt:""})}),"\n",(0,s.jsx)(n.h4,{id:"163142-\u6267\u884c",children:"16.3.14.2 \u6267\u884c"}),"\n",(0,s.jsx)(n.p,{children:"\u5148\u8fd0\u884cserver"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0033.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u518d\u8fd0\u884cclient"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0034.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"Client\u64cd\u4f5c\u6d41\u7a0b"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0035.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u5728server\u7aef\u67e5\u770b"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/MQTT_Image0036.png",alt:""})})]})}function j(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(x,{...e})}):x(e)}}}]);