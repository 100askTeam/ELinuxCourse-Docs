"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1784],{8378:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>u,frontMatter:()=>d,metadata:()=>l,toc:()=>p});var s=t(4848),i=t(8453);const d={sidebar_position:1},c="3 \u8f93\u5165\u7cfb\u7edf",l={id:"Knowledge-Notes/InputSystem",title:"3 \u8f93\u5165\u7cfb\u7edf",description:"3.1 \u4ec0\u4e48\u662f\u8f93\u5165\u7cfb\u7edf\uff1f",source:"@site/docs/Knowledge-Notes/03_InputSystem.md",sourceDirName:"Knowledge-Notes",slug:"/Knowledge-Notes/InputSystem",permalink:"/docs/Knowledge-Notes/InputSystem",draft:!1,unlisted:!1,editUrl:"https://github.com/100askTeam/linux-docs/tree/main/docs/Knowledge-Notes/03_InputSystem.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"KnowledgeNotes",next:{title:"4 Linux\u8fdb\u7a0b\u95f4\u901a\u4fe1",permalink:"/docs/Knowledge-Notes/ProcessCommunication"}},r={},p=[{value:"3.1 \u4ec0\u4e48\u662f\u8f93\u5165\u7cfb\u7edf\uff1f",id:"31-\u4ec0\u4e48\u662f\u8f93\u5165\u7cfb\u7edf",level:2},{value:"3.2 \u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u6846\u67b6\u63cf\u8ff0",id:"32-\u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u6846\u67b6\u63cf\u8ff0",level:2},{value:"3.3 \u8f93\u5165\u7cfb\u7edf\u4e8b\u4ef6\u7684\u8bfb\u53d6\u4e0e\u5206\u6790",id:"33-\u8f93\u5165\u7cfb\u7edf\u4e8b\u4ef6\u7684\u8bfb\u53d6\u4e0e\u5206\u6790",level:2},{value:"3.4 \u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e00\uff1a\u901a\u7528USB\u9f20\u6807\u4e8b\u4ef6\u8bfb\u53d6",id:"34-\u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e00\u901a\u7528usb\u9f20\u6807\u4e8b\u4ef6\u8bfb\u53d6",level:2},{value:"3.5 \u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e8c\uff1a\u901a\u7528\u952e\u76d8\u4e8b\u4ef6\u8bfb\u53d6",id:"35-\u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e8c\u901a\u7528\u952e\u76d8\u4e8b\u4ef6\u8bfb\u53d6",level:2},{value:"3.6 \u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e09\uff1a\u767e\u95ee\u7f51imx6ul\u5f00\u53d1\u677f\u89e6\u6478\u5c4f\u4e8b\u4ef6\u8bfb\u53d6",id:"36-\u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e09\u767e\u95ee\u7f51imx6ul\u5f00\u53d1\u677f\u89e6\u6478\u5c4f\u4e8b\u4ef6\u8bfb\u53d6",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"3-\u8f93\u5165\u7cfb\u7edf",children:"3 \u8f93\u5165\u7cfb\u7edf"}),"\n",(0,s.jsx)(n.h2,{id:"31-\u4ec0\u4e48\u662f\u8f93\u5165\u7cfb\u7edf",children:"3.1 \u4ec0\u4e48\u662f\u8f93\u5165\u7cfb\u7edf\uff1f"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5728\u4e86\u89e3\u8f93\u5165\u7cfb\u7edf\u4e4b\u524d\uff0c\u5148\u6765\u4e86\u89e3\u4ec0\u4e48\u662f\u8f93\u5165\u8bbe\u5907\uff1f\u5e38\u89c1\u7684\u8f93\u5165\u8bbe\u5907\u6709\u952e\u76d8\u3001\u9f20\u6807\u3001\u9065\u63a7\u6746\u3001\u4e66\u5199\u677f\u3001\u89e6\u6478\u5c4f\u7b49\u7b49\uff0c\u7528\u6237\u901a\u8fc7\u8fd9\u4e9b\u8f93\u5165\u8bbe\u5907\u4e0eLinux\u7cfb\u7edf\u8fdb\u884c\u6570\u636e\u4ea4\u6362\uff0cLinux\u7cfb\u7edf\u4e3a\u4e86\u7edf\u4e00\u7ba1\u63a7\u548c\u5904\u7406\u8fd9\u4e9b\u8bbe\u5907\uff0c\u4e8e\u662f\u5c31\u5b9e\u73b0\u4e86\u4e00\u5957\u56fa\u5b9a\u7684\u4e0e\u786c\u4ef6\u65e0\u5173\u7684\u8f93\u5165\u7cfb\u7edf\u6846\u67b6\uff0c\u4f9b\u7528\u6237\u7a7a\u95f4\u7a0b\u5e8f\u4f7f\u7528\uff0c\u8fd9\u5c31\u662f\u8f93\u5165\u7cfb\u7edf\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"32-\u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u6846\u67b6\u63cf\u8ff0",children:"3.2 \u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u6846\u67b6\u63cf\u8ff0"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5728Linux\u8f93\u5165\u7cfb\u7edf\u4e2d\uff0c\u4e3b\u8981\u5206\u4e09\u5c42\u8fdb\u884c\u7ba1\u7406\uff0c\u5206\u522b\u662finput core(\u8f93\u5165\u7cfb\u7edf\u6838\u5fc3\u5c42)\u3001drivers(\u8f93\u5165\u7cfb\u7edf\u9a71\u52a8\u5c42)\u4ee5\u53caevent handlers(\u8f93\u5165\u7cfb\u7edf\u4e8b\u4ef6\u5c42)\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u8fd9\u5c31\u662fLinux\u8f93\u5165\u7cfb\u7edf\u7684\u57fa\u672c\u6846\u67b6:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image001.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u4e3e\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u4f8b\u5b50\uff0c\u6bd4\u5982\u7528\u6237\u6309\u4e0b\u952e\u76d8\u91cc\u7684\u5176\u4e2d\u4e00\u4e2a\u6309\u952e\uff0c\u5b83\u9075\u5faa\u6d41\u7a0b\u662f\u8fd9\u6837\u7684\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u6309\u952e\u6309\u4e0b--\x3e\u8f93\u5165\u7cfb\u7edf\u9a71\u52a8\u5c42--\x3e\u8f93\u5165\u7cfb\u7edf\u6838\u5fc3\u5c42--\x3e\u8f93\u5165\u7cfb\u7edf\u4e8b\u4ef6\u5c42---\x3e\u7528\u6237\u7a7a\u95f4"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5bf9\u4e8e\u5e94\u7528\u7a0b\u5e8f\u8f6f\u4ef6\u7f16\u7a0b\u7684\u89d2\u5ea6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5173\u6ce8\u7528\u6237\u7a7a\u95f4\u662f\u600e\u4e48\u5f97\u5230\u6309\u952e\u6309\u4e0b\u4ee5\u540e\u83b7\u53d6\u7684\u662f\u4ec0\u4e48\u4e8b\u4ef6\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f8b\u5982\u6211\u60f3\u77e5\u9053\u6211\u5f53\u524d\u6309\u4e0b\u7684\u6309\u662f\u77ed\u6309\u8fd8\u662f\u957f\u6309\uff1f\u6216\u8005\u6211\u60f3\u77e5\u9053\u5f53\u524d\u6211\u6309\u4e0b\u952e\u76d8\u7684\u662f\u7a7a\u683c\u952e\u8fd8\u662f\u56de\u8f66\u952e\u7b49\u7b49\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"33-\u8f93\u5165\u7cfb\u7edf\u4e8b\u4ef6\u7684\u8bfb\u53d6\u4e0e\u5206\u6790",children:"3.3 \u8f93\u5165\u7cfb\u7edf\u4e8b\u4ef6\u7684\u8bfb\u53d6\u4e0e\u5206\u6790"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u7528\u6237\u7a7a\u95f4\u7684\u8bbe\u5907\u8282\u70b9\u90a3\u4e48\u591a\uff0c\u600e\u4e48\u77e5\u9053\u5f53\u524d\u662f\u54ea\u4e2a\u8bbe\u5907\u4e0a\u62a5\u7684\u5462\uff1f\u4f8b\u5982\u60f3\u77e5\u9053\u952e\u76d8\u662f\u7531\u54ea\u4e2a\u8bbe\u5907\u8282\u70b9\u4e0a\u62a5\u7684\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u8fd9\u6761\u6307\u4ee4\u6765\u83b7\u53d6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"cat /proc/bus/input/devices\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u8fd9\u6761\u6307\u4ee4\u7684\u542b\u4e49\u5c31\u662f\u83b7\u53d6\u4e0eevent\u5bf9\u5e94\u7684\u76f8\u5173\u8bbe\u5907\u4fe1\u606f\uff0c\u5728ubuntu\u7cfb\u7edf\u4e0a\uff0c\u6211\u4eec\u8f93\u5165\u8fd9\u4e2a\u6307\u4ee4\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u7ed3\u679c\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image002.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u90a3\u4e48\u8fd9\u91cc\u7684I\u3001N\u3001P\u3001S\u3001U\u3001H\u3001B\u5bf9\u5e94\u7684\u6bcf\u4e00\u884c\u662f\u4ec0\u4e48\u542b\u4e49\u5462\uff1f"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["I",":id"," of the device(\u8bbe\u5907ID)"]})}),"\n",(0,s.jsx)(n.p,{children:"\u8be5\u53c2\u6570\u7531\u7ed3\u6784\u4f53struct input_id\u6765\u8fdb\u884c\u63cf\u8ff0"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"41 struct input_id {\n42 \t//\u603b\u7ebf\u7c7b\u578b\n43 \t__u16 bustype;\n44 \t//\u4e0e\u5382\u5546\u76f8\u5173ID\n45 \t__u16 vendor;\n46 \t//\u4e0e\u4ea7\u54c1\u76f8\u5173ID\n47 \t__u16 product;\n48 \t//\u7248\u672cID\n49 \t__u16 version;\n50 };\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["N",":name"," of the device"]})}),"\n",(0,s.jsx)(n.p,{children:"\u8bbe\u5907\u540d\u79f0"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["P",":physical"," path to the device in the system hierarchy"]})}),"\n",(0,s.jsx)(n.p,{children:"\u7cfb\u7edf\u5c42\u6b21\u7ed3\u6784\u4e2d\u8bbe\u5907\u7684\u7269\u7406\u8def\u5f84\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["S",":sysfs"," path"]})}),"\n",(0,s.jsx)(n.p,{children:"\u4f4d\u4e8esys\u6587\u4ef6\u7cfb\u7edf\u7684\u8def\u5f84"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["U",":unique"," identification code for the device(if device has it)"]})}),"\n",(0,s.jsx)(n.p,{children:"\u8bbe\u5907\u7684\u552f\u4e00\u6807\u8bc6\u7801"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["H",":list"," of input handles associated with the device."]})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0e\u8bbe\u5907\u5173\u8054\u7684\u8f93\u5165\u53e5\u67c4\u5217\u8868\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["B",":bitmaps","(\u4f4d\u56fe)"]})}),"\n",(0,s.jsxs)(n.p,{children:["PROP",":device"," properties and quirks."]}),"\n",(0,s.jsxs)(n.p,{children:["EV",":types"," of events supported by the device."]}),"\n",(0,s.jsxs)(n.p,{children:["KEY",":keys","/buttons this device has."]}),"\n",(0,s.jsxs)(n.p,{children:["MSC",":miscellaneous"," events supported by the device."]}),"\n",(0,s.jsxs)(n.p,{children:["LED",":leds"," present on the device."]}),"\n",(0,s.jsx)(n.p,{children:"PROP:\u8bbe\u5907\u5c5e\u6027\u548c\u602a\u7656\u3002"}),"\n",(0,s.jsx)(n.p,{children:"EV:\u8bbe\u5907\u652f\u6301\u7684\u4e8b\u4ef6\u7c7b\u578b\u3002"}),"\n",(0,s.jsx)(n.p,{children:"KEY:\u6b64\u8bbe\u5907\u5177\u6709\u7684\u952e/\u6309\u94ae\u3002"}),"\n",(0,s.jsx)(n.p,{children:"MSC:\u8bbe\u5907\u652f\u6301\u7684\u5176\u4ed6\u4e8b\u4ef6\u3002"}),"\n",(0,s.jsx)(n.p,{children:"LED:\u8bbe\u5907\u4e0a\u7684\u6307\u793a\u706f\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u8fc7\u4e86\u89e3\u4ee5\u4e0a\u53c2\u6570\u7684\u542b\u4e49\uff0c\u7ed3\u5408\u4ee5\u4e0b\u6307\u4ee4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"cat /proc/bus/input/devices\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u663e\u793a\u51fa\u6765\u7684\u4fe1\u606f\u5f88\u5bb9\u6613\u53ef\u4ee5\u77e5\u9053event1\u5373\u662f\u952e\u76d8\u4e0a\u62a5\u7684\u4e8b\u4ef6\u8bbe\u5907\u8282\u70b9\uff0c\u901a\u8fc7\u8bfb\u53d6\u8fd9\u4e2aevent1\u5373\u53ef\u83b7\u5f97\u5f53\u524d\u7528\u6237\u6309\u4e0b\u7684\u6309\u952e\u5177\u4f53\u662f\u54ea\u4e2a\u4e8b\u4ef6\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u4f7f\u7528cat\u547d\u4ee4\u6765\u6d4b\u8bd5\u952e\u76d8\u4e8b\u4ef6"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image003.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u6211\u4eec\u5728\u7ec8\u7aef\u8f93\u5165"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"cat /dev/input/event1\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u8fd9\u6761\u6307\u4ee4\u5e76\u6309\u56de\u8f66\u952e\u540e\u53ef\u4ee5\u770b\u5230\u4e00\u5806\u4e71\u7801\u6570\u636e\uff0c\u8fd9\u4e9b\u6570\u636e\u6211\u4eec\u770b\u4e0d\u61c2\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u5982\u679c\u6309\u4e0b\u4e86\u6309\u952e\uff0c\u7ec8\u7aef\u6709\u53cd\u9988\u6d88\u606f\uff0c\u8fd9\u65f6\u5019\u5c31\u77e5\u9053\u8fd9\u4e2a\u4e8b\u4ef6\u5c31\u662f\u6211\u4eec\u5f53\u524d\u64cd\u4f5c\u7684\u8fd9\u4e2a\u8bbe\u5907\u4e0a\u62a5\u7684\u4e8b\u4ef6\uff0c\u90a3\u4e48\u5982\u4f55\u80fd\u8ba9\u8fd9\u4e9b\u6570\u636e\u770b\u5f97\u61c2\u5462\uff1f\u8fd9\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528hexdump\u547d\u4ee4\u6765\u8bfb\u53d6\u952e\u76d8\u4e8b\u4ef6\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u4f7f\u7528hexdump\u547d\u4ee4\u6765\u6d4b\u8bd5\u952e\u76d8\u4e8b\u4ef6"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image004.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u4e9b\u6570\u503c\u662f\u901a\u8fc7input_event\u7ed3\u6784\u4f53\u6765\u4e0a\u62a5\u7684\uff0c\u5b83\u4f4d\u4e8e/usr/include/linux/input.h\u8fd9\u4e2a\u5934\u6587\u4ef6\uff0cinput_event\u7ed3\u6784\u4f53\u63cf\u8ff0\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"24 struct input_event {\n25 \t//\u4e8b\u4ef6\u53d1\u751f\u7684\u4e8b\u4ef6\n26 \tstruct timeval time;\n27 \t//\u4e8b\u4ef6\u7c7b\u578b\n28 \t__u16 type;\n29 \t//\u4e8b\u4ef6\u503c\n30 \t__u16 code;\n31 \t//\u8be5\u4e8b\u4ef6\u4e0a\u62a5\u7684\u6570\u503c\n32 \t__s32 value;\n33 };\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u800cinput_event\u7ed3\u6784\u4f53\u4e2d\u7684time\u5373\u662f\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"1 struct timeval\n2 {\n3 \t__time_t tv_sec;        /* Seconds. */\n4 \t__suseconds_t tv_usec;    /*Microseconds. */\n5 };\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5176\u4e2dtv_sec\u4e3aEpoch\u5230\u521b\u5efastruct timeval\u65f6\u7684\u79d2\u6570\uff0ctv_usec\u4e3a\u5fae\u79d2\u6570\uff0c\u5373\u79d2\u540e\u9762\u7684\u96f6\u5934\uff0cEpoch\u7684\u610f\u601d\u662f\u6307\u5b9a\u4e3a1970\u5e74\u4e00\u6708\u4e00\u65e5\u51cc\u6668\u96f6\u70b9\u96f6\u5206\u96f6\u79d2\uff0c\u683c\u6797\u5a01\u6cbb\u65f6\u95f4\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u56de\u5230input_event\u7ed3\u6784\u4f53\uff0c\u4e8b\u4ef6\u7c7b\u578btype\u4e3b\u8981\u6709\u4ee5\u4e0b\u4e09\u79cd\uff0c\u5206\u522b\u662f\uff1a\u76f8\u5bf9\u4e8b\u4ef6\u3001\u7edd\u5bf9\u4e8b\u4ef6\u3001\u952e\u76d8\u4e8b\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u4f8b\u5982\uff1a\u9f20\u6807\u5c31\u662f\u4e00\u4e2a\u76f8\u5bf9\u4e8b\u4ef6\uff0c\u6709\u4e9b\u60c5\u51b5\u4e0b\u4e5f\u6709\u53ef\u80fd\u662f\u7edd\u5bf9\u4e8b\u4ef6\uff0c\u5f53\u79fb\u52a8\u9f20\u6807\u7684\u65f6\u5019\uff0ctype\u7c7b\u578b\u4e5f\u5c31\u662f\u5e95\u5c42\u4e0a\u62a5\u7ed9\u7528\u6237\u7684\u4e8b\u4ef6\u7c7b\u578b\uff0c\u90a3\u4e48code\u8868\u793a\u7684\u5c31\u662f\u76f8\u5bf9\u4e8e\u9f20\u6807\u5f53\u524d\u7684\u4f4d\u7f6e\u7684X\u6216\u8005Y\u7684\u5750\u6807\uff0cvalue\u5219\u8868\u793a\u76f8\u5bf9\u4e8e\u5f53\u524d\u7684\u4f4d\u7f6e\u504f\u79fb\u4e86\u591a\u5c11\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u4e8b\u4ef6\u7c7b\u578b(type)"})}),"\n",(0,s.jsx)(n.p,{children:"\u6587\u4ef6\u5934\u6587\u4ef6\u8def\u5f84\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"/usr/include/linux/input-event-codes.h\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u7136Linux\u5185\u6838\u7248\u672c\u8f83\u4f4e\u7684\u6709\u53ef\u80fd\u5728\u4ee5\u4e0b\u8def\u5f84\u7684\u8fd9\u4e2a\u5934\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"/usr/include/linux/input.h\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"34 /*\n35  * Event types\n36  */\n37 \n38 #define EV_SYN\t\t\t0x00\t//\u540c\u6b65\u4e8b\u4ef6\n39 #define EV_KEY\t\t\t0x01\t//\u6309\u952e\u4e8b\u4ef6\n40 #define EV_REL\t\t\t0x02\t//\u76f8\u5bf9\u4e8b\u4ef6\n41 #define EV_ABS\t\t\t0x03\t//\u7edd\u5bf9\u4e8b\u4ef6\n42 #define EV_MSC\t\t\t0x04\n43 #define EV_SW\t\t\t0x05\n44 #define EV_LED\t\t\t0x11\n45 #define EV_SND\t\t\t0x12\n46 #define EV_REP\t\t\t0x14\n47 #define EV_FF\t\t\t0x15\n48 #define EV_PWR\t\t\t0x16\n49 #define EV_FF_STATUS\t\t0x17\n50 #define EV_MAX\t\t\t0x1f\n51 #define EV_CNT\t\t\t(EV_MAX+1)\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u4e8b\u4ef6\u503c(code)"})}),"\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8e\u4e8b\u4ef6\u503c\u79cd\u7c7b\u7e41\u591a\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4e00\u4e00\u5217\u4e3e\u51fa\u6765\uff0c\u8fd9\u91cc\u4e3e\u4f8b\u952e\u76d8\u7684\u90e8\u5206\u4e8b\u4ef6\u503c:"}),"\n",(0,s.jsx)(n.p,{children:"\u6587\u4ef6\u5934\u6587\u4ef6\u8def\u5f84\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"/usr/include/linux/input-event-codes.h\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u7136Linux\u5185\u6838\u7248\u672c\u8f83\u4f4e\u7684\u6709\u53ef\u80fd\u5728\u4ee5\u4e0b\u8def\u5f84\u7684\u8fd9\u4e2a\u5934\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"/usr/include/linux/input.h\n64 /*\n65  * Keys and buttons\n66  *\n67  * Most of the keys/buttons are modeled after USB HUT 1.12\n68  * (see http://www.usb.org/developers/hidpage).\n69  * Abbreviations in the comments:\n70  * AC - Application Control\n71  * AL - Application Launch Button\n72  * SC - System Control\n73  */\n74 \n75 #define KEY_RESERVED\t\t0\n76 #define KEY_ESC\t\t\t1\n77 #define KEY_1\t\t\t2\n78 #define KEY_2\t\t\t3\n79 #define KEY_3\t\t\t4\n80 #define KEY_4\t\t\t5\n81 #define KEY_5\t\t\t6\n82 #define KEY_6\t\t\t7\n83 #define KEY_7\t\t\t8\n84 #define KEY_8\t\t\t9\n85 #define KEY_9\t\t\t10\n86 #define KEY_0\t\t\t11\n87 #define KEY_MINUS\t\t12\n88 #define KEY_EQUAL\t\t13\n89 #define KEY_BACKSPACE\t\t14\n90 #define KEY_TAB\t\t\t15\n91 #define KEY_Q\t\t\t16\n92 #define KEY_W\t\t\t17\n...\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u7136\u8fd8\u6709\u9f20\u6807\u4e8b\u4ef6\u503c\u3001\u6447\u6746\u4e8b\u4ef6\u503c\u3001\u89e6\u6478\u5c4f\u4e8b\u4ef6\u503c\u7b49\u7b49\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u8be5\u4e8b\u4ef6\u4e0a\u62a5\u7684\u6570\u503c(value)"})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u8fd9\u90e8\u5206\u4e0a\u9762\u5df2\u7ecf\u4e3e\u4e86\u9f20\u6807\u7684\u6848\u4f8b\u8fdb\u884c\u4e86\u4ecb\u7ecd\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u901a\u8fc7\u5e94\u7528\u7a0b\u5e8f\u6765\u83b7\u53d6\u4e8b\u4ef6\uff0c\u540e\u9762\u7ae0\u8282\u5c06\u4f1a\u901a\u8fc7\u9f20\u6807\u3001\u952e\u76d8\u4ee5\u53ca\u89e6\u6478\u5c4f\u4e09\u4e2a\u6848\u4f8b\uff0c\u8fdb\u4e00\u6b65\u7684\u4e86\u89e3\u8f93\u5165\u7cfb\u7edf\u7684\u5e94\u7528\u7f16\u7a0b\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"34-\u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e00\u901a\u7528usb\u9f20\u6807\u4e8b\u4ef6\u8bfb\u53d6",children:"3.4 \u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e00\uff1a\u901a\u7528USB\u9f20\u6807\u4e8b\u4ef6\u8bfb\u53d6"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u6839\u636e\u524d\u9762\u7ae0\u8282\u7684\u8bb2\u89e3\uff0c\u5982\u679c\u6211\u4eec\u9700\u8981\u83b7\u53d6USB\u9f20\u6807\u7684\u4e8b\u4ef6\uff0c\u9996\u5148\u6211\u4eec\u8981\u5148\u901a\u8fc7cat /proc/bus/input/devices\u8fd9\u4e2a\u6307\u4ee4\u67e5\u8be2\u4e0eUSB\u9f20\u6807\u4e8b\u4ef6\u5bf9\u5e94\u7684\u76f8\u5173\u8bbe\u5907\u4fe1\u606f\uff0c\u901a\u8fc7\u5b9e\u9645\u6d4b\u8bd5\u5f97\u77e5\uff0cevent2\u4e3aUSB\u9f20\u6807\u4e0a\u62a5\u7684\u4e8b\u4ef6\u8282\u70b9\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image005.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\uff0c\u901a\u8fc7hexdump\u547d\u4ee4\u6d4b\u8bd5\u4e00\u4e0b\u9f20\u6807\u4e8b\u4ef6\u7684\u8f93\u51fa:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image006.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5177\u4f53\u4e0a\u62a5\u7684\u6570\u503c\u662f\u4ec0\u4e48\u542b\u4e49\u53ef\u4ee5\u7ed3\u54083.3\u7ae0\u8282\u8fdb\u884c\u5206\u6790\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u8fdb\u884c\u9610\u8ff0\uff0c\u672c\u8282\u7684\u76ee\u7684\u662f\u7f16\u5199\u4e00\u4e2a\u83b7\u53d6\u901a\u7528USB\u9f20\u6807\u7684\u4e8b\u4ef6\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u8981\u83b7\u53d6\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u6211\u4eec\u9700\u8981\u4e86\u89e3\u4ee5\u4e0b\u51e0\u4e2a\u90e8\u5206\u3002"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"1"})," ",(0,s.jsx)(n.strong,{children:"\u8bbe\u5907\u4e0a\u62a5\u4e8b\u4ef6\u7c7b\u578b(type)"})]}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u8fc73.3\u7ae0\u8282\uff0c\u6211\u4eec\u77e5\u9053\u627e\u5230\u5bf9\u5e94\u7684\u4e8b\u4ef6\u7c7b\u578b\u7684\u5b9a\u4e49\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u6587\u4ef6\u5934\u6587\u4ef6\u8def\u5f84\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"/usr/include/linux/input-event-codes.h\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u7136Linux\u5185\u6838\u7248\u672c\u8f83\u4f4e\u7684\u6709\u53ef\u80fd\u5728\u4ee5\u4e0b\u8def\u5f84\u7684\u8fd9\u4e2a\u5934\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"/usr/include/linux/input.h\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"34 /*\n35  * Event types\n36  */\n37 \n38 #define EV_SYN\t\t\t0x00\t//\u540c\u6b65\u4e8b\u4ef6\n39 #define EV_KEY\t\t\t0x01\t//\u6309\u952e\u4e8b\u4ef6\n40 #define EV_REL\t\t\t0x02\t//\u76f8\u5bf9\u4e8b\u4ef6\n41 #define EV_ABS\t\t\t0x03\t//\u7edd\u5bf9\u4e8b\u4ef6\n42 #define EV_MSC\t\t\t0x04\n43 #define EV_SW\t\t\t0x05\n44 #define EV_LED\t\t\t0x11\n45 #define EV_SND\t\t\t0x12\n46 #define EV_REP\t\t\t0x14\n47 #define EV_FF\t\t\t0x15\n48 #define EV_PWR\t\t\t0x16\n49 #define EV_FF_STATUS\t\t0x17\n50 #define EV_MAX\t\t\t0x1f\n51 #define EV_CNT\t\t\t(EV_MAX+1)\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"2"})," ",(0,s.jsx)(n.strong,{children:"\u8bbe\u5907\u4e0a\u62a5\u7684\u4e8b\u4ef6\u503c(code)"})]}),"\n",(0,s.jsx)(n.p,{children:"\u7531\u4e8e\u672c\u8282\u6211\u4eec\u5199\u7684\u662f\u901a\u7528USB\u9f20\u6807\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u6240\u4ee5\u6211\u4eec\u627e\u5230\u9f20\u6807\u76f8\u5173\u7684code,\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u6587\u4ef6\u5934\u6587\u4ef6\u8def\u5f84\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"/usr/include/linux/input-event-codes.h\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u7136Linux\u5185\u6838\u7248\u672c\u8f83\u4f4e\u7684\u6709\u53ef\u80fd\u5728\u4ee5\u4e0b\u8def\u5f84\u7684\u8fd9\u4e2a\u5934\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"/usr/include/linux/input.h\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"696 /*\n697  * Relative axes\n698  */\n699 \n700 #define REL_X\t\t\t0x00\t//\u76f8\u5bf9X\u5750\u6807\n701 #define REL_Y\t\t\t0x01\t//\u76f8\u5bf9Y\u5750\u6807\n702 #define REL_Z\t\t\t0x02\n703 #define REL_RX\t\t\t0x03\n704 #define REL_RY\t\t\t0x04\n705 #define REL_RZ\t\t\t0x05\n706 #define REL_HWHEEL\t\t0x06\n707 #define REL_DIAL\t\t0x07\n708 #define REL_WHEEL\t\t0x08\n709 #define REL_MISC\t\t0x09\n710 #define REL_MAX\t\t\t0x0f\n711 #define REL_CNT\t\t\t(REL_MAX+1)\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u6682\u65f6\u53ea\u4f1a\u7528\u6765REL_X\u548cREL_Y\u8fd9\u4e24\u4e2a\u53c2\u6570\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u90a3\u4e48\u6240\u8c13\u7684value,\u5c31\u662f\u9009\u62e9\u5177\u4f53\u7684\u4e8b\u4ef6\u7c7b\u578b(type)\u548c\u5177\u4f53\u7684\u4e8b\u4ef6\u503c(code)\u4ee5\u540e\u6240\u53cd\u5e94\u51fa\u6765\u7684\u503c\uff0c\u9f20\u6807\u5c31\u662f\u76f8\u5bf9\u4e8e\u5f53\u524dX\u6216\u8005\u76f8\u5bf9\u4e8e\u5f53\u524dY\u7684\u503c\uff0c\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u5982\u4f55\u6765\u8bfb\u53d6\u9f20\u6807\u4e8b\u4ef6\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u7f16\u5199input\u5e94\u7528\u7a0b\u5e8f\u4e4b\u524d\uff0c\u5728\u7a0b\u5e8f\u4e2d\u9700\u8981\u5305\u542b\u4ee5\u4e0b\u5934\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"#include <linux/input.h>\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7a0b\u5e8f\u7f16\u5199\u6b65\u9aa4\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"1 \u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u4f53\u53d8\u91cfinput_event\u7528\u4e8e\u63cf\u8ff0input\u4e8b\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"struct input_event event_mouse ;\n"})}),"\n",(0,s.jsx)(n.p,{children:"2 \u6253\u5f00input\u8bbe\u5907\u7684\u4e8b\u4ef6\u8282\u70b9\uff0c\u8fd9\u91cc\u6211\u4eec\u83b7\u53d6\u7684\u901a\u7528USB\u9f20\u6807\u662fevent2"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'open("/dev/input/event2",O_RDONLY);\n'})}),"\n",(0,s.jsx)(n.p,{children:"3 \u8bfb\u53d6\u4e8b\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"read(fd ,&event_mouse ,sizeof(event_mouse));\n"})}),"\n",(0,s.jsx)(n.p,{children:"4 \u6839\u636e\u4e0a\u62a5\u7684\u4e8b\u4ef6\u8fdb\u884c\u5904\u7406"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'//\u5224\u65ad\u9f20\u6807\u4e0a\u62a5\u7684\u7c7b\u578b\uff0c\u53ef\u80fd\u4e3a\u7edd\u5bf9\u4e8b\u4ef6\uff0c\u4e5f\u6709\u53ef\u80fd\u662f\u76f8\u5bf9\u4e8b\u4ef6\nif(EV_ABS == event_mouse.type || EV_REL == event_mouse.type)\n{\n   //code\u8868\u793a\u76f8\u5bf9\u4f4d\u79fbX\u6216\u8005Y\uff0c\u5f53\u5224\u65ad\u662fX\u65f6\uff0c\u6253\u5370X\u7684\u76f8\u5bf9\u4f4d\u79fbvalue\n   //\u5f53\u5224\u65ad\u662fY\u65f6\uff0c\u6253\u5370Y\u7684\u76f8\u5bf9\u4f4d\u79fbvalue\n   if(event_mouse.code == REL_X)\n   {\n      printf("event_mouse.code_X:%d\\n", event_mouse.code);\n      printf("event_mouse.value_X:%d\\n", event_mouse.value);\n   }\n   else if(event_mouse.code == REL_Y)\n   {\n      printf("event_mouse.code_Y:%d\\n", event_mouse.code);\n      printf("event_mouse.value_Y:%d\\n", event_mouse.value);\n   }\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"5 \u5173\u95ed\u6587\u4ef6\u63cf\u8ff0\u7b26"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"close(fd);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0d\u96be\u53d1\u73b0\uff0c\u83b7\u53d6\u4e00\u4e2a\u8f93\u5165\u7cfb\u7edf\u4e8b\u4ef6\uff0c\u4e5f\u662f\u6807\u51c6\u7684\u6587\u4ef6\u64cd\u4f5c\uff0c\u8fd9\u4f53\u73b0\u4e86Linux\u4e00\u5207\u7686\u6587\u4ef6\u7684\u601d\u60f3\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5b8c\u6574\u7684\u7a0b\u5e8f\u6848\u4f8b\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'01 #include <stdio.h>\n02 #include <unistd.h>\n03 #include <stdlib.h>\n04 #include <fcntl.h>\n05 #include <linux/input.h>\n06 \n07 int main(void)\n08 {\n09     //1\u3001\u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u4f53\u53d8\u91cf\u7528\u6765\u63cf\u8ff0input\u4e8b\u4ef6\n10     struct input_event event_mouse ;\n11     //2\u3001\u6253\u5f00input\u8bbe\u5907\u7684\u4e8b\u4ef6\u8282\u70b9  \u6211\u7684\u901a\u7528USB\u9f20\u6807\u4e8b\u4ef6\u7684\u8282\u70b9\u662fevent2\n12     int fd    = -1 ;\n13 \t   fd = open("/dev/input/event2", O_RDONLY);\n14     if(-1 == fd)\n15     {\n16         printf("open mouse event fair!\\n");\n17         return -1 ;\n18     }\n19     while(1)\n20     {\n21         //3\u3001\u8bfb\u4e8b\u4ef6\n22         read(fd, &event_mouse, sizeof(event_mouse));\n23 \t\t   if(EV_ABS == event_mouse.type || EV_REL == event_mouse.type)\n24 \t\t   {\n25             //code\u8868\u793a\u76f8\u5bf9\u4f4d\u79fbX\u6216\u8005Y\uff0c\u5f53\u5224\u65ad\u662fX\u65f6\uff0c\u6253\u5370X\u7684\u76f8\u5bf9\u4f4d\u79fbvalue\n26 \t\t\t   //\u5f53\u5224\u65ad\u662fY\u65f6\uff0c\u6253\u5370Y\u7684\u76f8\u5bf9\u4f4d\u79fbvalue\n27             if(event_mouse.code == REL_X)\n28             {\n29 \t\t\t\t   printf("event_mouse.code_X:%d\\n", event_mouse.code);\n30                 printf("event_mouse.value_X:%d\\n", event_mouse.value);\n31             }\n32             else if(event_mouse.code == REL_Y)\n33             {\n34                 printf("event_mouse.code_Y:%d\\n", event_mouse.code);\n35                 printf("event_mouse.value_Y:%d\\n", event_mouse.value);\n36             }\n37 \t\t}\n38     }\n39     close(fd);\n40     return 0 ;\n41 }\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u4ee3\u7801\u7f16\u5199\u5b8c\u6bd5\u540e\uff0c\u7136\u540e\u6267\u884c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"gcc test_mouse.c -o test_mouse\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7f16\u8bd1\u7a0b\u5e8f\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image007.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u7f16\u8bd1\u6210\u529f\u540e\u4f1a\u751f\u6210test_mouse\uff0c\u63a5\u4e0b\u6765\u6267\u884ctest_mouse\u8fd9\u4e2a\u7a0b\u5e8f\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u9f20\u6807\u5de6\u53f3\u79fb\u52a8\u7684\u65f6\u5019\u4e0a\u62a5\u7684\u4e8b\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image008.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u65f6\u5019\u53ef\u4ee5\u770b\u5230\uff0c\u53ea\u6709\u76f8\u5bf9\u4e8eX\u7684\u4e8b\u4ef6\u503c\u5728\u53d1\u751f\uff0c\u8fd9\u65f6\u5019\u6253\u5370\u7684value\u662fX\u65b9\u5411\u76f8\u5bf9\u4e8e\u539f\u70b9\u5750\u6807\u7684\u504f\u79fb\u503c\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u9f20\u6807\u4e0a\u4e0b\u79fb\u52a8\u7684\u65f6\u5019\u4e0a\u62a5\u7684\u4e8b\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image009.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u8fd9\u65f6\u5019\u53ef\u4ee5\u770b\u5230\uff0c\u53ea\u6709\u76f8\u5bf9\u4e8eY\u7684\u4e8b\u4ef6\u503c\u5728\u53d1\u751f\uff0c\u8fd9\u65f6\u5019\u6253\u5370\u7684value\u662fY\u65b9\u5411\u76f8\u5bf9\u4e8e\u539f\u70b9\u5750\u6807\u7684\u504f\u79fb\u503c\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"35-\u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e8c\u901a\u7528\u952e\u76d8\u4e8b\u4ef6\u8bfb\u53d6",children:"3.5 \u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e8c\uff1a\u901a\u7528\u952e\u76d8\u4e8b\u4ef6\u8bfb\u53d6"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5982\u4f55\u83b7\u53d6\u952e\u76d8\u4e8b\u4ef6\u57283.3\u7ae0\u8282\u5df2\u7ecf\u6709\u4e86\u76f8\u5e94\u7684\u4ecb\u7ecd\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u5199\u51fa\u6765\uff0c\u672c\u8282\u5b9e\u73b0\u7684\u662f\u901a\u7528\u952e\u76d8\u4e8b\u4ef6\u7684\u83b7\u53d6\uff0c\u7ed3\u54083.4\u7ae0\u8282\u83b7\u53d6\u9f20\u6807\u4e8b\u4ef6\u7684\u65b9\u5f0f\uff0c\u8fd9\u91cc\u901a\u7528\u952e\u76d8\u4e8b\u4ef6\u7684\u8282\u70b9\u4e3aevent1,\u901a\u8fc7\u7ed3\u54083.3\u7ae0\u8282\u4e0e3.4\u7ae0\u8282\uff0c\u7f16\u5199\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u5728\u7f16\u5199input\u5e94\u7528\u7a0b\u5e8f\u4e4b\u524d\uff0c\u5728\u7a0b\u5e8f\u4e2d\u9700\u8981\u5305\u542b\u4ee5\u4e0b\u5934\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"#include <linux/input.h>\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7a0b\u5e8f\u7f16\u5199\u6b65\u9aa4\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"1 \u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u4f53\u53d8\u91cfinput_event\u7528\u4e8e\u63cf\u8ff0input\u4e8b\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"struct input_event event_keyboard ;\n"})}),"\n",(0,s.jsx)(n.p,{children:"2 \u6253\u5f00input\u8bbe\u5907\u7684\u4e8b\u4ef6\u8282\u70b9\uff0c\u6211\u7684\u901a\u7528\u952e\u76d8\u4e8b\u4ef6\u7684\u8282\u70b9\u662fevent1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'open("/dev/input/event1",O_RDONLY);\n'})}),"\n",(0,s.jsx)(n.p,{children:"3 \u8bfb\u53d6\u4e8b\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"read(fd ,&event_keyboard ,sizeof(event_keyboard));\n"})}),"\n",(0,s.jsx)(n.p,{children:"4 \u6839\u636e\u4e0a\u62a5\u7684\u4e8b\u4ef6\u8fdb\u884c\u5904\u7406"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'//\u5224\u65ad\u952e\u76d8\u4e8b\u4ef6\u4e0a\u62a5\u7684\u7c7b\u578b\nif(EV_KEY == event_keyboard.type)\n{\n    if(1 == event_keyboard.value)\n      printf("\u4e8b\u4ef6\u7c7b\u578b:%d  \u4e8b\u4ef6\u503c:%d \u6309\u4e0b\\n", event_keyboard.type, \t\t\t\t         event_keyboard.code);\n    else if(0 == event_keyboard.value)\n      printf("\u4e8b\u4ef6\u7c7b\u578b:%d  \u4e8b\u4ef6\u503c:%d \u91ca\u653e\\n", event_keyboard.type, event_keyboard.code);\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"5 \u5173\u95ed\u6587\u4ef6\u63cf\u8ff0\u7b26"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"close(fd);\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u5b8c\u6574\u7a0b\u5e8f\u6848\u4f8b\u5b9e\u73b0\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'01 #include <stdio.h>\n02 #include <unistd.h>\n03 #include <stdlib.h>\n04 #include <fcntl.h>\n05 #include <linux/input.h>\n06 \n07 int main(void)\n08 {\n09     //1\u3001\u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u4f53\u53d8\u91cf\u7528\u6765\u63cf\u8ff0input\u4e8b\u4ef6\n10     struct input_event event_keyboard ;\n11     //2\u3001\u6253\u5f00input\u8bbe\u5907\u7684\u4e8b\u4ef6\u8282\u70b9  \u6211\u7684\u901a\u7528\u952e\u76d8\u4e8b\u4ef6\u7684\u8282\u70b9\u662fevent1\n12     int fd    = -1 ;\n13 \t   fd = open("/dev/input/event1", O_RDONLY);\n14     if(-1 == fd)\n15     {\n16         printf("open mouse event fair!\\n");\n17         return -1 ;\n18     }\n19     while(1)\n20     {\n21         //3\u3001\u8bfb\u4e8b\u4ef6\n22         read(fd, &event_keyboard, sizeof(event_keyboard));\n23 \t\t   if(EV_KEY == event_keyboard.type)\n24 \t\t   {\n25 \t\t\t\tif(1 == event_keyboard.value)\n26 \t\t\t\t\tprintf("\u4e8b\u4ef6\u7c7b\u578b:%d  \u4e8b\u4ef6\u503c:%d \u6309\u4e0b\\n",event_keyboard.type,event_keyboard.code);\n27 \t\t\t\telse if(0 == event_keyboard.value)\n28 \t\t\t\t\tprintf("\u4e8b\u4ef6\u7c7b\u578b:%d  \u4e8b\u4ef6\u503c:%d \u91ca\u653e\\n",event_keyboard.type,event_keyboard.code);\n29 \t\t}\n30     }\n31     close(fd);\n32     return 0 ;\n33 }\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u4e0d\u96be\u53d1\u73b0\uff0c\u901a\u7528USB\u952e\u76d8\u7a0b\u5e8f\u7f16\u5199\u6b65\u9aa4\u4e0e\u901a\u7528USB\u9f20\u6807\u7a0b\u5e8f\u7f16\u5199\u6b65\u9aa4\u51e0\u4e4e\u4e00\u6837\uff0c\u533a\u522b\u53ea\u662f\u8bfb\u53d6\u7684\u4e8b\u4ef6\u7c7b\u578b\u4ee5\u53ca\u540e\u9762\u5904\u7406\u7684\u6570\u636evalue\u4e0d\u540c\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u4ee3\u7801\u7f16\u5199\u5b8c\u6bd5\u540e\uff0c\u7136\u540e\u6267\u884c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"gcc test_keyboard.c -o test_keyboard\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7f16\u8bd1\u7a0b\u5e8f\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image010.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u7f16\u8bd1\u6210\u529f\u540e\u4f1a\u751f\u6210test_keyboard\uff0c\u63a5\u4e0b\u6765\u6267\u884ctest_keyboard\u8fd9\u4e2a\u7a0b\u5e8f\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image011.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u6309\u4e0b\u6309\u952e\u65f6\u5019\uff0c\u53ef\u4ee5\u89c2\u5bdf\u5230\u6309\u952e\u7684\u6309\u4e0b\u548c\u91ca\u653e\u7684\u8fc7\u7a0b\uff0c\u8fd9\u5176\u5b9e\u5c31\u662f\u540c\u4e00\u4e2a\u4e8b\u4ef6\u4e0b\u7684\u4e24\u4e2a\u4e0d\u540c\u7684\u72b6\u6001\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"36-\u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e09\u767e\u95ee\u7f51imx6ul\u5f00\u53d1\u677f\u89e6\u6478\u5c4f\u4e8b\u4ef6\u8bfb\u53d6",children:"3.6 \u8f93\u5165\u7cfb\u7edf\u5e94\u7528\u7f16\u7a0b\u5b9e\u6218\u4e09\uff1a\u767e\u95ee\u7f51imx6ul\u5f00\u53d1\u677f\u89e6\u6478\u5c4f\u4e8b\u4ef6\u8bfb\u53d6"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u5728\u524d\u9762\uff0c\u6211\u4eec\u5df2\u7ecf\u719f\u6089\u4e86\u9f20\u6807\u3001\u952e\u76d8\u7684\u57fa\u672c\u64cd\u4f5c\uff0c\u4f46\u53d1\u73b0\u4e00\u4e2a\u89c4\u5f8b\uff0c\u90a3\u5c31\u662f\u7f16\u7a0b\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u552f\u4e00\u4e0d\u540c\u7684\u5730\u65b9\u5c31\u662f\u83b7\u53d6\u7684\u4e8b\u4ef6\u7c7b\u578b\u4ee5\u53ca\u4e8b\u4ef6\u503c\u4e0d\u540c\uff0c\u90a3\u4e48\u89e6\u6478\u5c4f\u5728input\u7cfb\u7edf\u4e2d\u662f\u4e00\u7c7b\u4ec0\u4e48\u4e8b\u4ef6\u5462\uff1f"}),"\n",(0,s.jsx)(n.p,{children:"\u200b\t\t\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u89e6\u6478\u5c4f\u5728input\u7cfb\u7edf\u4e2d\u5c5e\u4e8e\u7edd\u5bf9\u4e8b\u4ef6\uff0c\u4e5f\u5c31\u662f\u89e6\u6478\u7684\u5750\u6807\u70b9X\u548cY\u4f1a\u5728\u5c4f\u5e55\u7684\u5206\u8fa8\u7387\u8303\u56f4\u5185\u4e0a\u62a5\u4e00\u4e2a\u7edd\u5bf9\u7684\u5750\u6807\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u7edd\u5bf9\u4e8b\u4ef6\u5bf9\u5e94\u7684\u503c\u4e3a\uff1aEV_ABS"}),"\n",(0,s.jsx)(n.p,{children:"\u76f8\u5e94X\u548cY\u5206\u91cf\u7684\u503c\u5206\u522b\u4e3a\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"ABS_MT_POSITION_X\u3001ABS_MT_POSITION_Y"}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u8fc7\u7ed3\u5408\u524d\u9762\u7684\u7ae0\u8282\u5185\u5bb9\uff0c\u5f88\u5bb9\u6613\u7f16\u5199\u5982\u4e0b\u7a0b\u5e8f\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:'01 #include <stdio.h>\n02 #include <unistd.h>\n03 #include <fcntl.h>\n04 #include <stdlib.h>\n05 #include <linux/input.h>\n06 \n07 int main(int argc, char **argv)\n08 {\n09     int tp_fd  = -1 ;\n10     int tp_ret = -1 ;\n11     int touch_x,touch_y ;\n12     struct input_event imx6ull_ts ;  \n13     //1\u3001\u6253\u5f00\u89e6\u6478\u5c4f\u4e8b\u4ef6\u8282\u70b9\n14     tp_fd = open("/dev/input/event1",O_RDONLY);\n15     if(tp_fd < 0)\n16     {\n17        printf("open /dev/input/event1 fail!\\n");\n18        return -1 ;\n19     }\n20     while(1)\n21     {  \n22 \t \t\t//2\u3001\u83b7\u53d6\u89e6\u6478\u5c4f\u76f8\u5e94\u7684\u4e8b\u4ef6\uff0c\u5e76\u6253\u5370\u51fa\u5f53\u524d\u89e6\u6478\u7684\u5750\u6807\n23          read(tp_fd ,&imx6ull_ts ,sizeof(imx6ull_ts));  \n24          switch(imx6ull_ts.type)\n25 \t \t\t{  \n26 \t    \t\tcase EV_ABS:  \n27 \t\t \t\tif(imx6ull_ts.code == ABS_MT_POSITION_X)  \n28 \t\t    \t\ttouch_x = imx6ull_ts.value ;\n29 \t\t \t\tif(imx6ull_ts.code == ABS_MT_POSITION_Y) \n30 \t\t    \t\ttouch_y = imx6ull_ts.value ;\n31 \t\t \t\tbreak ;\n32 \t\t \t\tdefalut:  \n33 \t\t \t\tbreak ;  \n34 \t \t\t}     \t\n35 \t \t\tprintf("touch_x:%d touch_y:%d\\n",touch_x,touch_y);\n36 \t \t\tusleep(100);\n37     }\t\n38     close(tp_fd);\n39     return 0;\n40 }\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u4ee3\u7801\u7f16\u5199\u5b8c\u6bd5\u540e\uff0c\u7136\u540e\u6267\u884c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"gcc test_touchscreen.c -o test_touchscreen\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4ea4\u53c9\u7f16\u8bd1\u7a0b\u5e8f\uff1a(\u6ce8\u610f\u8fd9\u91cc\u662f\u8981\u5728\u5f00\u53d1\u677f\u8fd0\u884c\uff0c\u4e0d\u662f\u5728PC\u7aef)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image012.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\u542f\u52a8\u5f00\u53d1\u677f\uff0c\u7136\u540e\u4e32\u53e3\u7ec8\u7aef\u8f93\u51farz\u547d\u4ee4\uff0c\u7b49\u5f85\u63a5\u6536PC\u7aef\u7684\u6587\u4ef6\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06test_touchscreen\u8fd9\u4e2a\u6587\u4ef6\u4f20\u8f93\u5230\u5f00\u53d1\u677f\u3002"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image013.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u5177\u4f53\u64cd\u4f5c\u6b65\u9aa4\u53ef\u53c2\u8003\u7b2c11\u7ae0\uff1aPC\u548c\u5f00\u53d1\u677f\u4e4b\u95f4\u4f20\u8f93\u6587\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\u7ed9test_touchscreen\u6dfb\u52a0\u53ef\u6267\u884c\u6743\u9650:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image014.png",alt:""})}),"\n",(0,s.jsx)(n.p,{children:"\u6267\u884ctest_touchscreen\uff0c\u7136\u540e\u7528\u624b\u89e6\u6478\u5c4f\uff0c\u53ef\u4ee5\u770b\u5230\u6709\u76f8\u5e94\u7684\u5750\u6807\u503c\u6253\u5370\uff1a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"http://photos.100ask.net/NewHomeSite/InputSystem_Image015.png",alt:""})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>l});var s=t(6540);const i={},d=s.createContext(i);function c(e){const n=s.useContext(d);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);